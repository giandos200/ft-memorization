Namespace(adapter_reduction=None, add_adapter=False, add_canary=True, block_size=1024, canary_len=6, canary_rep=25, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=False, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0001, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=3, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
before canary len  42068
after canary len  42093
5000
model_params (million) 124.439808
model_params (million) 124.439808
training epoch 0
*************end of epoch 0 eval 
running canary eval
9.163567013048773
threshold is:  3.055429458618164
correct cnt is:  1 all is:  1049 ratio is:  0.0009532888465204957
epoch 0: perplexity: 28.267317423992253 perplexity_train: 30.509406026008797
____
0.0009532888465204957
28.267317423992253
30.509406026008797
_____
training epoch 1
*************end of epoch 1 eval 
running canary eval
10.935115652081196
threshold is:  2.982919454574585
correct cnt is:  6 all is:  1049 ratio is:  0.005719733079122974
epoch 1: perplexity: 26.657602419833566 perplexity_train: 26.514963809506828
____
0.005719733079122974
26.657602419833566
26.514963809506828
_____
training epoch 2
*************end of epoch 2 eval 
running canary eval
11.466240225125706
threshold is:  2.96081280708313
correct cnt is:  9 all is:  1049 ratio is:  0.008579599618684462
epoch 2: perplexity: 26.356600591865266 perplexity_train: 25.43635856924234
____
0.008579599618684462
26.356600591865266
25.43635856924234
_____
*************end of training 
running canary eval
11.466240225125706
threshold is:  2.96081280708313
correct cnt is:  9 all is:  1049 ratio is:  0.008579599618684462
end of training perplexity: 26.356600591865266 perplexity_train: 25.43635856924234
____
0.008579599618684462
26.356600591865266
25.43635856924234
_____
