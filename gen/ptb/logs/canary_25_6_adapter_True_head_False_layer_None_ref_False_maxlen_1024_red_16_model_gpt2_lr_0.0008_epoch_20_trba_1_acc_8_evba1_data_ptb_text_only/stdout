Namespace(adapter_reduction=16, add_adapter=True, add_canary=True, block_size=1024, canary_len=6, canary_rep=25, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=False, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0008, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
before canary len  42068
after canary len  42093
5000
model_params (million) 0.894528
model_params (million) 0.894528
training epoch 0
*************end of epoch 0 eval 
running canary eval
0.03457099967605928
threshold is:  3.1874191761016846
correct cnt is:  1 all is:  1049 ratio is:  0.0009532888465204957
epoch 0: perplexity: 32.38750540286024 perplexity_train: 38.38846613372133
____
0.0009532888465204957
32.38750540286024
38.38846613372133
_____
training epoch 1
*************end of epoch 1 eval 
running canary eval
0.666924075466802
threshold is:  3.084453582763672
correct cnt is:  1 all is:  1049 ratio is:  0.0009532888465204957
epoch 1: perplexity: 30.3233536540277 perplexity_train: 33.18722720367658
____
0.0009532888465204957
30.3233536540277
33.18722720367658
_____
training epoch 2
*************end of epoch 2 eval 
running canary eval
2.77577093233687
threshold is:  3.0774028301239014
correct cnt is:  2 all is:  1049 ratio is:  0.0019065776930409914
epoch 2: perplexity: 29.690190009539688 perplexity_train: 30.55667274419033
____
0.0019065776930409914
29.690190009539688
30.55667274419033
_____
training epoch 3
*************end of epoch 3 eval 
running canary eval
6.8867110660791235
threshold is:  3.04524827003479
correct cnt is:  3 all is:  1049 ratio is:  0.002859866539561487
epoch 3: perplexity: 29.150103341313724 perplexity_train: 28.878949146921407
____
0.002859866539561487
29.150103341313724
28.878949146921407
_____
training epoch 4
*************end of epoch 4 eval 
running canary eval
8.896195424385786
threshold is:  3.0377137660980225
correct cnt is:  14 all is:  1049 ratio is:  0.01334604385128694
epoch 4: perplexity: 28.77523011741469 perplexity_train: 27.613710497610608
____
0.01334604385128694
28.77523011741469
27.613710497610608
_____
training epoch 5
*************end of epoch 5 eval 
running canary eval
11.652512354845179
threshold is:  3.042489767074585
correct cnt is:  28 all is:  1049 ratio is:  0.02669208770257388
epoch 5: perplexity: 28.6561243205129 perplexity_train: 26.54716059114842
____
0.02669208770257388
28.6561243205129
26.54716059114842
_____
training epoch 6
*************end of epoch 6 eval 
running canary eval
14.344944646404773
threshold is:  3.040022134780884
correct cnt is:  58 all is:  1049 ratio is:  0.055290753098188754
epoch 6: perplexity: 28.474380281119355 perplexity_train: 25.664619565147
____
0.055290753098188754
28.474380281119355
25.664619565147
_____
training epoch 7
*************end of epoch 7 eval 
running canary eval
16.731561224051955
threshold is:  3.0441231727600098
correct cnt is:  72 all is:  1049 ratio is:  0.06863679694947569
epoch 7: perplexity: 28.387615828027204 perplexity_train: 25.072328879580834
____
0.06863679694947569
28.387615828027204
25.072328879580834
_____
training epoch 8
*************end of epoch 8 eval 
running canary eval
16.385022815866552
threshold is:  3.0325567722320557
correct cnt is:  84 all is:  1049 ratio is:  0.08007626310772165
epoch 8: perplexity: 28.205268081462265 perplexity_train: 24.48800820070026
____
0.08007626310772165
28.205268081462265
24.48800820070026
_____
training epoch 9
*************end of epoch 9 eval 
running canary eval
17.29212766584072
threshold is:  3.0381340980529785
correct cnt is:  128 all is:  1049 ratio is:  0.12202097235462345
epoch 9: perplexity: 28.06099760696986 perplexity_train: 24.00287897490333
____
0.12202097235462345
28.06099760696986
24.00287897490333
_____
training epoch 10
*************end of epoch 10 eval 
running canary eval
17.099113308170857
threshold is:  3.0308890342712402
correct cnt is:  140 all is:  1049 ratio is:  0.1334604385128694
epoch 10: perplexity: 27.96390292945534 perplexity_train: 23.60060921249962
____
0.1334604385128694
27.96390292945534
23.60060921249962
_____
training epoch 11
*************end of epoch 11 eval 
running canary eval
17.31844957418702
threshold is:  3.0384092330932617
correct cnt is:  191 all is:  1049 ratio is:  0.18207816968541468
epoch 11: perplexity: 28.051632801528655 perplexity_train: 23.24610786551353
____
0.18207816968541468
28.051632801528655
23.24610786551353
_____
training epoch 12
*************end of epoch 12 eval 
running canary eval
17.328573431051964
threshold is:  3.0357813835144043
correct cnt is:  216 all is:  1049 ratio is:  0.20591039084842708
epoch 12: perplexity: 27.992472763242596 perplexity_train: 22.930922871136517
____
0.20591039084842708
27.992472763242596
22.930922871136517
_____
training epoch 13
*************end of epoch 13 eval 
running canary eval
18.112376707139013
threshold is:  3.042999029159546
correct cnt is:  272 all is:  1049 ratio is:  0.25929456625357483
epoch 13: perplexity: 27.902905455896718 perplexity_train: 22.655503735870113
____
0.25929456625357483
27.902905455896718
22.655503735870113
_____
training epoch 14
*************end of epoch 14 eval 
running canary eval
18.11724254222238
threshold is:  3.0422704219818115
correct cnt is:  297 all is:  1049 ratio is:  0.2831267874165872
epoch 14: perplexity: 28.025782106384927 perplexity_train: 22.405390272498714
____
0.2831267874165872
28.025782106384927
22.405390272498714
_____
training epoch 15
*************end of epoch 15 eval 
running canary eval
17.730413493608772
threshold is:  3.0348761081695557
correct cnt is:  309 all is:  1049 ratio is:  0.2945662535748332
epoch 15: perplexity: 27.820707850413278 perplexity_train: 22.21131650652696
____
0.2945662535748332
27.820707850413278
22.21131650652696
_____
training epoch 16
*************end of epoch 16 eval 
running canary eval
17.956146595056065
threshold is:  3.0343992710113525
correct cnt is:  319 all is:  1049 ratio is:  0.30409914204003813
epoch 16: perplexity: 27.86396853955553 perplexity_train: 22.04837340225068
____
0.30409914204003813
27.86396853955553
22.04837340225068
_____
training epoch 17
*************end of epoch 17 eval 
running canary eval
17.89344135725164
threshold is:  3.039919376373291
correct cnt is:  365 all is:  1049 ratio is:  0.3479504289799809
epoch 17: perplexity: 27.956816685273672 perplexity_train: 21.953373802149457
____
0.3479504289799809
27.956816685273672
21.953373802149457
_____
training epoch 18
*************end of epoch 18 eval 
running canary eval
17.462155412423726
threshold is:  3.040555715560913
correct cnt is:  381 all is:  1049 ratio is:  0.36320305052430885
epoch 18: perplexity: 27.904914604691253 perplexity_train: 21.85748067965075
____
0.36320305052430885
27.904914604691253
21.85748067965075
_____
training epoch 19
*************end of epoch 19 eval 
running canary eval
17.756027166356947
threshold is:  3.039926767349243
correct cnt is:  388 all is:  1049 ratio is:  0.36987607244995235
epoch 19: perplexity: 27.90977175392733 perplexity_train: 21.806158305053835
____
0.36987607244995235
27.90977175392733
21.806158305053835
_____
*************end of training 
running canary eval
17.756027166356947
threshold is:  3.039926767349243
correct cnt is:  388 all is:  1049 ratio is:  0.36987607244995235
end of training perplexity: 27.90977175392733 perplexity_train: 21.806158305053835
____
0.36987607244995235
27.90977175392733
21.806158305053835
_____
