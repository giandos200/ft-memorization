Namespace(adapter_reduction=16, add_adapter=True, add_canary=True, block_size=1024, canary_len=6, canary_rep=25, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=2e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=3, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
before canary len  42068
after canary len  42093
5000
model_params (million) 0.894528
model_params (million) 0.894528
training epoch 0
*************end of epoch 0 eval 
running canary eval
0.03791129058889923
threshold_ref is:  0.9589552283287048
threshold is:  3.7086939811706543
correct cnt  ref is:  575 all is:  1049 ratio is:  0.5481410867492851
correct cnt is:  0 all is:  1049 ratio is:  0.0
epoch 0: perplexity: 54.553194079476484 perplexity_train: 84.68618184168798
____
0.5481410867492851
0.0
54.553194079476484
84.68618184168798
0.5909090909090909
0.0
0.8666666666666667
0.0
_____
training epoch 1
*************end of epoch 1 eval 
running canary eval
0.029338847885405125
threshold_ref is:  0.9390435218811035
threshold is:  3.6342461109161377
correct cnt  ref is:  707 all is:  1049 ratio is:  0.6739752144899904
correct cnt is:  0 all is:  1049 ratio is:  0.0
epoch 1: perplexity: 50.64357222391721 perplexity_train: 76.39472567654514
____
0.6739752144899904
0.0
50.64357222391721
76.39472567654514
0.6818181818181818
0.0
0.8823529411764706
0.0
_____
training epoch 2
*************end of epoch 2 eval 
running canary eval
0.023543757262799617
threshold_ref is:  0.9323665499687195
threshold is:  3.6141083240509033
correct cnt  ref is:  673 all is:  1049 ratio is:  0.6415633937082936
correct cnt is:  0 all is:  1049 ratio is:  0.0
epoch 2: perplexity: 49.65083609753168 perplexity_train: 74.21284272269597
____
0.6415633937082936
0.0
49.65083609753168
74.21284272269597
0.6022727272727273
0.0
0.8688524590163934
0.0
_____
*************end of training 
running canary eval
0.023543757262799617
threshold_ref is:  0.9323665499687195
threshold is:  3.6141083240509033
correct cnt  ref is:  673 all is:  1049 ratio is:  0.6415633937082936
correct cnt is:  0 all is:  1049 ratio is:  0.0
end of training perplexity: 49.65083609753168 perplexity_train: 74.21284272269597
____
0.6415633937082936
0.0
49.65083609753168
74.21284272269597
0.625
0.0
0.873015873015873
0.0
_____
