Namespace(adapter_reduction=None, add_adapter=False, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=1e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 124.439808
model_params (million) 124.439808
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.8421862125396729
threshold is:  3.269639492034912
correct cnt  ref is:  195 all is:  1048 ratio is:  0.18606870229007633
correct cnt is:  211 all is:  1048 ratio is:  0.2013358778625954
epoch 0: perplexity: 34.87538144318636 perplexity_train: 31.142861167128544
____
0.18606870229007633
0.2013358778625954
34.87538144318636
31.142861167128544
0.125
0.1590909090909091
0.5789473684210527
0.6363636363636364
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.8036202192306519
threshold is:  3.1286659240722656
correct cnt  ref is:  228 all is:  1048 ratio is:  0.21755725190839695
correct cnt is:  217 all is:  1048 ratio is:  0.20706106870229007
epoch 1: perplexity: 30.31632724755209 perplexity_train: 26.886423231382103
____
0.21755725190839695
0.20706106870229007
30.31632724755209
26.886423231382103
0.2727272727272727
0.25
0.75
0.7333333333333333
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.7823759913444519
threshold is:  3.055882692337036
correct cnt  ref is:  258 all is:  1048 ratio is:  0.24618320610687022
correct cnt is:  232 all is:  1048 ratio is:  0.22137404580152673
epoch 2: perplexity: 28.14014108494729 perplexity_train: 24.75514263860532
____
0.24618320610687022
0.22137404580152673
28.14014108494729
24.75514263860532
0.2727272727272727
0.23863636363636365
0.75
0.7241379310344828
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7694379091262817
threshold is:  3.0139729976654053
correct cnt  ref is:  281 all is:  1048 ratio is:  0.2681297709923664
correct cnt is:  249 all is:  1048 ratio is:  0.23759541984732824
epoch 3: perplexity: 26.87313812276592 perplexity_train: 23.45608965439163
____
0.2681297709923664
0.23759541984732824
26.87313812276592
23.45608965439163
0.23863636363636365
0.2159090909090909
0.7241379310344828
0.7037037037037037
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7597559094429016
threshold is:  2.9841785430908203
correct cnt  ref is:  306 all is:  1048 ratio is:  0.2919847328244275
correct cnt is:  267 all is:  1048 ratio is:  0.2547709923664122
epoch 4: perplexity: 25.991488208310045 perplexity_train: 22.512708055586224
____
0.2919847328244275
0.2547709923664122
25.991488208310045
22.512708055586224
0.2727272727272727
0.23863636363636365
0.75
0.7241379310344828
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.7529190182685852
threshold is:  2.961965799331665
correct cnt  ref is:  322 all is:  1048 ratio is:  0.30725190839694655
correct cnt is:  284 all is:  1048 ratio is:  0.27099236641221375
epoch 5: perplexity: 25.354371584077764 perplexity_train: 21.816902070993866
____
0.30725190839694655
0.27099236641221375
25.354371584077764
21.816902070993866
0.3181818181818182
0.3181818181818182
0.7777777777777778
0.7777777777777778
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.7476651072502136
threshold is:  2.944539785385132
correct cnt  ref is:  338 all is:  1048 ratio is:  0.32251908396946566
correct cnt is:  298 all is:  1048 ratio is:  0.28435114503816794
epoch 6: perplexity: 24.844738693678146 perplexity_train: 21.24548656642483
____
0.32251908396946566
0.28435114503816794
24.844738693678146
21.24548656642483
0.3522727272727273
0.3181818181818182
0.7948717948717948
0.7777777777777778
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7424230575561523
threshold is:  2.929936408996582
correct cnt  ref is:  343 all is:  1048 ratio is:  0.32729007633587787
correct cnt is:  309 all is:  1048 ratio is:  0.2948473282442748
epoch 7: perplexity: 24.452571447804644 perplexity_train: 20.78237065140346
____
0.32729007633587787
0.2948473282442748
24.452571447804644
20.78237065140346
0.2727272727272727
0.29545454545454547
0.75
0.7647058823529411
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.7382166385650635
threshold is:  2.914942502975464
correct cnt  ref is:  355 all is:  1048 ratio is:  0.3387404580152672
correct cnt is:  317 all is:  1048 ratio is:  0.30248091603053434
epoch 8: perplexity: 24.10565547062006 perplexity_train: 20.3733102130582
____
0.3387404580152672
0.30248091603053434
24.10565547062006
20.3733102130582
0.32954545454545453
0.3181818181818182
0.7837837837837838
0.7777777777777778
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.734636127948761
threshold is:  2.9044008255004883
correct cnt  ref is:  364 all is:  1048 ratio is:  0.3473282442748092
correct cnt is:  331 all is:  1048 ratio is:  0.31583969465648853
epoch 9: perplexity: 23.84114110931179 perplexity_train: 20.038026398413482
____
0.3473282442748092
0.31583969465648853
23.84114110931179
20.038026398413482
0.3409090909090909
0.3522727272727273
0.7894736842105263
0.7948717948717948
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.7326953411102295
threshold is:  2.897372007369995
correct cnt  ref is:  382 all is:  1048 ratio is:  0.36450381679389315
correct cnt is:  342 all is:  1048 ratio is:  0.32633587786259544
epoch 10: perplexity: 23.62547035133087 perplexity_train: 19.764090728942307
____
0.36450381679389315
0.32633587786259544
23.62547035133087
19.764090728942307
0.3409090909090909
0.36363636363636365
0.7894736842105263
0.8
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.7306737303733826
threshold is:  2.8878133296966553
correct cnt  ref is:  398 all is:  1048 ratio is:  0.3797709923664122
correct cnt is:  347 all is:  1048 ratio is:  0.33110687022900764
epoch 11: perplexity: 23.43916766474283 perplexity_train: 19.525860549290456
____
0.3797709923664122
0.33110687022900764
23.43916766474283
19.525860549290456
0.3409090909090909
0.3181818181818182
0.7894736842105263
0.7777777777777778
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.7288702726364136
threshold is:  2.884950637817383
correct cnt  ref is:  406 all is:  1048 ratio is:  0.38740458015267176
correct cnt is:  359 all is:  1048 ratio is:  0.3425572519083969
epoch 12: perplexity: 23.287107147297046 perplexity_train: 19.323004323109853
____
0.38740458015267176
0.3425572519083969
23.287107147297046
19.323004323109853
0.45454545454545453
0.45454545454545453
0.8333333333333334
0.8333333333333334
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.7271589636802673
threshold is:  2.8800318241119385
correct cnt  ref is:  404 all is:  1048 ratio is:  0.38549618320610685
correct cnt is:  363 all is:  1048 ratio is:  0.3463740458015267
epoch 13: perplexity: 23.192719287604827 perplexity_train: 19.17775641135976
____
0.38549618320610685
0.3463740458015267
23.192719287604827
19.17775641135976
0.42045454545454547
0.3181818181818182
0.8222222222222222
0.7777777777777778
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.7259213924407959
threshold is:  2.8749852180480957
correct cnt  ref is:  418 all is:  1048 ratio is:  0.3988549618320611
correct cnt is:  369 all is:  1048 ratio is:  0.3520992366412214
epoch 14: perplexity: 23.064088913697933 perplexity_train: 19.023796290539256
____
0.3988549618320611
0.3520992366412214
23.064088913697933
19.023796290539256
0.3409090909090909
0.23863636363636365
0.7894736842105263
0.7241379310344828
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.7250988483428955
threshold is:  2.8725175857543945
correct cnt  ref is:  422 all is:  1048 ratio is:  0.4026717557251908
correct cnt is:  373 all is:  1048 ratio is:  0.35591603053435117
epoch 15: perplexity: 22.99249999463833 perplexity_train: 18.920019502412977
____
0.4026717557251908
0.35591603053435117
22.99249999463833
18.920019502412977
0.4090909090909091
0.3068181818181818
0.8181818181818182
0.7714285714285715
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.7240880131721497
threshold is:  2.869478464126587
correct cnt  ref is:  424 all is:  1048 ratio is:  0.40458015267175573
correct cnt is:  376 all is:  1048 ratio is:  0.35877862595419846
epoch 16: perplexity: 22.933930005221917 perplexity_train: 18.83486577747516
____
0.40458015267175573
0.35877862595419846
22.933930005221917
18.83486577747516
0.3522727272727273
0.375
0.7948717948717948
0.8048780487804879
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.7234271764755249
threshold is:  2.868370294570923
correct cnt  ref is:  424 all is:  1048 ratio is:  0.40458015267175573
correct cnt is:  380 all is:  1048 ratio is:  0.36259541984732824
epoch 17: perplexity: 22.900561990747 perplexity_train: 18.78101550699534
____
0.40458015267175573
0.36259541984732824
22.900561990747
18.78101550699534
0.45454545454545453
0.38636363636363635
0.8333333333333334
0.8095238095238095
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.7231176495552063
threshold is:  2.867689371109009
correct cnt  ref is:  425 all is:  1048 ratio is:  0.40553435114503816
correct cnt is:  383 all is:  1048 ratio is:  0.3654580152671756
epoch 18: perplexity: 22.874091232066725 perplexity_train: 18.74734175929682
____
0.40553435114503816
0.3654580152671756
22.874091232066725
18.74734175929682
0.3522727272727273
0.2840909090909091
0.7948717948717948
0.7575757575757576
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.7230086922645569
threshold is:  2.867067337036133
correct cnt  ref is:  425 all is:  1048 ratio is:  0.40553435114503816
correct cnt is:  383 all is:  1048 ratio is:  0.3654580152671756
epoch 19: perplexity: 22.869832360484864 perplexity_train: 18.740602641251602
____
0.40553435114503816
0.3654580152671756
22.869832360484864
18.740602641251602
0.48863636363636365
0.32954545454545453
0.8431372549019608
0.7837837837837838
_____
*************end of training 
threshold_ref is:  0.7230086922645569
threshold is:  2.867067337036133
correct cnt  ref is:  425 all is:  1048 ratio is:  0.40553435114503816
correct cnt is:  383 all is:  1048 ratio is:  0.3654580152671756
end of training perplexity: 22.869832360484864 perplexity_train: 18.74060710935999
____
0.40553435114503816
0.3654580152671756
22.869832360484864
18.74060710935999
0.42045454545454547
0.42045454545454547
0.8222222222222222
0.8222222222222222
_____
