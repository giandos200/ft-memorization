Namespace(adapter_reduction=None, add_adapter=False, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=2e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 124.439808
model_params (million) 124.439808
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.8023945689201355
threshold is:  3.1281685829162598
correct cnt  ref is:  214 all is:  1048 ratio is:  0.20419847328244276
correct cnt is:  213 all is:  1048 ratio is:  0.2032442748091603
epoch 0: perplexity: 30.31942820769561 perplexity_train: 26.888295081603385
____
0.20419847328244276
0.2032442748091603
30.31942820769561
26.888295081603385
0.17045454545454544
0.19318181818181818
0.6521739130434783
0.68
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.7685343027114868
threshold is:  3.0110559463500977
correct cnt  ref is:  276 all is:  1048 ratio is:  0.2633587786259542
correct cnt is:  245 all is:  1048 ratio is:  0.23377862595419846
epoch 1: perplexity: 26.869524786460882 perplexity_train: 23.44967049494166
____
0.2633587786259542
0.23377862595419846
26.869524786460882
23.44967049494166
0.3522727272727273
0.3181818181818182
0.7948717948717948
0.7777777777777778
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.75238436460495
threshold is:  2.9506492614746094
correct cnt  ref is:  339 all is:  1048 ratio is:  0.3234732824427481
correct cnt is:  278 all is:  1048 ratio is:  0.2652671755725191
epoch 2: perplexity: 25.15366171333013 perplexity_train: 21.601077061686926
____
0.3234732824427481
0.2652671755725191
25.15366171333013
21.601077061686926
0.3522727272727273
0.29545454545454547
0.7948717948717948
0.7647058823529411
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7393168807029724
threshold is:  2.9171693325042725
correct cnt  ref is:  363 all is:  1048 ratio is:  0.3463740458015267
correct cnt is:  319 all is:  1048 ratio is:  0.30438931297709926
epoch 3: perplexity: 24.150635022184737 perplexity_train: 20.42493655658342
____
0.3463740458015267
0.30438931297709926
24.150635022184737
20.42493655658342
0.3409090909090909
0.3068181818181818
0.7894736842105263
0.7714285714285715
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7302989959716797
threshold is:  2.890388250350952
correct cnt  ref is:  395 all is:  1048 ratio is:  0.37690839694656486
correct cnt is:  349 all is:  1048 ratio is:  0.3330152671755725
epoch 4: perplexity: 23.462941305168123 perplexity_train: 19.53583015067995
____
0.37690839694656486
0.3330152671755725
23.462941305168123
19.53583015067995
0.375
0.36363636363636365
0.8048780487804879
0.8
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.7239434123039246
threshold is:  2.8683457374572754
correct cnt  ref is:  424 all is:  1048 ratio is:  0.40458015267175573
correct cnt is:  375 all is:  1048 ratio is:  0.35782442748091603
epoch 5: perplexity: 22.92486059434793 perplexity_train: 18.832957376841
____
0.40458015267175573
0.35782442748091603
22.92486059434793
18.832957376841
0.4431818181818182
0.36363636363636365
0.8297872340425532
0.8
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.716586709022522
threshold is:  2.846057415008545
correct cnt  ref is:  424 all is:  1048 ratio is:  0.40458015267175573
correct cnt is:  387 all is:  1048 ratio is:  0.36927480916030536
epoch 6: perplexity: 22.54301157338272 perplexity_train: 18.271319048760148
____
0.40458015267175573
0.36927480916030536
22.54301157338272
18.271319048760148
0.42045454545454547
0.4431818181818182
0.8222222222222222
0.8297872340425532
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7118171453475952
threshold is:  2.8319942951202393
correct cnt  ref is:  447 all is:  1048 ratio is:  0.4265267175572519
correct cnt is:  412 all is:  1048 ratio is:  0.3931297709923664
epoch 7: perplexity: 22.214811871272676 perplexity_train: 17.785879495824194
____
0.4265267175572519
0.3931297709923664
22.214811871272676
17.785879495824194
0.3977272727272727
0.3977272727272727
0.813953488372093
0.813953488372093
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.708565354347229
threshold is:  2.8201920986175537
correct cnt  ref is:  484 all is:  1048 ratio is:  0.4618320610687023
correct cnt is:  439 all is:  1048 ratio is:  0.41889312977099236
epoch 8: perplexity: 21.922446420394625 perplexity_train: 17.350875054193367
____
0.4618320610687023
0.41889312977099236
21.922446420394625
17.350875054193367
0.5
0.45454545454545453
0.8461538461538461
0.8333333333333334
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.7054650187492371
threshold is:  2.8118677139282227
correct cnt  ref is:  503 all is:  1048 ratio is:  0.4799618320610687
correct cnt is:  461 all is:  1048 ratio is:  0.4398854961832061
epoch 9: perplexity: 21.732514425375843 perplexity_train: 17.001949409885807
____
0.4799618320610687
0.4398854961832061
21.732514425375843
17.001949409885807
0.48863636363636365
0.4772727272727273
0.8431372549019608
0.84
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.7016890048980713
threshold is:  2.804321527481079
correct cnt  ref is:  506 all is:  1048 ratio is:  0.48282442748091603
correct cnt is:  482 all is:  1048 ratio is:  0.4599236641221374
epoch 10: perplexity: 21.54220426243615 perplexity_train: 16.698439076513786
____
0.48282442748091603
0.4599236641221374
21.54220426243615
16.698439076513786
0.4659090909090909
0.5454545454545454
0.8367346938775511
0.8571428571428571
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.6977009773254395
threshold is:  2.8035223484039307
correct cnt  ref is:  499 all is:  1048 ratio is:  0.4761450381679389
correct cnt is:  515 all is:  1048 ratio is:  0.491412213740458
epoch 11: perplexity: 21.38932997876121 perplexity_train: 16.440012361696894
____
0.4761450381679389
0.491412213740458
21.38932997876121
16.440012361696894
0.4431818181818182
0.45454545454545453
0.8297872340425532
0.8333333333333334
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.6949009299278259
threshold is:  2.795884132385254
correct cnt  ref is:  506 all is:  1048 ratio is:  0.48282442748091603
correct cnt is:  528 all is:  1048 ratio is:  0.5038167938931297
epoch 12: perplexity: 21.264931087036693 perplexity_train: 16.21766149962077
____
0.48282442748091603
0.5038167938931297
21.264931087036693
16.21766149962077
0.5113636363636364
0.5909090909090909
0.8490566037735849
0.8666666666666667
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.6930485367774963
threshold is:  2.7926905155181885
correct cnt  ref is:  517 all is:  1048 ratio is:  0.4933206106870229
correct cnt is:  535 all is:  1048 ratio is:  0.5104961832061069
epoch 13: perplexity: 21.18602205350757 perplexity_train: 16.043026621206113
____
0.4933206106870229
0.5104961832061069
21.18602205350757
16.043026621206113
0.5227272727272727
0.48863636363636365
0.8518518518518519
0.8431372549019608
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.6905416250228882
threshold is:  2.7872254848480225
correct cnt  ref is:  514 all is:  1048 ratio is:  0.4904580152671756
correct cnt is:  545 all is:  1048 ratio is:  0.5200381679389313
epoch 14: perplexity: 21.07361519623815 perplexity_train: 15.880491706419992
____
0.4904580152671756
0.5200381679389313
21.07361519623815
15.880491706419992
0.3977272727272727
0.3977272727272727
0.813953488372093
0.813953488372093
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.6891520023345947
threshold is:  2.7886757850646973
correct cnt  ref is:  516 all is:  1048 ratio is:  0.49236641221374045
correct cnt is:  564 all is:  1048 ratio is:  0.5381679389312977
epoch 15: perplexity: 21.026624755991048 perplexity_train: 15.760673442442464
____
0.49236641221374045
0.5381679389312977
21.026624755991048
15.760673442442464
0.5568181818181818
0.5
0.8596491228070176
0.8461538461538461
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.6877461671829224
threshold is:  2.787588119506836
correct cnt  ref is:  518 all is:  1048 ratio is:  0.49427480916030536
correct cnt is:  576 all is:  1048 ratio is:  0.549618320610687
epoch 16: perplexity: 20.98183001942161 perplexity_train: 15.661507043870182
____
0.49427480916030536
0.549618320610687
20.98183001942161
15.661507043870182
0.42045454545454547
0.5795454545454546
0.8222222222222222
0.864406779661017
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.6871957182884216
threshold is:  2.7868447303771973
correct cnt  ref is:  523 all is:  1048 ratio is:  0.49904580152671757
correct cnt is:  582 all is:  1048 ratio is:  0.5553435114503816
epoch 17: perplexity: 20.949524029250785 perplexity_train: 15.600054359046934
____
0.49904580152671757
0.5553435114503816
20.949524029250785
15.600054359046934
0.5340909090909091
0.5681818181818182
0.8545454545454545
0.8620689655172413
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.686863362789154
threshold is:  2.7864696979522705
correct cnt  ref is:  526 all is:  1048 ratio is:  0.5019083969465649
correct cnt is:  585 all is:  1048 ratio is:  0.558206106870229
epoch 18: perplexity: 20.927678376062236 perplexity_train: 15.56202216335597
____
0.5019083969465649
0.558206106870229
20.927678376062236
15.56202216335597
0.42045454545454547
0.4772727272727273
0.8222222222222222
0.84
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.6867674589157104
threshold is:  2.7859654426574707
correct cnt  ref is:  527 all is:  1048 ratio is:  0.5028625954198473
correct cnt is:  583 all is:  1048 ratio is:  0.5562977099236641
epoch 19: perplexity: 20.925323442223704 perplexity_train: 15.55377269858761
____
0.5028625954198473
0.5562977099236641
20.925323442223704
15.55377269858761
0.5681818181818182
0.5909090909090909
0.8620689655172413
0.8666666666666667
_____
*************end of training 
threshold_ref is:  0.6867674589157104
threshold is:  2.7859654426574707
correct cnt  ref is:  527 all is:  1048 ratio is:  0.5028625954198473
correct cnt is:  583 all is:  1048 ratio is:  0.5562977099236641
end of training perplexity: 20.925323442223704 perplexity_train: 15.55377269858761
____
0.5028625954198473
0.5562977099236641
20.925323442223704
15.55377269858761
0.5113636363636364
0.5909090909090909
0.8490566037735849
0.8666666666666667
_____
