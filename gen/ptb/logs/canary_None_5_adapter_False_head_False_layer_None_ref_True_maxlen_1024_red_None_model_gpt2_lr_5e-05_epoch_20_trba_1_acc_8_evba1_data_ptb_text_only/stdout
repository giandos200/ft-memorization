Namespace(adapter_reduction=None, add_adapter=False, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=5e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 124.439808
model_params (million) 124.439808
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.7622584700584412
threshold is:  2.99153470993042
correct cnt  ref is:  297 all is:  1048 ratio is:  0.2833969465648855
correct cnt is:  259 all is:  1048 ratio is:  0.24713740458015268
epoch 0: perplexity: 26.250347170093274 perplexity_train: 22.75656353892906
____
0.2833969465648855
0.24713740458015268
26.250347170093274
22.75656353892906
0.2159090909090909
0.2159090909090909
0.7037037037037037
0.7037037037037037
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.7308763861656189
threshold is:  2.891268491744995
correct cnt  ref is:  385 all is:  1048 ratio is:  0.36736641221374045
correct cnt is:  341 all is:  1048 ratio is:  0.32538167938931295
epoch 1: perplexity: 23.554194230861835 perplexity_train: 19.6476965929353
____
0.36736641221374045
0.32538167938931295
23.554194230861835
19.6476965929353
0.4318181818181818
0.42045454545454547
0.8260869565217391
0.8222222222222222
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.7119135856628418
threshold is:  2.8320560455322266
correct cnt  ref is:  439 all is:  1048 ratio is:  0.41889312977099236
correct cnt is:  404 all is:  1048 ratio is:  0.38549618320610685
epoch 2: perplexity: 22.235864532709257 perplexity_train: 17.829741933903033
____
0.41889312977099236
0.38549618320610685
22.235864532709257
17.829741933903033
0.4090909090909091
0.3977272727272727
0.8181818181818182
0.813953488372093
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.6976560354232788
threshold is:  2.8005549907684326
correct cnt  ref is:  489 all is:  1048 ratio is:  0.4666030534351145
correct cnt is:  487 all is:  1048 ratio is:  0.46469465648854963
epoch 3: perplexity: 21.456234236236416 perplexity_train: 16.55445365319273
____
0.4666030534351145
0.46469465648854963
21.456234236236416
16.55445365319273
0.4659090909090909
0.5113636363636364
0.8367346938775511
0.8490566037735849
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.6878126859664917
threshold is:  2.78743314743042
correct cnt  ref is:  537 all is:  1048 ratio is:  0.5124045801526718
correct cnt is:  589 all is:  1048 ratio is:  0.5620229007633588
epoch 4: perplexity: 20.925363354148825 perplexity_train: 15.534638481485672
____
0.5124045801526718
0.5620229007633588
20.925363354148825
15.534638481485672
0.5113636363636364
0.5227272727272727
0.8490566037735849
0.8518518518518519
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.6807339191436768
threshold is:  2.7675535678863525
correct cnt  ref is:  578 all is:  1048 ratio is:  0.5515267175572519
correct cnt is:  658 all is:  1048 ratio is:  0.6278625954198473
epoch 5: perplexity: 20.50921427227021 perplexity_train: 14.708727691781075
____
0.5515267175572519
0.6278625954198473
20.50921427227021
14.708727691781075
0.5340909090909091
0.6477272727272727
0.8545454545454545
0.8769230769230769
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.6769965887069702
threshold is:  2.761688470840454
correct cnt  ref is:  641 all is:  1048 ratio is:  0.6116412213740458
correct cnt is:  720 all is:  1048 ratio is:  0.6870229007633588
epoch 6: perplexity: 20.220528889072803 perplexity_train: 14.024304960615133
____
0.6116412213740458
0.6870229007633588
20.220528889072803
14.024304960615133
0.6590909090909091
0.6590909090909091
0.8787878787878788
0.8787878787878788
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.6727008819580078
threshold is:  2.743441104888916
correct cnt  ref is:  693 all is:  1048 ratio is:  0.6612595419847328
correct cnt is:  758 all is:  1048 ratio is:  0.7232824427480916
epoch 7: perplexity: 20.031745052446873 perplexity_train: 13.452663579824938
____
0.6612595419847328
0.7232824427480916
20.031745052446873
13.452663579824938
0.6022727272727273
0.7159090909090909
0.8688524590163934
0.8873239436619719
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.6705824136734009
threshold is:  2.7045881748199463
correct cnt  ref is:  758 all is:  1048 ratio is:  0.7232824427480916
correct cnt is:  752 all is:  1048 ratio is:  0.7175572519083969
epoch 8: perplexity: 19.817570194417172 perplexity_train: 12.939144789417941
____
0.7232824427480916
0.7175572519083969
19.817570194417172
12.939144789417941
0.7954545454545454
0.7613636363636364
0.8974358974358975
0.8933333333333333
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.6683407425880432
threshold is:  2.6916775703430176
correct cnt  ref is:  796 all is:  1048 ratio is:  0.7595419847328244
correct cnt is:  788 all is:  1048 ratio is:  0.7519083969465649
epoch 9: perplexity: 19.774361120006134 perplexity_train: 12.52865567417669
____
0.7595419847328244
0.7519083969465649
19.774361120006134
12.52865567417669
0.8181818181818182
0.7613636363636364
0.9
0.8933333333333333
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.666382908821106
threshold is:  2.6871306896209717
correct cnt  ref is:  838 all is:  1048 ratio is:  0.799618320610687
correct cnt is:  819 all is:  1048 ratio is:  0.7814885496183206
epoch 10: perplexity: 19.665495910167003 perplexity_train: 12.151423198421275
____
0.799618320610687
0.7814885496183206
19.665495910167003
12.151423198421275
0.8409090909090909
0.8068181818181818
0.9024390243902439
0.8987341772151899
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.6665726900100708
threshold is:  2.692270040512085
correct cnt  ref is:  887 all is:  1048 ratio is:  0.8463740458015268
correct cnt is:  853 all is:  1048 ratio is:  0.8139312977099237
epoch 11: perplexity: 19.600749742789013 perplexity_train: 11.855471915074851
____
0.8463740458015268
0.8139312977099237
19.600749742789013
11.855471915074851
0.7954545454545454
0.7272727272727273
0.8974358974358975
0.8888888888888888
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.6639699935913086
threshold is:  2.6853859424591064
correct cnt  ref is:  905 all is:  1048 ratio is:  0.8635496183206107
correct cnt is:  872 all is:  1048 ratio is:  0.8320610687022901
epoch 12: perplexity: 19.578433987943676 perplexity_train: 11.596260089789487
____
0.8635496183206107
0.8320610687022901
19.578433987943676
11.596260089789487
0.8409090909090909
0.8636363636363636
0.9024390243902439
0.9047619047619048
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.6644073128700256
threshold is:  2.6824142932891846
correct cnt  ref is:  931 all is:  1048 ratio is:  0.8883587786259542
correct cnt is:  895 all is:  1048 ratio is:  0.8540076335877863
epoch 13: perplexity: 19.560969972543063 perplexity_train: 11.372879145639077
____
0.8883587786259542
0.8540076335877863
19.560969972543063
11.372879145639077
0.8977272727272727
0.9204545454545454
0.9080459770114943
0.9101123595505618
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.6629824638366699
threshold is:  2.6850409507751465
correct cnt  ref is:  951 all is:  1048 ratio is:  0.9074427480916031
correct cnt is:  920 all is:  1048 ratio is:  0.8778625954198473
epoch 14: perplexity: 19.514435063322743 perplexity_train: 11.176483932603725
____
0.9074427480916031
0.8778625954198473
19.514435063322743
11.176483932603725
0.8295454545454546
0.8409090909090909
0.9012345679012346
0.9024390243902439
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.6632741093635559
threshold is:  2.6848127841949463
correct cnt  ref is:  971 all is:  1048 ratio is:  0.9265267175572519
correct cnt is:  932 all is:  1048 ratio is:  0.8893129770992366
epoch 15: perplexity: 19.524799163371327 perplexity_train: 11.036704827633175
____
0.9265267175572519
0.8893129770992366
19.524799163371327
11.036704827633175
0.9886363636363636
0.9545454545454546
0.9157894736842105
0.9130434782608695
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.6629428863525391
threshold is:  2.682326555252075
correct cnt  ref is:  976 all is:  1048 ratio is:  0.9312977099236641
correct cnt is:  943 all is:  1048 ratio is:  0.8998091603053435
epoch 16: perplexity: 19.553854462862553 perplexity_train: 10.92213708131854
____
0.9312977099236641
0.8998091603053435
19.553854462862553
10.92213708131854
0.8977272727272727
0.8522727272727273
0.9080459770114943
0.9036144578313253
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.662448525428772
threshold is:  2.681739091873169
correct cnt  ref is:  980 all is:  1048 ratio is:  0.9351145038167938
correct cnt is:  945 all is:  1048 ratio is:  0.9017175572519084
epoch 17: perplexity: 19.539952654396203 perplexity_train: 10.846624356405211
____
0.9351145038167938
0.9017175572519084
19.539952654396203
10.846624356405211
0.9545454545454546
0.9431818181818182
0.9130434782608695
0.9120879120879121
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.6628343462944031
threshold is:  2.6826207637786865
correct cnt  ref is:  985 all is:  1048 ratio is:  0.9398854961832062
correct cnt is:  950 all is:  1048 ratio is:  0.9064885496183206
epoch 18: perplexity: 19.551845243149526 perplexity_train: 10.799441595084698
____
0.9398854961832062
0.9064885496183206
19.551845243149526
10.799441595084698
0.875
0.8636363636363636
0.9058823529411765
0.9047619047619048
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.6628514528274536
threshold is:  2.68304443359375
correct cnt  ref is:  990 all is:  1048 ratio is:  0.9446564885496184
correct cnt is:  952 all is:  1048 ratio is:  0.9083969465648855
epoch 19: perplexity: 19.566119373538875 perplexity_train: 10.786572756180611
____
0.9446564885496184
0.9083969465648855
19.566119373538875
10.786572756180611
0.9659090909090909
0.9659090909090909
0.9139784946236559
0.9139784946236559
_____
*************end of training 
threshold_ref is:  0.6628514528274536
threshold is:  2.68304443359375
correct cnt  ref is:  990 all is:  1048 ratio is:  0.9446564885496184
correct cnt is:  952 all is:  1048 ratio is:  0.9083969465648855
end of training perplexity: 19.566119373538875 perplexity_train: 10.786572756180611
____
0.9446564885496184
0.9083969465648855
19.566119373538875
10.786572756180611
0.9659090909090909
0.9431818181818182
0.9139784946236559
0.9120879120879121
_____
