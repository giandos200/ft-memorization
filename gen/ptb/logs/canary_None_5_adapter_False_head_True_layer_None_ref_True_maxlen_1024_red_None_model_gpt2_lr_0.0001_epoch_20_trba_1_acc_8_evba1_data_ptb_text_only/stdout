Namespace(adapter_reduction=None, add_adapter=False, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0001, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=True, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 38.597376
model_params (million) 38.597376
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.8961020708084106
threshold is:  3.4706459045410156
correct cnt  ref is:  214 all is:  1048 ratio is:  0.20419847328244276
correct cnt is:  195 all is:  1048 ratio is:  0.18606870229007633
epoch 0: perplexity: 43.2431890628177 perplexity_train: 38.05147534791872
____
0.20419847328244276
0.18606870229007633
43.2431890628177
38.05147534791872
0.18181818181818182
0.14772727272727273
0.6666666666666666
0.6190476190476191
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.8712216019630432
threshold is:  3.39174747467041
correct cnt  ref is:  200 all is:  1048 ratio is:  0.19083969465648856
correct cnt is:  212 all is:  1048 ratio is:  0.20229007633587787
epoch 1: perplexity: 39.90701199703307 perplexity_train: 34.84438881530712
____
0.19083969465648856
0.20229007633587787
39.90701199703307
34.84438881530712
0.2727272727272727
0.26136363636363635
0.75
0.7419354838709677
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.855789065361023
threshold is:  3.347079277038574
correct cnt  ref is:  247 all is:  1048 ratio is:  0.23568702290076335
correct cnt is:  245 all is:  1048 ratio is:  0.23377862595419846
epoch 2: perplexity: 37.67349492233643 perplexity_train: 32.634917213160456
____
0.23568702290076335
0.23377862595419846
37.67349492233643
32.634917213160456
0.22727272727272727
0.22727272727272727
0.7142857142857143
0.7142857142857143
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.844548225402832
threshold is:  3.3046154975891113
correct cnt  ref is:  286 all is:  1048 ratio is:  0.2729007633587786
correct cnt is:  263 all is:  1048 ratio is:  0.25095419847328243
epoch 3: perplexity: 36.09548586926828 perplexity_train: 31.035924181661322
____
0.2729007633587786
0.25095419847328243
36.09548586926828
31.035924181661322
0.2727272727272727
0.26136363636363635
0.75
0.7419354838709677
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.8334516882896423
threshold is:  3.2700793743133545
correct cnt  ref is:  300 all is:  1048 ratio is:  0.2862595419847328
correct cnt is:  276 all is:  1048 ratio is:  0.2633587786259542
epoch 4: perplexity: 34.74631524234805 perplexity_train: 29.705186467200427
____
0.2862595419847328
0.2633587786259542
34.74631524234805
29.705186467200427
0.25
0.25
0.7333333333333333
0.7333333333333333
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.8244175314903259
threshold is:  3.242339611053467
correct cnt  ref is:  304 all is:  1048 ratio is:  0.2900763358778626
correct cnt is:  286 all is:  1048 ratio is:  0.2729007633587786
epoch 5: perplexity: 33.7537206412897 perplexity_train: 28.67135723560217
____
0.2900763358778626
0.2729007633587786
33.7537206412897
28.67135723560217
0.2840909090909091
0.3181818181818182
0.7575757575757576
0.7777777777777778
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.8177314400672913
threshold is:  3.221263885498047
correct cnt  ref is:  335 all is:  1048 ratio is:  0.3196564885496183
correct cnt is:  299 all is:  1048 ratio is:  0.28530534351145037
epoch 6: perplexity: 32.90236627878355 perplexity_train: 27.796594181635832
____
0.3196564885496183
0.28530534351145037
32.90236627878355
27.796594181635832
0.3181818181818182
0.32954545454545453
0.7777777777777778
0.7837837837837838
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.8100798726081848
threshold is:  3.215568780899048
correct cnt  ref is:  331 all is:  1048 ratio is:  0.31583969465648853
correct cnt is:  349 all is:  1048 ratio is:  0.3330152671755725
epoch 7: perplexity: 32.16107174566195 perplexity_train: 27.013780947800928
____
0.31583969465648853
0.3330152671755725
32.16107174566195
27.013780947800928
0.2727272727272727
0.32954545454545453
0.75
0.7837837837837838
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.8042587637901306
threshold is:  3.192892551422119
correct cnt  ref is:  340 all is:  1048 ratio is:  0.3244274809160305
correct cnt is:  347 all is:  1048 ratio is:  0.33110687022900764
epoch 8: perplexity: 31.558042829075063 perplexity_train: 26.351605362190927
____
0.3244274809160305
0.33110687022900764
31.558042829075063
26.351605362190927
0.3522727272727273
0.3522727272727273
0.7948717948717948
0.7948717948717948
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.799159586429596
threshold is:  3.1758477687835693
correct cnt  ref is:  349 all is:  1048 ratio is:  0.3330152671755725
correct cnt is:  357 all is:  1048 ratio is:  0.34064885496183206
epoch 9: perplexity: 30.94954397963714 perplexity_train: 25.735666625496467
____
0.3330152671755725
0.34064885496183206
30.94954397963714
25.735666625496467
0.3068181818181818
0.3522727272727273
0.7714285714285715
0.7948717948717948
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.795897364616394
threshold is:  3.1672165393829346
correct cnt  ref is:  373 all is:  1048 ratio is:  0.35591603053435117
correct cnt is:  375 all is:  1048 ratio is:  0.35782442748091603
epoch 10: perplexity: 30.481421206889213 perplexity_train: 25.247204072017666
____
0.35591603053435117
0.35782442748091603
30.481421206889213
25.247204072017666
0.3068181818181818
0.4090909090909091
0.7714285714285715
0.8181818181818182
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.7925426959991455
threshold is:  3.1517155170440674
correct cnt  ref is:  382 all is:  1048 ratio is:  0.36450381679389315
correct cnt is:  378 all is:  1048 ratio is:  0.3606870229007634
epoch 11: perplexity: 30.111896902150253 perplexity_train: 24.84283733985413
____
0.36450381679389315
0.3606870229007634
30.111896902150253
24.84283733985413
0.3522727272727273
0.375
0.7948717948717948
0.8048780487804879
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.7901150584220886
threshold is:  3.145216941833496
correct cnt  ref is:  397 all is:  1048 ratio is:  0.3788167938931298
correct cnt is:  395 all is:  1048 ratio is:  0.37690839694656486
epoch 12: perplexity: 29.782582997065475 perplexity_train: 24.494121764453297
____
0.3788167938931298
0.37690839694656486
29.782582997065475
24.494121764453297
0.38636363636363635
0.4772727272727273
0.8095238095238095
0.84
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.7879258990287781
threshold is:  3.139460325241089
correct cnt  ref is:  408 all is:  1048 ratio is:  0.3893129770992366
correct cnt is:  409 all is:  1048 ratio is:  0.3902671755725191
epoch 13: perplexity: 29.555005445174743 perplexity_train: 24.228562032871093
____
0.3893129770992366
0.3902671755725191
29.555005445174743
24.228562032871093
0.45454545454545453
0.375
0.8333333333333334
0.8048780487804879
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.7869110703468323
threshold is:  3.132251739501953
correct cnt  ref is:  419 all is:  1048 ratio is:  0.3998091603053435
correct cnt is:  414 all is:  1048 ratio is:  0.3950381679389313
epoch 14: perplexity: 29.352125635435193 perplexity_train: 23.992328575921974
____
0.3998091603053435
0.3950381679389313
29.352125635435193
23.992328575921974
0.32954545454545453
0.29545454545454547
0.7837837837837838
0.7647058823529411
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.7852804064750671
threshold is:  3.129079818725586
correct cnt  ref is:  424 all is:  1048 ratio is:  0.40458015267175573
correct cnt is:  422 all is:  1048 ratio is:  0.4026717557251908
epoch 15: perplexity: 29.20148768201378 perplexity_train: 23.815530631920506
____
0.40458015267175573
0.4026717557251908
29.20148768201378
23.815530631920506
0.5
0.42045454545454547
0.8461538461538461
0.8222222222222222
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.7841820120811462
threshold is:  3.1244375705718994
correct cnt  ref is:  429 all is:  1048 ratio is:  0.40935114503816794
correct cnt is:  428 all is:  1048 ratio is:  0.4083969465648855
epoch 16: perplexity: 29.078170156297737 perplexity_train: 23.677907409973407
____
0.40935114503816794
0.4083969465648855
29.078170156297737
23.677907409973407
0.36363636363636365
0.45454545454545453
0.8
0.8333333333333334
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.7837492227554321
threshold is:  3.121868133544922
correct cnt  ref is:  437 all is:  1048 ratio is:  0.4169847328244275
correct cnt is:  430 all is:  1048 ratio is:  0.41030534351145037
epoch 17: perplexity: 29.00406324764381 perplexity_train: 23.590190635317544
____
0.4169847328244275
0.41030534351145037
29.00406324764381
23.590190635317544
0.4659090909090909
0.4431818181818182
0.8367346938775511
0.8297872340425532
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.7833732962608337
threshold is:  3.1202008724212646
correct cnt  ref is:  439 all is:  1048 ratio is:  0.41889312977099236
correct cnt is:  432 all is:  1048 ratio is:  0.4122137404580153
epoch 18: perplexity: 28.955221522406863 perplexity_train: 23.533935678982957
____
0.41889312977099236
0.4122137404580153
28.955221522406863
23.533935678982957
0.3409090909090909
0.32954545454545453
0.7894736842105263
0.7837837837837838
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.7832174897193909
threshold is:  3.120135545730591
correct cnt  ref is:  439 all is:  1048 ratio is:  0.41889312977099236
correct cnt is:  433 all is:  1048 ratio is:  0.4131679389312977
epoch 19: perplexity: 28.943170584854474 perplexity_train: 23.520540597663942
____
0.41889312977099236
0.4131679389312977
28.943170584854474
23.520540597663942
0.5113636363636364
0.375
0.8490566037735849
0.8048780487804879
_____
*************end of training 
threshold_ref is:  0.7832174897193909
threshold is:  3.120135545730591
correct cnt  ref is:  439 all is:  1048 ratio is:  0.41889312977099236
correct cnt is:  433 all is:  1048 ratio is:  0.4131679389312977
end of training perplexity: 28.943170584854474 perplexity_train: 23.520540597663942
____
0.41889312977099236
0.4131679389312977
28.943170584854474
23.520540597663942
0.4431818181818182
0.4431818181818182
0.8297872340425532
0.8297872340425532
_____
