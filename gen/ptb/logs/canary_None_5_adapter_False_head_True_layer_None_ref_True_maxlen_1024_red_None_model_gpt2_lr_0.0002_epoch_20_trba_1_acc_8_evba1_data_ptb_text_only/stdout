Namespace(adapter_reduction=None, add_adapter=False, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0002, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=True, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 38.597376
model_params (million) 38.597376
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.8722236156463623
threshold is:  3.3982605934143066
correct cnt  ref is:  190 all is:  1048 ratio is:  0.18129770992366412
correct cnt is:  207 all is:  1048 ratio is:  0.19751908396946566
epoch 0: perplexity: 40.256980320226205 perplexity_train: 35.0754032942875
____
0.18129770992366412
0.19751908396946566
40.256980320226205
35.0754032942875
0.17045454545454544
0.14772727272727273
0.6521739130434783
0.6190476190476191
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.8429436683654785
threshold is:  3.298490047454834
correct cnt  ref is:  271 all is:  1048 ratio is:  0.258587786259542
correct cnt is:  249 all is:  1048 ratio is:  0.23759541984732824
epoch 1: perplexity: 36.051545427979 perplexity_train: 31.03064135908944
____
0.258587786259542
0.23759541984732824
36.051545427979
31.03064135908944
0.32954545454545453
0.3181818181818182
0.7837837837837838
0.7777777777777778
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.8220050930976868
threshold is:  3.231668710708618
correct cnt  ref is:  309 all is:  1048 ratio is:  0.2948473282442748
correct cnt is:  281 all is:  1048 ratio is:  0.2681297709923664
epoch 2: perplexity: 33.507012698439866 perplexity_train: 28.37105903178133
____
0.2948473282442748
0.2681297709923664
33.507012698439866
28.37105903178133
0.2840909090909091
0.26136363636363635
0.7575757575757576
0.7419354838709677
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.8059747815132141
threshold is:  3.198423385620117
correct cnt  ref is:  349 all is:  1048 ratio is:  0.3330152671755725
correct cnt is:  348 all is:  1048 ratio is:  0.3320610687022901
epoch 3: perplexity: 31.752041717770044 perplexity_train: 26.475830033297836
____
0.3330152671755725
0.3320610687022901
31.752041717770044
26.475830033297836
0.29545454545454547
0.3409090909090909
0.7647058823529411
0.7894736842105263
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7934466600418091
threshold is:  3.1609067916870117
correct cnt  ref is:  388 all is:  1048 ratio is:  0.3702290076335878
correct cnt is:  388 all is:  1048 ratio is:  0.3702290076335878
epoch 4: perplexity: 30.228137134595247 perplexity_train: 24.888616828013767
____
0.3702290076335878
0.3702290076335878
30.228137134595247
24.888616828013767
0.32954545454545453
0.36363636363636365
0.7837837837837838
0.8
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.7839688658714294
threshold is:  3.123410701751709
correct cnt  ref is:  435 all is:  1048 ratio is:  0.4150763358778626
correct cnt is:  428 all is:  1048 ratio is:  0.4083969465648855
epoch 5: perplexity: 29.11331975961021 perplexity_train: 23.65405694558202
____
0.4150763358778626
0.4083969465648855
29.11331975961021
23.65405694558202
0.42045454545454547
0.45454545454545453
0.8222222222222222
0.8333333333333334
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.7768729329109192
threshold is:  3.1110169887542725
correct cnt  ref is:  474 all is:  1048 ratio is:  0.45229007633587787
correct cnt is:  484 all is:  1048 ratio is:  0.4618320610687023
epoch 6: perplexity: 28.34680626297719 perplexity_train: 22.74027633081391
____
0.45229007633587787
0.4618320610687023
28.34680626297719
22.74027633081391
0.45454545454545453
0.48863636363636365
0.8333333333333334
0.8431372549019608
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7690906524658203
threshold is:  3.0871999263763428
correct cnt  ref is:  482 all is:  1048 ratio is:  0.4599236641221374
correct cnt is:  511 all is:  1048 ratio is:  0.48759541984732824
epoch 7: perplexity: 27.701464476696913 perplexity_train: 21.95777087987792
____
0.4599236641221374
0.48759541984732824
27.701464476696913
21.95777087987792
0.36363636363636365
0.4659090909090909
0.8
0.8367346938775511
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.7624499797821045
threshold is:  3.0492091178894043
correct cnt  ref is:  497 all is:  1048 ratio is:  0.47423664122137404
correct cnt is:  491 all is:  1048 ratio is:  0.4685114503816794
epoch 8: perplexity: 27.238449625149812 perplexity_train: 21.32979340866875
____
0.47423664122137404
0.4685114503816794
27.238449625149812
21.32979340866875
0.5227272727272727
0.48863636363636365
0.8518518518518519
0.8431372549019608
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.758287250995636
threshold is:  3.0306780338287354
correct cnt  ref is:  509 all is:  1048 ratio is:  0.4856870229007634
correct cnt is:  504 all is:  1048 ratio is:  0.48091603053435117
epoch 9: perplexity: 26.82427754176753 perplexity_train: 20.813292409466953
____
0.4856870229007634
0.48091603053435117
26.82427754176753
20.813292409466953
0.5340909090909091
0.5227272727272727
0.8545454545454545
0.8518518518518519
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.754313051700592
threshold is:  3.0280933380126953
correct cnt  ref is:  531 all is:  1048 ratio is:  0.5066793893129771
correct cnt is:  543 all is:  1048 ratio is:  0.5181297709923665
epoch 10: perplexity: 26.50059225089683 perplexity_train: 20.387469523801485
____
0.5066793893129771
0.5181297709923665
26.50059225089683
20.387469523801485
0.4772727272727273
0.5795454545454546
0.84
0.864406779661017
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.7506046295166016
threshold is:  3.0196328163146973
correct cnt  ref is:  544 all is:  1048 ratio is:  0.5190839694656488
correct cnt is:  564 all is:  1048 ratio is:  0.5381679389312977
epoch 11: perplexity: 26.24525944540227 perplexity_train: 20.022448454804184
____
0.5190839694656488
0.5381679389312977
26.24525944540227
20.022448454804184
0.4772727272727273
0.48863636363636365
0.84
0.8431372549019608
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.7479614615440369
threshold is:  3.009735107421875
correct cnt  ref is:  559 all is:  1048 ratio is:  0.5333969465648855
correct cnt is:  575 all is:  1048 ratio is:  0.5486641221374046
epoch 12: perplexity: 26.006253306042378 perplexity_train: 19.715888006716224
____
0.5333969465648855
0.5486641221374046
26.006253306042378
19.715888006716224
0.5
0.625
0.8461538461538461
0.873015873015873
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.7445929050445557
threshold is:  3.003535270690918
correct cnt  ref is:  556 all is:  1048 ratio is:  0.5305343511450382
correct cnt is:  586 all is:  1048 ratio is:  0.5591603053435115
epoch 13: perplexity: 25.849535534014684 perplexity_train: 19.47486297108996
____
0.5305343511450382
0.5591603053435115
25.849535534014684
19.47486297108996
0.6022727272727273
0.5227272727272727
0.8688524590163934
0.8518518518518519
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.7435463666915894
threshold is:  2.995133399963379
correct cnt  ref is:  569 all is:  1048 ratio is:  0.5429389312977099
correct cnt is:  593 all is:  1048 ratio is:  0.5658396946564885
epoch 14: perplexity: 25.70068533388207 perplexity_train: 19.2608506045602
____
0.5429389312977099
0.5658396946564885
25.70068533388207
19.2608506045602
0.4431818181818182
0.4772727272727273
0.8297872340425532
0.84
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.7414196729660034
threshold is:  2.9877655506134033
correct cnt  ref is:  573 all is:  1048 ratio is:  0.5467557251908397
correct cnt is:  592 all is:  1048 ratio is:  0.5648854961832062
epoch 15: perplexity: 25.589839234948748 perplexity_train: 19.104670111951794
____
0.5467557251908397
0.5648854961832062
25.589839234948748
19.104670111951794
0.6590909090909091
0.5568181818181818
0.8787878787878788
0.8596491228070176
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.7404140830039978
threshold is:  2.9862923622131348
correct cnt  ref is:  576 all is:  1048 ratio is:  0.549618320610687
correct cnt is:  607 all is:  1048 ratio is:  0.5791984732824428
epoch 16: perplexity: 25.49314920939503 perplexity_train: 18.975421943768993
____
0.549618320610687
0.5791984732824428
25.49314920939503
18.975421943768993
0.5113636363636364
0.5909090909090909
0.8490566037735849
0.8666666666666667
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.739549994468689
threshold is:  2.9832544326782227
correct cnt  ref is:  582 all is:  1048 ratio is:  0.5553435114503816
correct cnt is:  611 all is:  1048 ratio is:  0.5830152671755725
epoch 17: perplexity: 25.43353266901043 perplexity_train: 18.89317174302155
____
0.5553435114503816
0.5830152671755725
25.43353266901043
18.89317174302155
0.6022727272727273
0.5795454545454546
0.8688524590163934
0.864406779661017
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.7391759157180786
threshold is:  2.98238205909729
correct cnt  ref is:  584 all is:  1048 ratio is:  0.5572519083969466
correct cnt is:  619 all is:  1048 ratio is:  0.5906488549618321
epoch 18: perplexity: 25.395310799045575 perplexity_train: 18.841463597672064
____
0.5572519083969466
0.5906488549618321
25.395310799045575
18.841463597672064
0.5113636363636364
0.48863636363636365
0.8490566037735849
0.8431372549019608
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.7390600442886353
threshold is:  2.981842041015625
correct cnt  ref is:  584 all is:  1048 ratio is:  0.5572519083969466
correct cnt is:  619 all is:  1048 ratio is:  0.5906488549618321
epoch 19: perplexity: 25.385885359030954 perplexity_train: 18.829747209705506
____
0.5572519083969466
0.5906488549618321
25.385885359030954
18.829747209705506
0.6136363636363636
0.6136363636363636
0.8709677419354839
0.8709677419354839
_____
*************end of training 
threshold_ref is:  0.7390600442886353
threshold is:  2.981842041015625
correct cnt  ref is:  584 all is:  1048 ratio is:  0.5572519083969466
correct cnt is:  619 all is:  1048 ratio is:  0.5906488549618321
end of training perplexity: 25.385885359030954 perplexity_train: 18.829747209705506
____
0.5572519083969466
0.5906488549618321
25.385885359030954
18.829747209705506
0.5909090909090909
0.625
0.8666666666666667
0.873015873015873
_____
