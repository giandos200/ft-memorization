Namespace(adapter_reduction=None, add_adapter=False, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0005, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=True, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 38.597376
model_params (million) 38.597376
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.8353670835494995
threshold is:  3.285284996032715
correct cnt  ref is:  256 all is:  1048 ratio is:  0.24427480916030533
correct cnt is:  268 all is:  1048 ratio is:  0.25572519083969464
epoch 0: perplexity: 35.588512915886895 perplexity_train: 30.340557872135353
____
0.24427480916030533
0.25572519083969464
35.588512915886895
30.340557872135353
0.20454545454545456
0.18181818181818182
0.6923076923076923
0.6666666666666666
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.7955282330513
threshold is:  3.1733436584472656
correct cnt  ref is:  380 all is:  1048 ratio is:  0.36259541984732824
correct cnt is:  394 all is:  1048 ratio is:  0.37595419847328243
epoch 1: perplexity: 30.665862418735948 perplexity_train: 25.193844361225892
____
0.36259541984732824
0.37595419847328243
30.665862418735948
25.193844361225892
0.42045454545454547
0.45454545454545453
0.8222222222222222
0.8333333333333334
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.7713096737861633
threshold is:  3.0949454307556152
correct cnt  ref is:  472 all is:  1048 ratio is:  0.45038167938931295
correct cnt is:  492 all is:  1048 ratio is:  0.46946564885496184
epoch 2: perplexity: 28.207184674659764 perplexity_train: 22.239390271947894
____
0.45038167938931295
0.46946564885496184
28.207184674659764
22.239390271947894
0.4431818181818182
0.4659090909090909
0.8297872340425532
0.8367346938775511
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7540110945701599
threshold is:  3.038602828979492
correct cnt  ref is:  522 all is:  1048 ratio is:  0.49809160305343514
correct cnt is:  563 all is:  1048 ratio is:  0.5372137404580153
epoch 3: perplexity: 26.880731556044204 perplexity_train: 20.3800144943393
____
0.49809160305343514
0.5372137404580153
26.880731556044204
20.3800144943393
0.4659090909090909
0.5681818181818182
0.8367346938775511
0.8620689655172413
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7423737049102783
threshold is:  2.9803826808929443
correct cnt  ref is:  603 all is:  1048 ratio is:  0.575381679389313
correct cnt is:  599 all is:  1048 ratio is:  0.5715648854961832
epoch 4: perplexity: 25.815316522225075 perplexity_train: 18.969668169810962
____
0.575381679389313
0.5715648854961832
25.815316522225075
18.969668169810962
0.5681818181818182
0.5795454545454546
0.8620689655172413
0.864406779661017
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.733199417591095
threshold is:  2.9650251865386963
correct cnt  ref is:  653 all is:  1048 ratio is:  0.6230916030534351
correct cnt is:  689 all is:  1048 ratio is:  0.6574427480916031
epoch 5: perplexity: 25.161909077996413 perplexity_train: 17.913152869126222
____
0.6230916030534351
0.6574427480916031
25.161909077996413
17.913152869126222
0.5795454545454546
0.6590909090909091
0.864406779661017
0.8787878787878788
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.7304964661598206
threshold is:  2.927863359451294
correct cnt  ref is:  760 all is:  1048 ratio is:  0.7251908396946565
correct cnt is:  703 all is:  1048 ratio is:  0.6708015267175572
epoch 6: perplexity: 24.5946737981681 perplexity_train: 17.050808375694448
____
0.7251908396946565
0.6708015267175572
24.5946737981681
17.050808375694448
0.7159090909090909
0.6477272727272727
0.8873239436619719
0.8769230769230769
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7252355813980103
threshold is:  2.906170129776001
correct cnt  ref is:  803 all is:  1048 ratio is:  0.7662213740458015
correct cnt is:  732 all is:  1048 ratio is:  0.6984732824427481
epoch 7: perplexity: 24.217271529977094 perplexity_train: 16.360386991155874
____
0.7662213740458015
0.6984732824427481
24.217271529977094
16.360386991155874
0.7840909090909091
0.6931818181818182
0.8961038961038961
0.8840579710144928
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.7217531800270081
threshold is:  2.908597707748413
correct cnt  ref is:  840 all is:  1048 ratio is:  0.8015267175572519
correct cnt is:  788 all is:  1048 ratio is:  0.7519083969465649
epoch 8: perplexity: 23.98261189554467 perplexity_train: 15.79737562090293
____
0.8015267175572519
0.7519083969465649
23.98261189554467
15.79737562090293
0.8295454545454546
0.75
0.9012345679012346
0.8918918918918919
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.7201080918312073
threshold is:  2.9009931087493896
correct cnt  ref is:  888 all is:  1048 ratio is:  0.8473282442748091
correct cnt is:  829 all is:  1048 ratio is:  0.791030534351145
epoch 9: perplexity: 23.74204516128891 perplexity_train: 15.329137079081876
____
0.8473282442748091
0.791030534351145
23.74204516128891
15.329137079081876
0.875
0.7613636363636364
0.9058823529411765
0.8933333333333333
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.7182652354240417
threshold is:  2.892561912536621
correct cnt  ref is:  920 all is:  1048 ratio is:  0.8778625954198473
correct cnt is:  851 all is:  1048 ratio is:  0.8120229007633588
epoch 10: perplexity: 23.53907584984194 perplexity_train: 14.926406820086186
____
0.8778625954198473
0.8120229007633588
23.53907584984194
14.926406820086186
0.9090909090909091
0.8181818181818182
0.9090909090909091
0.9
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.7165048718452454
threshold is:  2.866178035736084
correct cnt  ref is:  941 all is:  1048 ratio is:  0.8979007633587787
correct cnt is:  846 all is:  1048 ratio is:  0.8072519083969466
epoch 11: perplexity: 23.4052152142253 perplexity_train: 14.595533553431672
____
0.8979007633587787
0.8072519083969466
23.4052152142253
14.595533553431672
0.8295454545454546
0.6931818181818182
0.9012345679012346
0.8840579710144928
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.7170286178588867
threshold is:  2.8599894046783447
correct cnt  ref is:  979 all is:  1048 ratio is:  0.9341603053435115
correct cnt is:  869 all is:  1048 ratio is:  0.8291984732824428
epoch 12: perplexity: 23.245780871876985 perplexity_train: 14.29912648004445
____
0.9341603053435115
0.8291984732824428
23.245780871876985
14.29912648004445
0.9204545454545454
0.8636363636363636
0.9101123595505618
0.9047619047619048
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.7138462662696838
threshold is:  2.846461772918701
correct cnt  ref is:  980 all is:  1048 ratio is:  0.9351145038167938
correct cnt is:  873 all is:  1048 ratio is:  0.8330152671755725
epoch 13: perplexity: 23.14971147035123 perplexity_train: 14.067923757082943
____
0.9351145038167938
0.8330152671755725
23.14971147035123
14.067923757082943
0.9431818181818182
0.8636363636363636
0.9120879120879121
0.9047619047619048
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.7143548130989075
threshold is:  2.845160722732544
correct cnt  ref is:  999 all is:  1048 ratio is:  0.9532442748091603
correct cnt is:  890 all is:  1048 ratio is:  0.8492366412213741
epoch 14: perplexity: 23.060289481730297 perplexity_train: 13.868083300639992
____
0.9532442748091603
0.8492366412213741
23.060289481730297
13.868083300639992
0.9318181818181818
0.8522727272727273
0.9111111111111111
0.9036144578313253
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.7119106650352478
threshold is:  2.8425211906433105
correct cnt  ref is:  997 all is:  1048 ratio is:  0.9513358778625954
correct cnt is:  897 all is:  1048 ratio is:  0.8559160305343512
epoch 15: perplexity: 22.998185364663325 perplexity_train: 13.721653911338166
____
0.9513358778625954
0.8559160305343512
22.998185364663325
13.721653911338166
0.9886363636363636
0.9090909090909091
0.9157894736842105
0.9090909090909091
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.713026762008667
threshold is:  2.833794355392456
correct cnt  ref is:  1008 all is:  1048 ratio is:  0.9618320610687023
correct cnt is:  901 all is:  1048 ratio is:  0.8597328244274809
epoch 16: perplexity: 22.916264640269628 perplexity_train: 13.588140335689513
____
0.9618320610687023
0.8597328244274809
22.916264640269628
13.588140335689513
0.9545454545454546
0.8181818181818182
0.9130434782608695
0.9
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.7114987373352051
threshold is:  2.8328347206115723
correct cnt  ref is:  1009 all is:  1048 ratio is:  0.9627862595419847
correct cnt is:  906 all is:  1048 ratio is:  0.8645038167938931
epoch 17: perplexity: 22.865241738028597 perplexity_train: 13.507347737610612
____
0.9627862595419847
0.8645038167938931
22.865241738028597
13.507347737610612
0.9545454545454546
0.9318181818181818
0.9130434782608695
0.9111111111111111
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.711738109588623
threshold is:  2.8333020210266113
correct cnt  ref is:  1013 all is:  1048 ratio is:  0.9666030534351145
correct cnt is:  912 all is:  1048 ratio is:  0.8702290076335878
epoch 18: perplexity: 22.842580193248324 perplexity_train: 13.455890575930956
____
0.9666030534351145
0.8702290076335878
22.842580193248324
13.455890575930956
0.9431818181818182
0.8636363636363636
0.9120879120879121
0.9047619047619048
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.7117558717727661
threshold is:  2.830427646636963
correct cnt  ref is:  1013 all is:  1048 ratio is:  0.9666030534351145
correct cnt is:  909 all is:  1048 ratio is:  0.8673664122137404
epoch 19: perplexity: 22.836661054464113 perplexity_train: 13.444589858639736
____
0.9666030534351145
0.8673664122137404
22.836661054464113
13.444589858639736
0.9659090909090909
0.9090909090909091
0.9139784946236559
0.9090909090909091
_____
*************end of training 
threshold_ref is:  0.7117558717727661
threshold is:  2.830427646636963
correct cnt  ref is:  1013 all is:  1048 ratio is:  0.9666030534351145
correct cnt is:  909 all is:  1048 ratio is:  0.8673664122137404
end of training perplexity: 22.836661054464113 perplexity_train: 13.444586653200108
____
0.9666030534351145
0.8673664122137404
22.836661054464113
13.444586653200108
0.9886363636363636
0.9204545454545454
0.9157894736842105
0.9101123595505618
_____
