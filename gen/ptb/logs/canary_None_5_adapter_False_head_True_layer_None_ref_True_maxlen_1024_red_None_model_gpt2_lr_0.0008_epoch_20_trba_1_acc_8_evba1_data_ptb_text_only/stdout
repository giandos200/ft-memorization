Namespace(adapter_reduction=None, add_adapter=False, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0008, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=True, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 38.597376
model_params (million) 38.597376
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.8147557377815247
threshold is:  3.2385919094085693
correct cnt  ref is:  317 all is:  1048 ratio is:  0.30248091603053434
correct cnt is:  342 all is:  1048 ratio is:  0.32633587786259544
epoch 0: perplexity: 33.12536209169805 perplexity_train: 27.70039456126362
____
0.30248091603053434
0.32633587786259544
33.12536209169805
27.70039456126362
0.23863636363636365
0.2840909090909091
0.7241379310344828
0.7575757575757576
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.7752685546875
threshold is:  3.105451822280884
correct cnt  ref is:  516 all is:  1048 ratio is:  0.49236641221374045
correct cnt is:  505 all is:  1048 ratio is:  0.4818702290076336
epoch 1: perplexity: 28.507630960298535 perplexity_train: 22.32953633032306
____
0.49236641221374045
0.4818702290076336
28.507630960298535
22.32953633032306
0.5340909090909091
0.5340909090909091
0.8545454545454545
0.8545454545454545
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.7441424131393433
threshold is:  3.0184154510498047
correct cnt  ref is:  528 all is:  1048 ratio is:  0.5038167938931297
correct cnt is:  622 all is:  1048 ratio is:  0.5935114503816794
epoch 2: perplexity: 26.50373891800669 perplexity_train: 19.521540882859362
____
0.5038167938931297
0.5935114503816794
26.50373891800669
19.521540882859362
0.5
0.5795454545454546
0.8461538461538461
0.864406779661017
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7352701425552368
threshold is:  2.9697093963623047
correct cnt  ref is:  686 all is:  1048 ratio is:  0.6545801526717557
correct cnt is:  694 all is:  1048 ratio is:  0.6622137404580153
epoch 3: perplexity: 25.474636145589116 perplexity_train: 17.747870303435732
____
0.6545801526717557
0.6622137404580153
25.474636145589116
17.747870303435732
0.6136363636363636
0.6704545454545454
0.8709677419354839
0.8805970149253731
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7308283448219299
threshold is:  2.9240987300872803
correct cnt  ref is:  836 all is:  1048 ratio is:  0.7977099236641222
correct cnt is:  761 all is:  1048 ratio is:  0.726145038167939
epoch 4: perplexity: 24.703464870725423 perplexity_train: 16.40852110293346
____
0.7977099236641222
0.726145038167939
24.703464870725423
16.40852110293346
0.7727272727272727
0.75
0.8947368421052632
0.8918918918918919
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.7224511504173279
threshold is:  2.9046170711517334
correct cnt  ref is:  896 all is:  1048 ratio is:  0.8549618320610687
correct cnt is:  823 all is:  1048 ratio is:  0.7853053435114504
epoch 5: perplexity: 24.219373301654546 perplexity_train: 15.376172644616876
____
0.8549618320610687
0.7853053435114504
24.219373301654546
15.376172644616876
0.8409090909090909
0.7954545454545454
0.9024390243902439
0.8974358974358975
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.7235143184661865
threshold is:  2.8876309394836426
correct cnt  ref is:  984 all is:  1048 ratio is:  0.9389312977099237
correct cnt is:  882 all is:  1048 ratio is:  0.8416030534351145
epoch 6: perplexity: 23.79944443094481 perplexity_train: 14.5448958776391
____
0.9389312977099237
0.8416030534351145
23.79944443094481
14.5448958776391
0.8977272727272727
0.8295454545454546
0.9080459770114943
0.9012345679012346
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7185524702072144
threshold is:  2.8688039779663086
correct cnt  ref is:  1006 all is:  1048 ratio is:  0.9599236641221374
correct cnt is:  919 all is:  1048 ratio is:  0.8769083969465649
epoch 7: perplexity: 23.511631596227442 perplexity_train: 13.889793624136745
____
0.9599236641221374
0.8769083969465649
23.511631596227442
13.889793624136745
0.9659090909090909
0.8522727272727273
0.9139784946236559
0.9036144578313253
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.7138542532920837
threshold is:  2.8659048080444336
correct cnt  ref is:  1019 all is:  1048 ratio is:  0.9723282442748091
correct cnt is:  951 all is:  1048 ratio is:  0.9074427480916031
epoch 8: perplexity: 23.36611370259469 perplexity_train: 13.346503931133288
____
0.9723282442748091
0.9074427480916031
23.36611370259469
13.346503931133288
0.9659090909090909
0.9090909090909091
0.9139784946236559
0.9090909090909091
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.7098312377929688
threshold is:  2.8641886711120605
correct cnt  ref is:  1028 all is:  1048 ratio is:  0.9809160305343512
correct cnt is:  979 all is:  1048 ratio is:  0.9341603053435115
epoch 9: perplexity: 23.26024503776553 perplexity_train: 12.900089989350818
____
0.9809160305343512
0.9341603053435115
23.26024503776553
12.900089989350818
0.9886363636363636
0.9431818181818182
0.9157894736842105
0.9120879120879121
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.7123256325721741
threshold is:  2.8478000164031982
correct cnt  ref is:  1037 all is:  1048 ratio is:  0.9895038167938931
correct cnt is:  989 all is:  1048 ratio is:  0.9437022900763359
epoch 10: perplexity: 23.09851023892677 perplexity_train: 12.500513338446817
____
0.9895038167938931
0.9437022900763359
23.09851023892677
12.500513338446817
0.9886363636363636
0.9659090909090909
0.9157894736842105
0.9139784946236559
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.7096266746520996
threshold is:  2.844038486480713
correct cnt  ref is:  1040 all is:  1048 ratio is:  0.9923664122137404
correct cnt is:  1001 all is:  1048 ratio is:  0.9551526717557252
epoch 11: perplexity: 23.044543086121998 perplexity_train: 12.186366318367414
____
0.9923664122137404
0.9551526717557252
23.044543086121998
12.186366318367414
1.0
0.8977272727272727
0.9166666666666666
0.9080459770114943
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.7093334197998047
threshold is:  2.840034246444702
correct cnt  ref is:  1043 all is:  1048 ratio is:  0.9952290076335878
correct cnt is:  1012 all is:  1048 ratio is:  0.9656488549618321
epoch 12: perplexity: 22.96160319948932 perplexity_train: 11.908219547141266
____
0.9952290076335878
0.9656488549618321
22.96160319948932
11.908219547141266
0.9886363636363636
0.9431818181818182
0.9157894736842105
0.9120879120879121
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.7078117728233337
threshold is:  2.8310065269470215
correct cnt  ref is:  1044 all is:  1048 ratio is:  0.9961832061068703
correct cnt is:  1020 all is:  1048 ratio is:  0.9732824427480916
epoch 13: perplexity: 22.915051739126334 perplexity_train: 11.68526869189633
____
0.9961832061068703
0.9732824427480916
22.915051739126334
11.68526869189633
0.9886363636363636
0.9772727272727273
0.9157894736842105
0.9148936170212766
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.7069655656814575
threshold is:  2.833719253540039
correct cnt  ref is:  1046 all is:  1048 ratio is:  0.9980916030534351
correct cnt is:  1027 all is:  1048 ratio is:  0.9799618320610687
epoch 14: perplexity: 22.87271696405206 perplexity_train: 11.492547589372377
____
0.9980916030534351
0.9799618320610687
22.87271696405206
11.492547589372377
1.0
0.9772727272727273
0.9166666666666666
0.9148936170212766
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.7060672044754028
threshold is:  2.8326470851898193
correct cnt  ref is:  1047 all is:  1048 ratio is:  0.9990458015267175
correct cnt is:  1030 all is:  1048 ratio is:  0.982824427480916
epoch 15: perplexity: 22.844628016948697 perplexity_train: 11.349151142974632
____
0.9990458015267175
0.982824427480916
22.844628016948697
11.349151142974632
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.7044677138328552
threshold is:  2.824488639831543
correct cnt  ref is:  1047 all is:  1048 ratio is:  0.9990458015267175
correct cnt is:  1030 all is:  1048 ratio is:  0.982824427480916
epoch 16: perplexity: 22.774936565715965 perplexity_train: 11.215469441114944
____
0.9990458015267175
0.982824427480916
22.774936565715965
11.215469441114944
1.0
0.9772727272727273
0.9166666666666666
0.9148936170212766
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.704695463180542
threshold is:  2.8217203617095947
correct cnt  ref is:  1047 all is:  1048 ratio is:  0.9990458015267175
correct cnt is:  1032 all is:  1048 ratio is:  0.9847328244274809
epoch 17: perplexity: 22.71470027970268 perplexity_train: 11.13175904764456
____
0.9990458015267175
0.9847328244274809
22.71470027970268
11.13175904764456
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.70462965965271
threshold is:  2.8235530853271484
correct cnt  ref is:  1047 all is:  1048 ratio is:  0.9990458015267175
correct cnt is:  1035 all is:  1048 ratio is:  0.9875954198473282
epoch 18: perplexity: 22.691452154666404 perplexity_train: 11.077809276288471
____
0.9990458015267175
0.9875954198473282
22.691452154666404
11.077809276288471
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.70389324426651
threshold is:  2.8194265365600586
correct cnt  ref is:  1047 all is:  1048 ratio is:  0.9990458015267175
correct cnt is:  1034 all is:  1048 ratio is:  0.9866412213740458
epoch 19: perplexity: 22.687194833895756 perplexity_train: 11.065297270260755
____
0.9990458015267175
0.9866412213740458
22.687194833895756
11.065297270260755
1.0
0.9886363636363636
0.9166666666666666
0.9157894736842105
_____
*************end of training 
threshold_ref is:  0.70389324426651
threshold is:  2.8194265365600586
correct cnt  ref is:  1047 all is:  1048 ratio is:  0.9990458015267175
correct cnt is:  1034 all is:  1048 ratio is:  0.9866412213740458
end of training perplexity: 22.687194833895756 perplexity_train: 11.065297270260755
____
0.9990458015267175
0.9866412213740458
22.687194833895756
11.065297270260755
1.0
0.9886363636363636
0.9166666666666666
0.9157894736842105
_____
