Namespace(adapter_reduction=None, add_adapter=False, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=1e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=True, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 38.597376
model_params (million) 38.597376
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.9626032114028931
threshold is:  3.697693109512329
correct cnt  ref is:  154 all is:  1048 ratio is:  0.14694656488549618
correct cnt is:  197 all is:  1048 ratio is:  0.18797709923664122
epoch 0: perplexity: 54.24624913796112 perplexity_train: 48.391927821061984
____
0.14694656488549618
0.18797709923664122
54.24624913796112
48.391927821061984
0.09090909090909091
0.14772727272727273
0.5
0.6190476190476191
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.9446197152137756
threshold is:  3.63466739654541
correct cnt  ref is:  212 all is:  1048 ratio is:  0.20229007633587787
correct cnt is:  196 all is:  1048 ratio is:  0.18702290076335878
epoch 1: perplexity: 50.73447711334975 perplexity_train: 45.21525398139632
____
0.20229007633587787
0.18702290076335878
50.73447711334975
45.21525398139632
0.3181818181818182
0.20454545454545456
0.7777777777777778
0.6923076923076923
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.9333928227424622
threshold is:  3.6017327308654785
correct cnt  ref is:  224 all is:  1048 ratio is:  0.21374045801526717
correct cnt is:  208 all is:  1048 ratio is:  0.1984732824427481
epoch 2: perplexity: 48.71115828947535 perplexity_train: 43.35350197049371
____
0.21374045801526717
0.1984732824427481
48.71115828947535
43.35350197049371
0.17045454545454544
0.20454545454545456
0.6521739130434783
0.6923076923076923
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.92450350522995
threshold is:  3.5789334774017334
correct cnt  ref is:  202 all is:  1048 ratio is:  0.19274809160305342
correct cnt is:  213 all is:  1048 ratio is:  0.2032442748091603
epoch 3: perplexity: 47.35287946953967 perplexity_train: 42.091968831336615
____
0.19274809160305342
0.2032442748091603
47.35287946953967
42.091968831336615
0.18181818181818182
0.20454545454545456
0.6666666666666666
0.6923076923076923
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.919213593006134
threshold is:  3.563920736312866
correct cnt  ref is:  222 all is:  1048 ratio is:  0.21183206106870228
correct cnt is:  219 all is:  1048 ratio is:  0.20896946564885496
epoch 4: perplexity: 46.41050546895512 perplexity_train: 41.200614400138875
____
0.21183206106870228
0.20896946564885496
46.41050546895512
41.200614400138875
0.17045454545454544
0.18181818181818182
0.6521739130434783
0.6666666666666666
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.9151148200035095
threshold is:  3.5486433506011963
correct cnt  ref is:  238 all is:  1048 ratio is:  0.22709923664122136
correct cnt is:  221 all is:  1048 ratio is:  0.21087786259541985
epoch 5: perplexity: 45.71773973577391 perplexity_train: 40.535881228614286
____
0.22709923664122136
0.21087786259541985
45.71773973577391
40.535881228614286
0.26136363636363635
0.2840909090909091
0.7419354838709677
0.7575757575757576
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.9115769863128662
threshold is:  3.5317373275756836
correct cnt  ref is:  245 all is:  1048 ratio is:  0.23377862595419846
correct cnt is:  217 all is:  1048 ratio is:  0.20706106870229007
epoch 6: perplexity: 45.150027225934124 perplexity_train: 39.986738020635876
____
0.23377862595419846
0.20706106870229007
45.150027225934124
39.986738020635876
0.23863636363636365
0.2159090909090909
0.7241379310344828
0.7037037037037037
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.9081763029098511
threshold is:  3.517354726791382
correct cnt  ref is:  236 all is:  1048 ratio is:  0.22519083969465647
correct cnt is:  213 all is:  1048 ratio is:  0.2032442748091603
epoch 7: perplexity: 44.689684298623945 perplexity_train: 39.54156623785286
____
0.22519083969465647
0.2032442748091603
44.689684298623945
39.54156623785286
0.26136363636363635
0.23863636363636365
0.7419354838709677
0.7241379310344828
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.905485987663269
threshold is:  3.5055434703826904
correct cnt  ref is:  232 all is:  1048 ratio is:  0.22137404580152673
correct cnt is:  209 all is:  1048 ratio is:  0.19942748091603055
epoch 8: perplexity: 44.30720177202882 perplexity_train: 39.17050058128178
____
0.22137404580152673
0.19942748091603055
44.30720177202882
39.17050058128178
0.18181818181818182
0.2159090909090909
0.6666666666666666
0.7037037037037037
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.903052031993866
threshold is:  3.4955716133117676
correct cnt  ref is:  229 all is:  1048 ratio is:  0.21851145038167938
correct cnt is:  205 all is:  1048 ratio is:  0.19561068702290077
epoch 9: perplexity: 43.98958720288455 perplexity_train: 38.85982673275591
____
0.21851145038167938
0.19561068702290077
43.98958720288455
38.85982673275591
0.25
0.1590909090909091
0.7333333333333333
0.6363636363636364
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.9008945822715759
threshold is:  3.4870612621307373
correct cnt  ref is:  220 all is:  1048 ratio is:  0.2099236641221374
correct cnt is:  202 all is:  1048 ratio is:  0.19274809160305342
epoch 10: perplexity: 43.722862380392094 perplexity_train: 38.59746341511371
____
0.2099236641221374
0.19274809160305342
43.722862380392094
38.59746341511371
0.1590909090909091
0.2159090909090909
0.6363636363636364
0.7037037037037037
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.8990277647972107
threshold is:  3.479809045791626
correct cnt  ref is:  217 all is:  1048 ratio is:  0.20706106870229007
correct cnt is:  201 all is:  1048 ratio is:  0.191793893129771
epoch 11: perplexity: 43.49076755863296 perplexity_train: 38.368326714024874
____
0.20706106870229007
0.191793893129771
43.49076755863296
38.368326714024874
0.22727272727272727
0.1590909090909091
0.7142857142857143
0.6363636363636364
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.8974934220314026
threshold is:  3.4735870361328125
correct cnt  ref is:  214 all is:  1048 ratio is:  0.20419847328244276
correct cnt is:  199 all is:  1048 ratio is:  0.1898854961832061
epoch 12: perplexity: 43.29437745485838 perplexity_train: 38.176003809026334
____
0.20419847328244276
0.1898854961832061
43.29437745485838
38.176003809026334
0.2840909090909091
0.2159090909090909
0.7575757575757576
0.7037037037037037
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.8962587714195251
threshold is:  3.46907114982605
correct cnt  ref is:  214 all is:  1048 ratio is:  0.20419847328244276
correct cnt is:  199 all is:  1048 ratio is:  0.1898854961832061
epoch 13: perplexity: 43.141868058514824 perplexity_train: 38.02250077407324
____
0.20419847328244276
0.1898854961832061
43.141868058514824
38.02250077407324
0.18181818181818182
0.125
0.6666666666666666
0.5789473684210527
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.8951519727706909
threshold is:  3.46470046043396
correct cnt  ref is:  208 all is:  1048 ratio is:  0.1984732824427481
correct cnt is:  198 all is:  1048 ratio is:  0.18893129770992367
epoch 14: perplexity: 43.00852343329659 perplexity_train: 37.89140777436229
____
0.1984732824427481
0.18893129770992367
43.00852343329659
37.89140777436229
0.14772727272727273
0.20454545454545456
0.6190476190476191
0.6923076923076923
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.8942122459411621
threshold is:  3.4611012935638428
correct cnt  ref is:  200 all is:  1048 ratio is:  0.19083969465648856
correct cnt is:  196 all is:  1048 ratio is:  0.18702290076335878
epoch 15: perplexity: 42.89887353669146 perplexity_train: 37.78400129936217
____
0.19083969465648856
0.18702290076335878
42.89887353669146
37.78400129936217
0.23863636363636365
0.125
0.7241379310344828
0.5789473684210527
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.8935996890068054
threshold is:  3.458550214767456
correct cnt  ref is:  199 all is:  1048 ratio is:  0.1898854961832061
correct cnt is:  196 all is:  1048 ratio is:  0.18702290076335878
epoch 16: perplexity: 42.817700086066 perplexity_train: 37.70474748677581
____
0.1898854961832061
0.18702290076335878
42.817700086066
37.70474748677581
0.13636363636363635
0.20454545454545456
0.6
0.6923076923076923
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.8931503295898438
threshold is:  3.456721067428589
correct cnt  ref is:  199 all is:  1048 ratio is:  0.1898854961832061
correct cnt is:  196 all is:  1048 ratio is:  0.18702290076335878
epoch 17: perplexity: 42.759000447503304 perplexity_train: 37.64741106871529
____
0.1898854961832061
0.18702290076335878
42.759000447503304
37.64741106871529
0.2159090909090909
0.18181818181818182
0.7037037037037037
0.6666666666666666
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.8928875923156738
threshold is:  3.4557437896728516
correct cnt  ref is:  197 all is:  1048 ratio is:  0.18797709923664122
correct cnt is:  196 all is:  1048 ratio is:  0.18702290076335878
epoch 18: perplexity: 42.72785727981001 perplexity_train: 37.61697731957611
____
0.18797709923664122
0.18702290076335878
42.72785727981001
37.61697731957611
0.17045454545454544
0.14772727272727273
0.6521739130434783
0.6190476190476191
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.892831563949585
threshold is:  3.4554686546325684
correct cnt  ref is:  197 all is:  1048 ratio is:  0.18797709923664122
correct cnt is:  197 all is:  1048 ratio is:  0.18797709923664122
epoch 19: perplexity: 42.718995408856856 perplexity_train: 37.608440194326505
____
0.18797709923664122
0.18797709923664122
42.718995408856856
37.608440194326505
0.20454545454545456
0.17045454545454544
0.6923076923076923
0.6521739130434783
_____
*************end of training 
threshold_ref is:  0.892831563949585
threshold is:  3.4554686546325684
correct cnt  ref is:  197 all is:  1048 ratio is:  0.18797709923664122
correct cnt is:  197 all is:  1048 ratio is:  0.18797709923664122
end of training perplexity: 42.718995408856856 perplexity_train: 37.608440194326505
____
0.18797709923664122
0.18797709923664122
42.718995408856856
37.608440194326505
0.20454545454545456
0.22727272727272727
0.6923076923076923
0.7142857142857143
_____
