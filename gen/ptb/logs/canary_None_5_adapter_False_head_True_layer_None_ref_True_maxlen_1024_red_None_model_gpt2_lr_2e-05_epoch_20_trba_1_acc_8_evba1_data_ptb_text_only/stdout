Namespace(adapter_reduction=None, add_adapter=False, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=2e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=True, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 38.597376
model_params (million) 38.597376
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.9433422684669495
threshold is:  3.6315841674804688
correct cnt  ref is:  209 all is:  1048 ratio is:  0.19942748091603055
correct cnt is:  199 all is:  1048 ratio is:  0.1898854961832061
epoch 0: perplexity: 50.547057285896926 perplexity_train: 45.04172545666403
____
0.19942748091603055
0.1898854961832061
50.547057285896926
45.04172545666403
0.17045454545454544
0.13636363636363635
0.6521739130434783
0.6
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.9229860305786133
threshold is:  3.57645583152771
correct cnt  ref is:  199 all is:  1048 ratio is:  0.1898854961832061
correct cnt is:  214 all is:  1048 ratio is:  0.20419847328244276
epoch 1: perplexity: 47.12936245775479 perplexity_train: 41.880262079893264
____
0.1898854961832061
0.20419847328244276
47.12936245775479
41.880262079893264
0.2840909090909091
0.26136363636363635
0.7575757575757576
0.7419354838709677
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.9131069779396057
threshold is:  3.5384232997894287
correct cnt  ref is:  244 all is:  1048 ratio is:  0.23282442748091603
correct cnt is:  218 all is:  1048 ratio is:  0.20801526717557253
epoch 2: perplexity: 45.403900298544336 perplexity_train: 40.22516589011663
____
0.23282442748091603
0.20801526717557253
45.403900298544336
40.22516589011663
0.20454545454545456
0.20454545454545456
0.6923076923076923
0.6923076923076923
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.9046035408973694
threshold is:  3.5035817623138428
correct cnt  ref is:  226 all is:  1048 ratio is:  0.21564885496183206
correct cnt is:  208 all is:  1048 ratio is:  0.1984732824427481
epoch 3: perplexity: 44.24369634755827 perplexity_train: 39.09731411702469
____
0.21564885496183206
0.1984732824427481
44.24369634755827
39.09731411702469
0.20454545454545456
0.19318181818181818
0.6923076923076923
0.68
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.8977667093276978
threshold is:  3.4766223430633545
correct cnt  ref is:  203 all is:  1048 ratio is:  0.19370229007633588
correct cnt is:  200 all is:  1048 ratio is:  0.19083969465648856
epoch 4: perplexity: 43.395746244030455 perplexity_train: 38.26842665629967
____
0.19370229007633588
0.19083969465648856
43.395746244030455
38.26842665629967
0.17045454545454544
0.1590909090909091
0.6521739130434783
0.6363636363636364
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.8923505544662476
threshold is:  3.4554998874664307
correct cnt  ref is:  187 all is:  1048 ratio is:  0.1784351145038168
correct cnt is:  197 all is:  1048 ratio is:  0.18797709923664122
epoch 5: perplexity: 42.73469338079017 perplexity_train: 37.613300378916605
____
0.1784351145038168
0.18797709923664122
42.73469338079017
37.613300378916605
0.20454545454545456
0.25
0.6923076923076923
0.7333333333333333
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.8876045346260071
threshold is:  3.4406356811523438
correct cnt  ref is:  175 all is:  1048 ratio is:  0.16698473282442747
correct cnt is:  196 all is:  1048 ratio is:  0.18702290076335878
epoch 6: perplexity: 42.143090618766685 perplexity_train: 37.033418132614436
____
0.16698473282442747
0.18702290076335878
42.143090618766685
37.033418132614436
0.13636363636363635
0.20454545454545456
0.6
0.6923076923076923
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.8837347626686096
threshold is:  3.4302544593811035
correct cnt  ref is:  171 all is:  1048 ratio is:  0.16316793893129772
correct cnt is:  197 all is:  1048 ratio is:  0.18797709923664122
epoch 7: perplexity: 41.65760074541506 perplexity_train: 36.558829473790595
____
0.16316793893129772
0.18797709923664122
41.65760074541506
36.558829473790595
0.2159090909090909
0.2159090909090909
0.7037037037037037
0.7037037037037037
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.8807829022407532
threshold is:  3.4219553470611572
correct cnt  ref is:  176 all is:  1048 ratio is:  0.16793893129770993
correct cnt is:  198 all is:  1048 ratio is:  0.18893129770992367
epoch 8: perplexity: 41.233465752277496 perplexity_train: 36.14086712086276
____
0.16793893129770993
0.18893129770992367
41.233465752277496
36.14086712086276
0.1590909090909091
0.19318181818181818
0.6363636363636364
0.68
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.8782450556755066
threshold is:  3.414292573928833
correct cnt  ref is:  182 all is:  1048 ratio is:  0.1736641221374046
correct cnt is:  203 all is:  1048 ratio is:  0.19370229007633588
epoch 9: perplexity: 40.86776832984031 perplexity_train: 35.78352912171105
____
0.1736641221374046
0.19370229007633588
40.86776832984031
35.78352912171105
0.19318181818181818
0.18181818181818182
0.68
0.6666666666666666
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.876200258731842
threshold is:  3.4072887897491455
correct cnt  ref is:  192 all is:  1048 ratio is:  0.183206106870229
correct cnt is:  208 all is:  1048 ratio is:  0.1984732824427481
epoch 10: perplexity: 40.55443166126308 perplexity_train: 35.47487743480687
____
0.183206106870229
0.1984732824427481
40.55443166126308
35.47487743480687
0.13636363636363635
0.23863636363636365
0.6
0.7241379310344828
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.8741517066955566
threshold is:  3.4008982181549072
correct cnt  ref is:  196 all is:  1048 ratio is:  0.18702290076335878
correct cnt is:  211 all is:  1048 ratio is:  0.2013358778625954
epoch 11: perplexity: 40.27558556556726 perplexity_train: 35.19940558900665
____
0.18702290076335878
0.2013358778625954
40.27558556556726
35.19940558900665
0.23863636363636365
0.18181818181818182
0.7241379310344828
0.6666666666666666
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.8726108074188232
threshold is:  3.3954379558563232
correct cnt  ref is:  202 all is:  1048 ratio is:  0.19274809160305342
correct cnt is:  211 all is:  1048 ratio is:  0.2013358778625954
epoch 12: perplexity: 40.030511567060735 perplexity_train: 34.96423145820436
____
0.19274809160305342
0.2013358778625954
40.030511567060735
34.96423145820436
0.22727272727272727
0.2159090909090909
0.7142857142857143
0.7037037037037037
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.8713598847389221
threshold is:  3.3912150859832764
correct cnt  ref is:  207 all is:  1048 ratio is:  0.19751908396946566
correct cnt is:  214 all is:  1048 ratio is:  0.20419847328244276
epoch 13: perplexity: 39.85042142037994 perplexity_train: 34.78116763275678
____
0.19751908396946566
0.20419847328244276
39.85042142037994
34.78116763275678
0.20454545454545456
0.14772727272727273
0.6923076923076923
0.6190476190476191
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.8703285455703735
threshold is:  3.3876020908355713
correct cnt  ref is:  215 all is:  1048 ratio is:  0.20515267175572519
correct cnt is:  217 all is:  1048 ratio is:  0.20706106870229007
epoch 14: perplexity: 39.68022251011158 perplexity_train: 34.61738004179415
____
0.20515267175572519
0.20706106870229007
39.68022251011158
34.61738004179415
0.17045454545454544
0.2159090909090909
0.6521739130434783
0.7037037037037037
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.8694729804992676
threshold is:  3.384397506713867
correct cnt  ref is:  217 all is:  1048 ratio is:  0.20706106870229007
correct cnt is:  216 all is:  1048 ratio is:  0.20610687022900764
epoch 15: perplexity: 39.55342774117734 perplexity_train: 34.490444540255524
____
0.20706106870229007
0.20610687022900764
39.55342774117734
34.490444540255524
0.26136363636363635
0.1590909090909091
0.7419354838709677
0.6363636363636364
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.8687387108802795
threshold is:  3.3823599815368652
correct cnt  ref is:  215 all is:  1048 ratio is:  0.20515267175572519
correct cnt is:  219 all is:  1048 ratio is:  0.20896946564885496
epoch 16: perplexity: 39.45494761849984 perplexity_train: 34.394195396265744
____
0.20515267175572519
0.20896946564885496
39.45494761849984
34.394195396265744
0.18181818181818182
0.23863636363636365
0.6666666666666666
0.7241379310344828
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.8683168292045593
threshold is:  3.380958080291748
correct cnt  ref is:  218 all is:  1048 ratio is:  0.20801526717557253
correct cnt is:  220 all is:  1048 ratio is:  0.2099236641221374
epoch 17: perplexity: 39.384638124411666 perplexity_train: 34.32588991785374
____
0.20801526717557253
0.2099236641221374
39.384638124411666
34.32588991785374
0.25
0.22727272727272727
0.7333333333333333
0.7142857142857143
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.868039071559906
threshold is:  3.380171298980713
correct cnt  ref is:  216 all is:  1048 ratio is:  0.20610687022900764
correct cnt is:  221 all is:  1048 ratio is:  0.21087786259541985
epoch 18: perplexity: 39.34657995499366 perplexity_train: 34.288787677858764
____
0.20610687022900764
0.21087786259541985
39.34657995499366
34.288787677858764
0.19318181818181818
0.14772727272727273
0.68
0.6190476190476191
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.867963969707489
threshold is:  3.379897356033325
correct cnt  ref is:  218 all is:  1048 ratio is:  0.20801526717557253
correct cnt is:  221 all is:  1048 ratio is:  0.21087786259541985
epoch 19: perplexity: 39.33557763252864 perplexity_train: 34.278341512007806
____
0.20801526717557253
0.21087786259541985
39.33557763252864
34.278341512007806
0.22727272727272727
0.19318181818181818
0.7142857142857143
0.68
_____
*************end of training 
threshold_ref is:  0.867963969707489
threshold is:  3.379897356033325
correct cnt  ref is:  218 all is:  1048 ratio is:  0.20801526717557253
correct cnt is:  221 all is:  1048 ratio is:  0.21087786259541985
end of training perplexity: 39.33557763252864 perplexity_train: 34.278341512007806
____
0.20801526717557253
0.21087786259541985
39.33557763252864
34.278341512007806
0.22727272727272727
0.22727272727272727
0.7142857142857143
0.7142857142857143
_____
