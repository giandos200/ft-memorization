Namespace(adapter_reduction=None, add_adapter=False, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=5e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=True, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 38.597376
model_params (million) 38.597376
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.9167651534080505
threshold is:  3.5568530559539795
correct cnt  ref is:  244 all is:  1048 ratio is:  0.23282442748091603
correct cnt is:  222 all is:  1048 ratio is:  0.21183206106870228
epoch 0: perplexity: 46.033177772158545 perplexity_train: 40.815984513094484
____
0.23282442748091603
0.21183206106870228
46.033177772158545
40.815984513094484
0.2159090909090909
0.14772727272727273
0.7037037037037037
0.6190476190476191
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.8960550427436829
threshold is:  3.4667577743530273
correct cnt  ref is:  209 all is:  1048 ratio is:  0.19942748091603055
correct cnt is:  194 all is:  1048 ratio is:  0.1851145038167939
epoch 1: perplexity: 43.16817692623051 perplexity_train: 38.039619857636076
____
0.19942748091603055
0.1851145038167939
43.16817692623051
38.039619857636076
0.2727272727272727
0.2159090909090909
0.75
0.7037037037037037
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.881498396396637
threshold is:  3.4251439571380615
correct cnt  ref is:  171 all is:  1048 ratio is:  0.16316793893129772
correct cnt is:  201 all is:  1048 ratio is:  0.191793893129771
epoch 2: perplexity: 41.3850203174249 perplexity_train: 36.276626972555405
____
0.16316793893129772
0.191793893129771
41.3850203174249
36.276626972555405
0.18181818181818182
0.19318181818181818
0.6666666666666666
0.68
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.8724894523620605
threshold is:  3.3950235843658447
correct cnt  ref is:  204 all is:  1048 ratio is:  0.1946564885496183
correct cnt is:  213 all is:  1048 ratio is:  0.2032442748091603
epoch 3: perplexity: 40.05468431536609 perplexity_train: 34.95911345367975
____
0.1946564885496183
0.2032442748091603
40.05468431536609
34.95911345367975
0.19318181818181818
0.19318181818181818
0.68
0.68
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.8653851747512817
threshold is:  3.369896411895752
correct cnt  ref is:  235 all is:  1048 ratio is:  0.22423664122137404
correct cnt is:  224 all is:  1048 ratio is:  0.21374045801526717
epoch 4: perplexity: 38.94109067910472 perplexity_train: 33.887477127001596
____
0.22423664122137404
0.21374045801526717
38.94109067910472
33.887477127001596
0.18181818181818182
0.18181818181818182
0.6666666666666666
0.6666666666666666
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.8590148091316223
threshold is:  3.3507790565490723
correct cnt  ref is:  245 all is:  1048 ratio is:  0.23377862595419846
correct cnt is:  234 all is:  1048 ratio is:  0.22328244274809161
epoch 5: perplexity: 38.05877915263636 perplexity_train: 33.014868392657235
____
0.23377862595419846
0.22328244274809161
38.05877915263636
33.014868392657235
0.22727272727272727
0.2727272727272727
0.7142857142857143
0.75
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.853316068649292
threshold is:  3.3347830772399902
correct cnt  ref is:  258 all is:  1048 ratio is:  0.24618320610687022
correct cnt is:  247 all is:  1048 ratio is:  0.23568702290076335
epoch 6: perplexity: 37.26966772582963 perplexity_train: 32.24652765929229
____
0.24618320610687022
0.23568702290076335
37.26966772582963
32.24652765929229
0.22727272727272727
0.26136363636363635
0.7142857142857143
0.7419354838709677
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.8485317230224609
threshold is:  3.3177921772003174
correct cnt  ref is:  271 all is:  1048 ratio is:  0.258587786259542
correct cnt is:  251 all is:  1048 ratio is:  0.23950381679389313
epoch 7: perplexity: 36.62957835300959 perplexity_train: 31.61103382449881
____
0.258587786259542
0.23950381679389313
36.62957835300959
31.61103382449881
0.26136363636363635
0.26136363636363635
0.7419354838709677
0.7419354838709677
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.8443730473518372
threshold is:  3.3042688369750977
correct cnt  ref is:  279 all is:  1048 ratio is:  0.26622137404580154
correct cnt is:  260 all is:  1048 ratio is:  0.2480916030534351
epoch 8: perplexity: 36.09787837053325 perplexity_train: 31.066647473456925
____
0.26622137404580154
0.2480916030534351
36.09787837053325
31.066647473456925
0.25
0.25
0.7333333333333333
0.7333333333333333
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.8405734300613403
threshold is:  3.2946629524230957
correct cnt  ref is:  279 all is:  1048 ratio is:  0.26622137404580154
correct cnt is:  267 all is:  1048 ratio is:  0.2547709923664122
epoch 9: perplexity: 35.617738636093016 perplexity_train: 30.592143480977416
____
0.26622137404580154
0.2547709923664122
35.617738636093016
30.592143480977416
0.2840909090909091
0.2727272727272727
0.7575757575757576
0.75
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.837205708026886
threshold is:  3.2824926376342773
correct cnt  ref is:  285 all is:  1048 ratio is:  0.2719465648854962
correct cnt is:  268 all is:  1048 ratio is:  0.25572519083969464
epoch 10: perplexity: 35.21390188926254 perplexity_train: 30.184451376715725
____
0.2719465648854962
0.25572519083969464
35.21390188926254
30.184451376715725
0.26136363636363635
0.3181818181818182
0.7419354838709677
0.7777777777777778
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.8346397876739502
threshold is:  3.2742156982421875
correct cnt  ref is:  295 all is:  1048 ratio is:  0.2814885496183206
correct cnt is:  276 all is:  1048 ratio is:  0.2633587786259542
epoch 11: perplexity: 34.86202189583418 perplexity_train: 29.827493381652904
____
0.2814885496183206
0.2633587786259542
34.86202189583418
29.827493381652904
0.29545454545454547
0.25
0.7647058823529411
0.7333333333333333
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.8320287466049194
threshold is:  3.2648799419403076
correct cnt  ref is:  297 all is:  1048 ratio is:  0.2833969465648855
correct cnt is:  278 all is:  1048 ratio is:  0.2652671755725191
epoch 12: perplexity: 34.551868634369825 perplexity_train: 29.51978708684255
____
0.2833969465648855
0.2652671755725191
34.551868634369825
29.51978708684255
0.32954545454545453
0.32954545454545453
0.7837837837837838
0.7837837837837838
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.8300426006317139
threshold is:  3.2584123611450195
correct cnt  ref is:  299 all is:  1048 ratio is:  0.28530534351145037
correct cnt is:  279 all is:  1048 ratio is:  0.26622137404580154
epoch 13: perplexity: 34.31438524080013 perplexity_train: 29.27170197219064
____
0.28530534351145037
0.26622137404580154
34.31438524080013
29.27170197219064
0.3068181818181818
0.22727272727272727
0.7714285714285715
0.7142857142857143
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.8284403681755066
threshold is:  3.2540173530578613
correct cnt  ref is:  311 all is:  1048 ratio is:  0.2967557251908397
correct cnt is:  282 all is:  1048 ratio is:  0.26908396946564883
epoch 14: perplexity: 34.11893909209395 perplexity_train: 29.067301595191473
____
0.2967557251908397
0.26908396946564883
34.11893909209395
29.067301595191473
0.23863636363636365
0.22727272727272727
0.7241379310344828
0.7142857142857143
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.8271453976631165
threshold is:  3.24987530708313
correct cnt  ref is:  311 all is:  1048 ratio is:  0.2967557251908397
correct cnt is:  284 all is:  1048 ratio is:  0.27099236641221375
epoch 15: perplexity: 33.97372121493818 perplexity_train: 28.909756530853162
____
0.2967557251908397
0.27099236641221375
33.97372121493818
28.909756530853162
0.38636363636363635
0.25
0.8095238095238095
0.7333333333333333
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.8259977102279663
threshold is:  3.246565103530884
correct cnt  ref is:  313 all is:  1048 ratio is:  0.29866412213740456
correct cnt is:  287 all is:  1048 ratio is:  0.2738549618320611
epoch 16: perplexity: 33.85169619063468 perplexity_train: 28.785406111171664
____
0.29866412213740456
0.2738549618320611
33.85169619063468
28.785406111171664
0.23863636363636365
0.3522727272727273
0.7241379310344828
0.7948717948717948
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.8252097368240356
threshold is:  3.245152235031128
correct cnt  ref is:  311 all is:  1048 ratio is:  0.2967557251908397
correct cnt is:  288 all is:  1048 ratio is:  0.2748091603053435
epoch 17: perplexity: 33.77419167483418 perplexity_train: 28.705289624848362
____
0.2967557251908397
0.2748091603053435
33.77419167483418
28.705289624848362
0.3409090909090909
0.26136363636363635
0.7894736842105263
0.7419354838709677
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.82490074634552
threshold is:  3.243797779083252
correct cnt  ref is:  315 all is:  1048 ratio is:  0.3005725190839695
correct cnt is:  289 all is:  1048 ratio is:  0.27576335877862596
epoch 18: perplexity: 33.72942589611407 perplexity_train: 28.657914400361665
____
0.3005725190839695
0.27576335877862596
33.72942589611407
28.657914400361665
0.22727272727272727
0.20454545454545456
0.7142857142857143
0.6923076923076923
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.8247982263565063
threshold is:  3.243227005004883
correct cnt  ref is:  316 all is:  1048 ratio is:  0.3015267175572519
correct cnt is:  289 all is:  1048 ratio is:  0.27576335877862596
epoch 19: perplexity: 33.716400822356235 perplexity_train: 28.644819338741712
____
0.3015267175572519
0.27576335877862596
33.716400822356235
28.644819338741712
0.38636363636363635
0.25
0.8095238095238095
0.7333333333333333
_____
*************end of training 
threshold_ref is:  0.8247982263565063
threshold is:  3.243227005004883
correct cnt  ref is:  316 all is:  1048 ratio is:  0.3015267175572519
correct cnt is:  289 all is:  1048 ratio is:  0.27576335877862596
end of training perplexity: 33.716400822356235 perplexity_train: 28.644826168199653
____
0.3015267175572519
0.27576335877862596
33.716400822356235
28.644826168199653
0.3409090909090909
0.3181818181818182
0.7894736842105263
0.7777777777777778
_____
