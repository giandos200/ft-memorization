Namespace(adapter_reduction=16, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0001, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 0.894528
model_params (million) 0.894528
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.8667358756065369
threshold is:  3.357837438583374
correct cnt  ref is:  141 all is:  1048 ratio is:  0.13454198473282442
correct cnt is:  191 all is:  1048 ratio is:  0.18225190839694658
epoch 0: perplexity: 38.43214850537756 perplexity_train: 34.491159962837145
____
0.13454198473282442
0.18225190839694658
38.43214850537756
34.491159962837145
0.17045454545454544
0.13636363636363635
0.6521739130434783
0.6
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.8300127387046814
threshold is:  3.229940891265869
correct cnt  ref is:  162 all is:  1048 ratio is:  0.15458015267175573
correct cnt is:  209 all is:  1048 ratio is:  0.19942748091603055
epoch 1: perplexity: 33.53416128561608 perplexity_train: 30.049416312725942
____
0.15458015267175573
0.19942748091603055
33.53416128561608
30.049416312725942
0.13636363636363635
0.20454545454545456
0.6
0.6923076923076923
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.8101620674133301
threshold is:  3.1523876190185547
correct cnt  ref is:  161 all is:  1048 ratio is:  0.15362595419847327
correct cnt is:  194 all is:  1048 ratio is:  0.1851145038167939
epoch 2: perplexity: 31.297513884193897 perplexity_train: 28.000789709812082
____
0.15362595419847327
0.1851145038167939
31.297513884193897
28.000789709812082
0.14772727272727273
0.11363636363636363
0.6190476190476191
0.5555555555555556
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7974013686180115
threshold is:  3.1119959354400635
correct cnt  ref is:  175 all is:  1048 ratio is:  0.16698473282442747
correct cnt is:  199 all is:  1048 ratio is:  0.1898854961832061
epoch 3: perplexity: 29.948875769840683 perplexity_train: 26.760954740136135
____
0.16698473282442747
0.1898854961832061
29.948875769840683
26.760954740136135
0.17045454545454544
0.17045454545454544
0.6521739130434783
0.6521739130434783
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7884423136711121
threshold is:  3.0858709812164307
correct cnt  ref is:  174 all is:  1048 ratio is:  0.16603053435114504
correct cnt is:  205 all is:  1048 ratio is:  0.19561068702290077
epoch 4: perplexity: 29.11327811270202 perplexity_train: 25.942684287412465
____
0.16603053435114504
0.19561068702290077
29.11327811270202
25.942684287412465
0.10227272727272728
0.125
0.5294117647058824
0.5789473684210527
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.7815803289413452
threshold is:  3.0493152141571045
correct cnt  ref is:  179 all is:  1048 ratio is:  0.17080152671755724
correct cnt is:  188 all is:  1048 ratio is:  0.17938931297709923
epoch 5: perplexity: 28.419742025475806 perplexity_train: 25.27527610206814
____
0.17080152671755724
0.17938931297709923
28.419742025475806
25.27527610206814
0.14772727272727273
0.17045454545454544
0.6190476190476191
0.6521739130434783
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.7754237055778503
threshold is:  3.0370728969573975
correct cnt  ref is:  185 all is:  1048 ratio is:  0.1765267175572519
correct cnt is:  198 all is:  1048 ratio is:  0.18893129770992367
epoch 6: perplexity: 27.925040682519096 perplexity_train: 24.784948395326772
____
0.1765267175572519
0.18893129770992367
27.925040682519096
24.784948395326772
0.14772727272727273
0.19318181818181818
0.6190476190476191
0.68
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7716774940490723
threshold is:  3.022400379180908
correct cnt  ref is:  192 all is:  1048 ratio is:  0.183206106870229
correct cnt is:  206 all is:  1048 ratio is:  0.1965648854961832
epoch 7: perplexity: 27.523944199685094 perplexity_train: 24.381084394722382
____
0.183206106870229
0.1965648854961832
27.523944199685094
24.381084394722382
0.18181818181818182
0.26136363636363635
0.6666666666666666
0.7419354838709677
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.7679550051689148
threshold is:  3.0059256553649902
correct cnt  ref is:  205 all is:  1048 ratio is:  0.19561068702290077
correct cnt is:  203 all is:  1048 ratio is:  0.19370229007633588
epoch 8: perplexity: 27.163953354442835 perplexity_train: 24.02000749851958
____
0.19561068702290077
0.19370229007633588
27.163953354442835
24.02000749851958
0.17045454545454544
0.19318181818181818
0.6521739130434783
0.68
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.7660004496574402
threshold is:  2.996717691421509
correct cnt  ref is:  214 all is:  1048 ratio is:  0.20419847328244276
correct cnt is:  206 all is:  1048 ratio is:  0.1965648854961832
epoch 9: perplexity: 26.95729816418004 perplexity_train: 23.778685808581365
____
0.20419847328244276
0.1965648854961832
26.95729816418004
23.778685808581365
0.17045454545454544
0.14772727272727273
0.6521739130434783
0.6190476190476191
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.7626240849494934
threshold is:  2.9911599159240723
correct cnt  ref is:  211 all is:  1048 ratio is:  0.2013358778625954
correct cnt is:  216 all is:  1048 ratio is:  0.20610687022900764
epoch 10: perplexity: 26.67336913650532 perplexity_train: 23.505326130871822
____
0.2013358778625954
0.20610687022900764
26.67336913650532
23.505326130871822
0.18181818181818182
0.20454545454545456
0.6666666666666666
0.6923076923076923
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.7608446478843689
threshold is:  2.9799716472625732
correct cnt  ref is:  219 all is:  1048 ratio is:  0.20896946564885496
correct cnt is:  212 all is:  1048 ratio is:  0.20229007633587787
epoch 11: perplexity: 26.494407422085626 perplexity_train: 23.300130412805785
____
0.20896946564885496
0.20229007633587787
26.494407422085626
23.300130412805785
0.25
0.25
0.7333333333333333
0.7333333333333333
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.7605732083320618
threshold is:  2.980034589767456
correct cnt  ref is:  238 all is:  1048 ratio is:  0.22709923664122136
correct cnt is:  218 all is:  1048 ratio is:  0.20801526717557253
epoch 12: perplexity: 26.370271625784547 perplexity_train: 23.152267057170462
____
0.22709923664122136
0.20801526717557253
26.370271625784547
23.152267057170462
0.23863636363636365
0.23863636363636365
0.7241379310344828
0.7241379310344828
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.7598169445991516
threshold is:  2.979078769683838
correct cnt  ref is:  248 all is:  1048 ratio is:  0.2366412213740458
correct cnt is:  223 all is:  1048 ratio is:  0.21278625954198474
epoch 13: perplexity: 26.24148653006653 perplexity_train: 23.010591696105806
____
0.2366412213740458
0.21278625954198474
26.24148653006653
23.010591696105806
0.3068181818181818
0.3068181818181818
0.7714285714285715
0.7714285714285715
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.75798499584198
threshold is:  2.97263765335083
correct cnt  ref is:  243 all is:  1048 ratio is:  0.2318702290076336
correct cnt is:  220 all is:  1048 ratio is:  0.2099236641221374
epoch 14: perplexity: 26.14549451513016 perplexity_train: 22.896374615406657
____
0.2318702290076336
0.2099236641221374
26.14549451513016
22.896374615406657
0.22727272727272727
0.2159090909090909
0.7142857142857143
0.7037037037037037
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.7578244805335999
threshold is:  2.969419479370117
correct cnt  ref is:  255 all is:  1048 ratio is:  0.2433206106870229
correct cnt is:  225 all is:  1048 ratio is:  0.21469465648854963
epoch 15: perplexity: 26.061016784632677 perplexity_train: 22.81036205011741
____
0.2433206106870229
0.21469465648854963
26.061016784632677
22.81036205011741
0.32954545454545453
0.23863636363636365
0.7837837837837838
0.7241379310344828
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.756878674030304
threshold is:  2.967589855194092
correct cnt  ref is:  250 all is:  1048 ratio is:  0.2385496183206107
correct cnt is:  225 all is:  1048 ratio is:  0.21469465648854963
epoch 16: perplexity: 26.016250229807028 perplexity_train: 22.750748052288106
____
0.2385496183206107
0.21469465648854963
26.016250229807028
22.750748052288106
0.2159090909090909
0.20454545454545456
0.7037037037037037
0.6923076923076923
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.7569969892501831
threshold is:  2.967299222946167
correct cnt  ref is:  254 all is:  1048 ratio is:  0.24236641221374045
correct cnt is:  227 all is:  1048 ratio is:  0.21660305343511452
epoch 17: perplexity: 25.968873339665205 perplexity_train: 22.701923043215498
____
0.24236641221374045
0.21660305343511452
25.968873339665205
22.701923043215498
0.2727272727272727
0.26136363636363635
0.75
0.7419354838709677
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.7566762566566467
threshold is:  2.965944766998291
correct cnt  ref is:  254 all is:  1048 ratio is:  0.24236641221374045
correct cnt is:  227 all is:  1048 ratio is:  0.21660305343511452
epoch 18: perplexity: 25.93550424317873 perplexity_train: 22.66408833428479
____
0.24236641221374045
0.21660305343511452
25.93550424317873
22.66408833428479
0.29545454545454547
0.2727272727272727
0.7647058823529411
0.75
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.7564942836761475
threshold is:  2.9655961990356445
correct cnt  ref is:  256 all is:  1048 ratio is:  0.24427480916030533
correct cnt is:  225 all is:  1048 ratio is:  0.21469465648854963
epoch 19: perplexity: 25.932666169186536 perplexity_train: 22.657939940193668
____
0.24427480916030533
0.21469465648854963
25.932666169186536
22.657939940193668
0.3068181818181818
0.3522727272727273
0.7714285714285715
0.7948717948717948
_____
*************end of training 
threshold_ref is:  0.7564942836761475
threshold is:  2.9655961990356445
correct cnt  ref is:  256 all is:  1048 ratio is:  0.24427480916030533
correct cnt is:  225 all is:  1048 ratio is:  0.21469465648854963
end of training perplexity: 25.932666169186536 perplexity_train: 22.657939940193668
____
0.24427480916030533
0.21469465648854963
25.932666169186536
22.657939940193668
0.20454545454545456
0.18181818181818182
0.6923076923076923
0.6666666666666666
_____
