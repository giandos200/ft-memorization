Namespace(adapter_reduction=16, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0002, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 0.894528
model_params (million) 0.894528
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.8320572972297668
threshold is:  3.242079019546509
correct cnt  ref is:  153 all is:  1048 ratio is:  0.14599236641221375
correct cnt is:  210 all is:  1048 ratio is:  0.20038167938931298
epoch 0: perplexity: 33.90394695364723 perplexity_train: 30.3963234208734
____
0.14599236641221375
0.20038167938931298
33.90394695364723
30.3963234208734
0.125
0.18181818181818182
0.5789473684210527
0.6666666666666666
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.7958688139915466
threshold is:  3.1121044158935547
correct cnt  ref is:  141 all is:  1048 ratio is:  0.13454198473282442
correct cnt is:  196 all is:  1048 ratio is:  0.18702290076335878
epoch 1: perplexity: 30.032728038254454 perplexity_train: 26.833897957346124
____
0.13454198473282442
0.18702290076335878
30.032728038254454
26.833897957346124
0.125
0.18181818181818182
0.5789473684210527
0.6666666666666666
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.781123161315918
threshold is:  3.0449020862579346
correct cnt  ref is:  185 all is:  1048 ratio is:  0.1765267175572519
correct cnt is:  188 all is:  1048 ratio is:  0.17938931297709923
epoch 2: perplexity: 28.324073349522717 perplexity_train: 25.171239356025666
____
0.1765267175572519
0.17938931297709923
28.324073349522717
25.171239356025666
0.1590909090909091
0.125
0.6363636363636364
0.5789473684210527
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7692260146141052
threshold is:  3.0122034549713135
correct cnt  ref is:  196 all is:  1048 ratio is:  0.18702290076335878
correct cnt is:  206 all is:  1048 ratio is:  0.1965648854961832
epoch 3: perplexity: 27.33624486477486 perplexity_train: 24.173729719600622
____
0.18702290076335878
0.1965648854961832
27.33624486477486
24.173729719600622
0.18181818181818182
0.17045454545454544
0.6666666666666666
0.6521739130434783
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7619667053222656
threshold is:  2.989619493484497
correct cnt  ref is:  225 all is:  1048 ratio is:  0.21469465648854963
correct cnt is:  222 all is:  1048 ratio is:  0.21183206106870228
epoch 4: perplexity: 26.54893919422942 perplexity_train: 23.353487849277943
____
0.21469465648854963
0.21183206106870228
26.54893919422942
23.353487849277943
0.18181818181818182
0.13636363636363635
0.6666666666666666
0.6
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.7565243244171143
threshold is:  2.963050365447998
correct cnt  ref is:  247 all is:  1048 ratio is:  0.23568702290076335
correct cnt is:  219 all is:  1048 ratio is:  0.20896946564885496
epoch 5: perplexity: 26.012851340787524 perplexity_train: 22.765468670018986
____
0.23568702290076335
0.20896946564885496
26.012851340787524
22.765468670018986
0.22727272727272727
0.18181818181818182
0.7142857142857143
0.6666666666666666
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.7539315819740295
threshold is:  2.9557595252990723
correct cnt  ref is:  276 all is:  1048 ratio is:  0.2633587786259542
correct cnt is:  231 all is:  1048 ratio is:  0.22041984732824427
epoch 6: perplexity: 25.676113473914285 perplexity_train: 22.34514044457269
____
0.2633587786259542
0.22041984732824427
25.676113473914285
22.34514044457269
0.17045454545454544
0.25
0.6521739130434783
0.7333333333333333
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7491297125816345
threshold is:  2.9430460929870605
correct cnt  ref is:  272 all is:  1048 ratio is:  0.2595419847328244
correct cnt is:  239 all is:  1048 ratio is:  0.22805343511450382
epoch 7: perplexity: 25.331646705049888 perplexity_train: 21.94403293536395
____
0.2595419847328244
0.22805343511450382
25.331646705049888
21.94403293536395
0.23863636363636365
0.26136363636363635
0.7241379310344828
0.7419354838709677
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.7436777949333191
threshold is:  2.9306466579437256
correct cnt  ref is:  267 all is:  1048 ratio is:  0.2547709923664122
correct cnt is:  249 all is:  1048 ratio is:  0.23759541984732824
epoch 8: perplexity: 25.042583524980802 perplexity_train: 21.587505668157906
____
0.2547709923664122
0.23759541984732824
25.042583524980802
21.587505668157906
0.23863636363636365
0.2840909090909091
0.7241379310344828
0.7575757575757576
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.7417061924934387
threshold is:  2.925474166870117
correct cnt  ref is:  289 all is:  1048 ratio is:  0.27576335877862596
correct cnt is:  257 all is:  1048 ratio is:  0.2452290076335878
epoch 9: perplexity: 24.91214402115028 perplexity_train: 21.338613348313423
____
0.27576335877862596
0.2452290076335878
24.91214402115028
21.338613348313423
0.20454545454545456
0.18181818181818182
0.6923076923076923
0.6666666666666666
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.7393283843994141
threshold is:  2.919761896133423
correct cnt  ref is:  299 all is:  1048 ratio is:  0.28530534351145037
correct cnt is:  272 all is:  1048 ratio is:  0.2595419847328244
epoch 10: perplexity: 24.645348351221813 perplexity_train: 21.06563805231161
____
0.28530534351145037
0.2595419847328244
24.645348351221813
21.06563805231161
0.22727272727272727
0.2727272727272727
0.7142857142857143
0.75
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.736646294593811
threshold is:  2.9117841720581055
correct cnt  ref is:  303 all is:  1048 ratio is:  0.28912213740458015
correct cnt is:  277 all is:  1048 ratio is:  0.2643129770992366
epoch 11: perplexity: 24.495961387449817 perplexity_train: 20.85276996816104
____
0.28912213740458015
0.2643129770992366
24.495961387449817
20.85276996816104
0.36363636363636365
0.29545454545454547
0.8
0.7647058823529411
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.7358078360557556
threshold is:  2.910205125808716
correct cnt  ref is:  311 all is:  1048 ratio is:  0.2967557251908397
correct cnt is:  288 all is:  1048 ratio is:  0.2748091603053435
epoch 12: perplexity: 24.382049355798348 perplexity_train: 20.684987931610532
____
0.2967557251908397
0.2748091603053435
24.382049355798348
20.684987931610532
0.32954545454545453
0.2840909090909091
0.7837837837837838
0.7575757575757576
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.734444260597229
threshold is:  2.9112179279327393
correct cnt  ref is:  318 all is:  1048 ratio is:  0.30343511450381677
correct cnt is:  306 all is:  1048 ratio is:  0.2919847328244275
epoch 13: perplexity: 24.27509046427738 perplexity_train: 20.546699294174882
____
0.30343511450381677
0.2919847328244275
24.27509046427738
20.546699294174882
0.38636363636363635
0.3977272727272727
0.8095238095238095
0.813953488372093
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.7330296039581299
threshold is:  2.905015230178833
correct cnt  ref is:  317 all is:  1048 ratio is:  0.30248091603053434
correct cnt is:  299 all is:  1048 ratio is:  0.28530534351145037
epoch 14: perplexity: 24.20671346514052 perplexity_train: 20.43003088161552
____
0.30248091603053434
0.28530534351145037
24.20671346514052
20.43003088161552
0.3068181818181818
0.25
0.7714285714285715
0.7333333333333333
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.7324886918067932
threshold is:  2.9024014472961426
correct cnt  ref is:  325 all is:  1048 ratio is:  0.3101145038167939
correct cnt is:  308 all is:  1048 ratio is:  0.29389312977099236
epoch 15: perplexity: 24.146219070576805 perplexity_train: 20.344443869207122
____
0.3101145038167939
0.29389312977099236
24.146219070576805
20.344443869207122
0.3522727272727273
0.3068181818181818
0.7948717948717948
0.7714285714285715
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.7320300340652466
threshold is:  2.8988265991210938
correct cnt  ref is:  332 all is:  1048 ratio is:  0.31679389312977096
correct cnt is:  305 all is:  1048 ratio is:  0.29103053435114506
epoch 16: perplexity: 24.09954693272194 perplexity_train: 20.260316713765196
____
0.31679389312977096
0.29103053435114506
24.09954693272194
20.260316713765196
0.29545454545454547
0.25
0.7647058823529411
0.7333333333333333
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.731356680393219
threshold is:  2.8975939750671387
correct cnt  ref is:  334 all is:  1048 ratio is:  0.3187022900763359
correct cnt is:  312 all is:  1048 ratio is:  0.29770992366412213
epoch 17: perplexity: 24.049140284007347 perplexity_train: 20.202179043516317
____
0.3187022900763359
0.29770992366412213
24.049140284007347
20.202179043516317
0.3522727272727273
0.3409090909090909
0.7948717948717948
0.7894736842105263
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.7310687899589539
threshold is:  2.897233486175537
correct cnt  ref is:  336 all is:  1048 ratio is:  0.32061068702290074
correct cnt is:  312 all is:  1048 ratio is:  0.29770992366412213
epoch 18: perplexity: 24.01510011852464 perplexity_train: 20.160741256996058
____
0.32061068702290074
0.29770992366412213
24.01510011852464
20.160741256996058
0.3409090909090909
0.32954545454545453
0.7894736842105263
0.7837837837837838
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.7314152717590332
threshold is:  2.8970181941986084
correct cnt  ref is:  340 all is:  1048 ratio is:  0.3244274809160305
correct cnt is:  314 all is:  1048 ratio is:  0.29961832061068705
epoch 19: perplexity: 24.013668749671368 perplexity_train: 20.153753533307206
____
0.3244274809160305
0.29961832061068705
24.013668749671368
20.153753533307206
0.3522727272727273
0.3977272727272727
0.7948717948717948
0.813953488372093
_____
*************end of training 
threshold_ref is:  0.7314152717590332
threshold is:  2.8970181941986084
correct cnt  ref is:  340 all is:  1048 ratio is:  0.3244274809160305
correct cnt is:  314 all is:  1048 ratio is:  0.29961832061068705
end of training perplexity: 24.013668749671368 perplexity_train: 20.153753533307206
____
0.3244274809160305
0.29961832061068705
24.013668749671368
20.153753533307206
0.3068181818181818
0.23863636363636365
0.7714285714285715
0.7241379310344828
_____
