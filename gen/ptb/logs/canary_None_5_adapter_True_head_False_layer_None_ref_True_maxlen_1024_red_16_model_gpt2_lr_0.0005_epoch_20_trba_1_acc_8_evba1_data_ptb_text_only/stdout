Namespace(adapter_reduction=16, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0005, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 0.894528
model_params (million) 0.894528
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.7978518009185791
threshold is:  3.1107354164123535
correct cnt  ref is:  188 all is:  1048 ratio is:  0.17938931297709923
correct cnt is:  204 all is:  1048 ratio is:  0.1946564885496183
epoch 0: perplexity: 29.79727090897907 perplexity_train: 26.665173094874202
____
0.17938931297709923
0.1946564885496183
29.79727090897907
26.665173094874202
0.18181818181818182
0.1590909090909091
0.6666666666666666
0.6363636363636364
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.7650413513183594
threshold is:  2.996408700942993
correct cnt  ref is:  206 all is:  1048 ratio is:  0.1965648854961832
correct cnt is:  203 all is:  1048 ratio is:  0.19370229007633588
epoch 1: perplexity: 26.920784733777467 perplexity_train: 23.77657126098595
____
0.1965648854961832
0.19370229007633588
26.920784733777467
23.77657126098595
0.1590909090909091
0.2159090909090909
0.6363636363636364
0.7037037037037037
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.7519028782844543
threshold is:  2.9508588314056396
correct cnt  ref is:  265 all is:  1048 ratio is:  0.25286259541984735
correct cnt is:  230 all is:  1048 ratio is:  0.21946564885496184
epoch 2: perplexity: 25.568884463335063 perplexity_train: 22.230256313132728
____
0.25286259541984735
0.21946564885496184
25.568884463335063
22.230256313132728
0.22727272727272727
0.19318181818181818
0.7142857142857143
0.68
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7402575016021729
threshold is:  2.9403350353240967
correct cnt  ref is:  280 all is:  1048 ratio is:  0.26717557251908397
correct cnt is:  286 all is:  1048 ratio is:  0.2729007633587786
epoch 3: perplexity: 24.829999607049928 perplexity_train: 21.279015012999615
____
0.26717557251908397
0.2729007633587786
24.829999607049928
21.279015012999615
0.2840909090909091
0.20454545454545456
0.7575757575757576
0.6923076923076923
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7339155077934265
threshold is:  2.9215567111968994
correct cnt  ref is:  311 all is:  1048 ratio is:  0.2967557251908397
correct cnt is:  320 all is:  1048 ratio is:  0.3053435114503817
epoch 4: perplexity: 24.270576530601268 perplexity_train: 20.509331627271372
____
0.2967557251908397
0.3053435114503817
24.270576530601268
20.509331627271372
0.2840909090909091
0.2727272727272727
0.7575757575757576
0.75
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.7297191023826599
threshold is:  2.893353223800659
correct cnt  ref is:  362 all is:  1048 ratio is:  0.34541984732824427
correct cnt is:  334 all is:  1048 ratio is:  0.3187022900763359
epoch 5: perplexity: 23.817273861664106 perplexity_train: 19.831835004469966
____
0.34541984732824427
0.3187022900763359
23.817273861664106
19.831835004469966
0.32954545454545453
0.2840909090909091
0.7837837837837838
0.7575757575757576
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.7226548194885254
threshold is:  2.8784523010253906
correct cnt  ref is:  363 all is:  1048 ratio is:  0.3463740458015267
correct cnt is:  346 all is:  1048 ratio is:  0.3301526717557252
epoch 6: perplexity: 23.506693572621923 perplexity_train: 19.312549345992302
____
0.3463740458015267
0.3301526717557252
23.506693572621923
19.312549345992302
0.25
0.3068181818181818
0.7333333333333333
0.7714285714285715
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7250750064849854
threshold is:  2.8783047199249268
correct cnt  ref is:  429 all is:  1048 ratio is:  0.40935114503816794
correct cnt is:  374 all is:  1048 ratio is:  0.3568702290076336
epoch 7: perplexity: 23.355225100372948 perplexity_train: 18.940799015647457
____
0.40935114503816794
0.3568702290076336
23.355225100372948
18.940799015647457
0.38636363636363635
0.38636363636363635
0.8095238095238095
0.8095238095238095
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.7176034450531006
threshold is:  2.8469278812408447
correct cnt  ref is:  411 all is:  1048 ratio is:  0.39217557251908397
correct cnt is:  359 all is:  1048 ratio is:  0.3425572519083969
epoch 8: perplexity: 23.05588050610317 perplexity_train: 18.54330477192911
____
0.39217557251908397
0.3425572519083969
23.05588050610317
18.54330477192911
0.38636363636363635
0.3181818181818182
0.8095238095238095
0.7777777777777778
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.7131979465484619
threshold is:  2.8452205657958984
correct cnt  ref is:  407 all is:  1048 ratio is:  0.3883587786259542
correct cnt is:  391 all is:  1048 ratio is:  0.37309160305343514
epoch 9: perplexity: 22.93915242037437 perplexity_train: 18.191882275698458
____
0.3883587786259542
0.37309160305343514
22.93915242037437
18.191882275698458
0.25
0.2727272727272727
0.7333333333333333
0.75
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.7106665968894958
threshold is:  2.8396060466766357
correct cnt  ref is:  412 all is:  1048 ratio is:  0.3931297709923664
correct cnt is:  398 all is:  1048 ratio is:  0.3797709923664122
epoch 10: perplexity: 22.79488413877447 perplexity_train: 17.94644498002362
____
0.3931297709923664
0.3797709923664122
22.79488413877447
17.94644498002362
0.3181818181818182
0.375
0.7777777777777778
0.8048780487804879
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.7059246301651001
threshold is:  2.8313374519348145
correct cnt  ref is:  403 all is:  1048 ratio is:  0.3845419847328244
correct cnt is:  408 all is:  1048 ratio is:  0.3893129770992366
epoch 11: perplexity: 22.68555054266312 perplexity_train: 17.673818773506802
____
0.3845419847328244
0.3893129770992366
22.68555054266312
17.673818773506802
0.4659090909090909
0.375
0.8367346938775511
0.8048780487804879
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.7050203084945679
threshold is:  2.8220102787017822
correct cnt  ref is:  423 all is:  1048 ratio is:  0.4036259541984733
correct cnt is:  414 all is:  1048 ratio is:  0.3950381679389313
epoch 12: perplexity: 22.585306878609277 perplexity_train: 17.44767147028086
____
0.4036259541984733
0.3950381679389313
22.585306878609277
17.44767147028086
0.4090909090909091
0.4090909090909091
0.8181818181818182
0.8181818181818182
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.7038069367408752
threshold is:  2.8213419914245605
correct cnt  ref is:  425 all is:  1048 ratio is:  0.40553435114503816
correct cnt is:  429 all is:  1048 ratio is:  0.40935114503816794
epoch 13: perplexity: 22.521034506639616 perplexity_train: 17.287054782970063
____
0.40553435114503816
0.40935114503816794
22.521034506639616
17.287054782970063
0.5340909090909091
0.4659090909090909
0.8545454545454545
0.8367346938775511
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.7001392841339111
threshold is:  2.822768211364746
correct cnt  ref is:  414 all is:  1048 ratio is:  0.3950381679389313
correct cnt is:  449 all is:  1048 ratio is:  0.42843511450381677
epoch 14: perplexity: 22.46085391022877 perplexity_train: 17.152223236437653
____
0.3950381679389313
0.42843511450381677
22.46085391022877
17.152223236437653
0.4090909090909091
0.3977272727272727
0.8181818181818182
0.813953488372093
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.6986216902732849
threshold is:  2.8232533931732178
correct cnt  ref is:  411 all is:  1048 ratio is:  0.39217557251908397
correct cnt is:  459 all is:  1048 ratio is:  0.43797709923664124
epoch 15: perplexity: 22.397298814031693 perplexity_train: 17.066963115340734
____
0.39217557251908397
0.43797709923664124
22.397298814031693
17.066963115340734
0.4090909090909091
0.4659090909090909
0.8181818181818182
0.8367346938775511
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.6966255307197571
threshold is:  2.8250343799591064
correct cnt  ref is:  411 all is:  1048 ratio is:  0.39217557251908397
correct cnt is:  472 all is:  1048 ratio is:  0.45038167938931295
epoch 16: perplexity: 22.373468703233037 perplexity_train: 16.931607610882935
____
0.39217557251908397
0.45038167938931295
22.373468703233037
16.931607610882935
0.375
0.5
0.8048780487804879
0.8461538461538461
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.6963385343551636
threshold is:  2.8194191455841064
correct cnt  ref is:  420 all is:  1048 ratio is:  0.40076335877862596
correct cnt is:  473 all is:  1048 ratio is:  0.45133587786259544
epoch 17: perplexity: 22.323329669882977 perplexity_train: 16.841564637406368
____
0.40076335877862596
0.45133587786259544
22.323329669882977
16.841564637406368
0.4318181818181818
0.4659090909090909
0.8260869565217391
0.8367346938775511
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.6957515478134155
threshold is:  2.81912899017334
correct cnt  ref is:  420 all is:  1048 ratio is:  0.40076335877862596
correct cnt is:  476 all is:  1048 ratio is:  0.4541984732824427
epoch 18: perplexity: 22.298137499017592 perplexity_train: 16.790742998452476
____
0.40076335877862596
0.4541984732824427
22.298137499017592
16.790742998452476
0.38636363636363635
0.5227272727272727
0.8095238095238095
0.8518518518518519
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.6956201195716858
threshold is:  2.8204123973846436
correct cnt  ref is:  421 all is:  1048 ratio is:  0.4017175572519084
correct cnt is:  481 all is:  1048 ratio is:  0.45896946564885494
epoch 19: perplexity: 22.31450704611615 perplexity_train: 16.784731230856053
____
0.4017175572519084
0.45896946564885494
22.31450704611615
16.784731230856053
0.4090909090909091
0.5340909090909091
0.8181818181818182
0.8545454545454545
_____
*************end of training 
threshold_ref is:  0.6956201195716858
threshold is:  2.8204123973846436
correct cnt  ref is:  421 all is:  1048 ratio is:  0.4017175572519084
correct cnt is:  481 all is:  1048 ratio is:  0.45896946564885494
end of training perplexity: 22.31450704611615 perplexity_train: 16.784731230856053
____
0.4017175572519084
0.45896946564885494
22.31450704611615
16.784731230856053
0.3977272727272727
0.45454545454545453
0.813953488372093
0.8333333333333334
_____
