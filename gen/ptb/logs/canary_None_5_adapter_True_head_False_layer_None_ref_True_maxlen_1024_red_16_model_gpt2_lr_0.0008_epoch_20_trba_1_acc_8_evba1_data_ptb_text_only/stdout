Namespace(adapter_reduction=16, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0008, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 0.894528
model_params (million) 0.894528
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.7834150791168213
threshold is:  3.0561115741729736
correct cnt  ref is:  195 all is:  1048 ratio is:  0.18606870229007633
correct cnt is:  191 all is:  1048 ratio is:  0.18225190839694658
epoch 0: perplexity: 28.432510489795256 perplexity_train: 25.39705461652208
____
0.18606870229007633
0.18225190839694658
28.432510489795256
25.39705461652208
0.19318181818181818
0.14772727272727273
0.68
0.6190476190476191
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.7539727687835693
threshold is:  2.972538948059082
correct cnt  ref is:  244 all is:  1048 ratio is:  0.23282442748091603
correct cnt is:  246 all is:  1048 ratio is:  0.23473282442748092
epoch 1: perplexity: 25.785679475008507 perplexity_train: 22.568469638580954
____
0.23282442748091603
0.23473282442748092
25.785679475008507
22.568469638580954
0.19318181818181818
0.26136363636363635
0.68
0.7419354838709677
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.7364116907119751
threshold is:  2.9338912963867188
correct cnt  ref is:  273 all is:  1048 ratio is:  0.26049618320610685
correct cnt is:  297 all is:  1048 ratio is:  0.2833969465648855
epoch 2: perplexity: 24.649050451878747 perplexity_train: 21.049130742313885
____
0.26049618320610685
0.2833969465648855
24.649050451878747
21.049130742313885
0.20454545454545456
0.23863636363636365
0.6923076923076923
0.7241379310344828
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7280399799346924
threshold is:  2.8990821838378906
correct cnt  ref is:  327 all is:  1048 ratio is:  0.31202290076335876
correct cnt is:  321 all is:  1048 ratio is:  0.3062977099236641
epoch 3: perplexity: 23.97925000585429 perplexity_train: 20.055878075749607
____
0.31202290076335876
0.3062977099236641
23.97925000585429
20.055878075749607
0.3068181818181818
0.2727272727272727
0.7714285714285715
0.75
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7238856554031372
threshold is:  2.8760793209075928
correct cnt  ref is:  377 all is:  1048 ratio is:  0.3597328244274809
correct cnt is:  351 all is:  1048 ratio is:  0.3349236641221374
epoch 4: perplexity: 23.51386273478222 perplexity_train: 19.262366071905518
____
0.3597328244274809
0.3349236641221374
23.51386273478222
19.262366071905518
0.38636363636363635
0.29545454545454547
0.8095238095238095
0.7647058823529411
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.7129230499267578
threshold is:  2.8577489852905273
correct cnt  ref is:  364 all is:  1048 ratio is:  0.3473282442748092
correct cnt is:  383 all is:  1048 ratio is:  0.3654580152671756
epoch 5: perplexity: 23.039664711024365 perplexity_train: 18.51357925380671
____
0.3473282442748092
0.3654580152671756
23.039664711024365
18.51357925380671
0.36363636363636365
0.3181818181818182
0.8
0.7777777777777778
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.7082260847091675
threshold is:  2.8380539417266846
correct cnt  ref is:  387 all is:  1048 ratio is:  0.36927480916030536
correct cnt is:  386 all is:  1048 ratio is:  0.3683206106870229
epoch 6: perplexity: 22.88748375957511 perplexity_train: 18.00479073814738
____
0.36927480916030536
0.3683206106870229
22.88748375957511
18.00479073814738
0.3181818181818182
0.3181818181818182
0.7777777777777778
0.7777777777777778
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7063700556755066
threshold is:  2.8412466049194336
correct cnt  ref is:  418 all is:  1048 ratio is:  0.3988549618320611
correct cnt is:  443 all is:  1048 ratio is:  0.42270992366412213
epoch 7: perplexity: 22.716584988973207 perplexity_train: 17.563088001263083
____
0.3988549618320611
0.42270992366412213
22.716584988973207
17.563088001263083
0.3977272727272727
0.4659090909090909
0.813953488372093
0.8367346938775511
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.6970025897026062
threshold is:  2.8190934658050537
correct cnt  ref is:  387 all is:  1048 ratio is:  0.36927480916030536
correct cnt is:  440 all is:  1048 ratio is:  0.4198473282442748
epoch 8: perplexity: 22.36122461538262 perplexity_train: 17.124450035300804
____
0.36927480916030536
0.4198473282442748
22.36122461538262
17.124450035300804
0.375
0.3977272727272727
0.8048780487804879
0.813953488372093
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.6941471099853516
threshold is:  2.820223331451416
correct cnt  ref is:  411 all is:  1048 ratio is:  0.39217557251908397
correct cnt is:  478 all is:  1048 ratio is:  0.45610687022900764
epoch 9: perplexity: 22.37321266066847 perplexity_train: 16.765349746546562
____
0.39217557251908397
0.45610687022900764
22.37321266066847
16.765349746546562
0.23863636363636365
0.36363636363636365
0.7241379310344828
0.8
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.6992436647415161
threshold is:  2.8192715644836426
correct cnt  ref is:  476 all is:  1048 ratio is:  0.4541984732824427
correct cnt is:  510 all is:  1048 ratio is:  0.4866412213740458
epoch 10: perplexity: 22.230357015377155 perplexity_train: 16.507056344027667
____
0.4541984732824427
0.4866412213740458
22.230357015377155
16.507056344027667
0.36363636363636365
0.5113636363636364
0.8
0.8490566037735849
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.6962647438049316
threshold is:  2.8104968070983887
correct cnt  ref is:  488 all is:  1048 ratio is:  0.46564885496183206
correct cnt is:  525 all is:  1048 ratio is:  0.5009541984732825
epoch 11: perplexity: 22.30260363003995 perplexity_train: 16.226131546755806
____
0.46564885496183206
0.5009541984732825
22.30260363003995
16.226131546755806
0.5681818181818182
0.5340909090909091
0.8620689655172413
0.8545454545454545
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.694961428642273
threshold is:  2.8041598796844482
correct cnt  ref is:  501 all is:  1048 ratio is:  0.4780534351145038
correct cnt is:  534 all is:  1048 ratio is:  0.5095419847328244
epoch 12: perplexity: 22.157155800632047 perplexity_train: 16.024677335818783
____
0.4780534351145038
0.5095419847328244
22.157155800632047
16.024677335818783
0.45454545454545453
0.5454545454545454
0.8333333333333334
0.8571428571428571
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.6958597302436829
threshold is:  2.799344301223755
correct cnt  ref is:  527 all is:  1048 ratio is:  0.5028625954198473
correct cnt is:  554 all is:  1048 ratio is:  0.5286259541984732
epoch 13: perplexity: 22.099754749494156 perplexity_train: 15.84499034841827
____
0.5028625954198473
0.5286259541984732
22.099754749494156
15.84499034841827
0.6022727272727273
0.5909090909090909
0.8688524590163934
0.8666666666666667
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.6941254138946533
threshold is:  2.8072574138641357
correct cnt  ref is:  533 all is:  1048 ratio is:  0.5085877862595419
correct cnt is:  578 all is:  1048 ratio is:  0.5515267175572519
epoch 14: perplexity: 22.120186802256324 perplexity_train: 15.696181903408089
____
0.5085877862595419
0.5515267175572519
22.120186802256324
15.696181903408089
0.5454545454545454
0.5340909090909091
0.8571428571428571
0.8545454545454545
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.6937827467918396
threshold is:  2.804370880126953
correct cnt  ref is:  538 all is:  1048 ratio is:  0.5133587786259542
correct cnt is:  583 all is:  1048 ratio is:  0.5562977099236641
epoch 15: perplexity: 22.02706236309698 perplexity_train: 15.629941836554229
____
0.5133587786259542
0.5562977099236641
22.02706236309698
15.629941836554229
0.48863636363636365
0.5227272727272727
0.8431372549019608
0.8518518518518519
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.6920098066329956
threshold is:  2.807446241378784
correct cnt  ref is:  538 all is:  1048 ratio is:  0.5133587786259542
correct cnt is:  604 all is:  1048 ratio is:  0.5763358778625954
epoch 16: perplexity: 22.042749405855947 perplexity_train: 15.470253015684511
____
0.5133587786259542
0.5763358778625954
22.042749405855947
15.470253015684511
0.5340909090909091
0.6590909090909091
0.8545454545454545
0.8787878787878788
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.6919924020767212
threshold is:  2.8029465675354004
correct cnt  ref is:  554 all is:  1048 ratio is:  0.5286259541984732
correct cnt is:  612 all is:  1048 ratio is:  0.583969465648855
epoch 17: perplexity: 22.012667014827816 perplexity_train: 15.367102057139315
____
0.5286259541984732
0.583969465648855
22.012667014827816
15.367102057139315
0.5454545454545454
0.6022727272727273
0.8571428571428571
0.8688524590163934
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.6920534372329712
threshold is:  2.8027563095092773
correct cnt  ref is:  559 all is:  1048 ratio is:  0.5333969465648855
correct cnt is:  620 all is:  1048 ratio is:  0.5916030534351145
epoch 18: perplexity: 21.99246011783121 perplexity_train: 15.30515145882147
____
0.5333969465648855
0.5916030534351145
21.99246011783121
15.30515145882147
0.5
0.625
0.8461538461538461
0.873015873015873
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.6923350691795349
threshold is:  2.804191827774048
correct cnt  ref is:  560 all is:  1048 ratio is:  0.5343511450381679
correct cnt is:  624 all is:  1048 ratio is:  0.5954198473282443
epoch 19: perplexity: 22.027046608119885 perplexity_train: 15.297654533818319
____
0.5343511450381679
0.5954198473282443
22.027046608119885
15.297654533818319
0.5
0.5909090909090909
0.8461538461538461
0.8666666666666667
_____
*************end of training 
threshold_ref is:  0.6923350691795349
threshold is:  2.804191827774048
correct cnt  ref is:  560 all is:  1048 ratio is:  0.5343511450381679
correct cnt is:  624 all is:  1048 ratio is:  0.5954198473282443
end of training perplexity: 22.027046608119885 perplexity_train: 15.297654533818319
____
0.5343511450381679
0.5954198473282443
22.027046608119885
15.297654533818319
0.5113636363636364
0.6931818181818182
0.8490566037735849
0.8840579710144928
_____
