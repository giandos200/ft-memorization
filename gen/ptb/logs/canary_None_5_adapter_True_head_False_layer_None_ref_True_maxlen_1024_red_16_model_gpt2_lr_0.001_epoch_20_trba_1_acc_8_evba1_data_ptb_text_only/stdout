Namespace(adapter_reduction=16, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.001, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 0.894528
model_params (million) 0.894528
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.7775516510009766
threshold is:  3.040555953979492
correct cnt  ref is:  187 all is:  1048 ratio is:  0.1784351145038168
correct cnt is:  192 all is:  1048 ratio is:  0.183206106870229
epoch 0: perplexity: 28.014264934556373 perplexity_train: 24.98956094985673
____
0.1784351145038168
0.183206106870229
28.014264934556373
24.98956094985673
0.18181818181818182
0.14772727272727273
0.6666666666666666
0.6190476190476191
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.7502562403678894
threshold is:  2.9671597480773926
correct cnt  ref is:  264 all is:  1048 ratio is:  0.25190839694656486
correct cnt is:  265 all is:  1048 ratio is:  0.25286259541984735
epoch 1: perplexity: 25.422468592486894 perplexity_train: 22.129275535754925
____
0.25190839694656486
0.25286259541984735
25.422468592486894
22.129275535754925
0.2159090909090909
0.29545454545454547
0.7037037037037037
0.7647058823529411
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.7311208844184875
threshold is:  2.9227442741394043
correct cnt  ref is:  292 all is:  1048 ratio is:  0.2786259541984733
correct cnt is:  322 all is:  1048 ratio is:  0.30725190839694655
epoch 2: perplexity: 24.263957612812305 perplexity_train: 20.5399401796755
____
0.2786259541984733
0.30725190839694655
24.263957612812305
20.5399401796755
0.2159090909090909
0.25
0.7037037037037037
0.7333333333333333
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7248579263687134
threshold is:  2.889180898666382
correct cnt  ref is:  353 all is:  1048 ratio is:  0.3368320610687023
correct cnt is:  349 all is:  1048 ratio is:  0.3330152671755725
epoch 3: perplexity: 23.655782715927945 perplexity_train: 19.568130060114175
____
0.3368320610687023
0.3330152671755725
23.655782715927945
19.568130060114175
0.3181818181818182
0.3068181818181818
0.7777777777777778
0.7714285714285715
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7159910202026367
threshold is:  2.863079309463501
correct cnt  ref is:  366 all is:  1048 ratio is:  0.34923664122137404
correct cnt is:  368 all is:  1048 ratio is:  0.3511450381679389
epoch 4: perplexity: 23.206077056864782 perplexity_train: 18.74143819604632
____
0.34923664122137404
0.3511450381679389
23.206077056864782
18.74143819604632
0.36363636363636365
0.3068181818181818
0.8
0.7714285714285715
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.7047474980354309
threshold is:  2.845808744430542
correct cnt  ref is:  353 all is:  1048 ratio is:  0.3368320610687023
correct cnt is:  405 all is:  1048 ratio is:  0.38645038167938933
epoch 5: perplexity: 22.744126066744492 perplexity_train: 17.99865325688539
____
0.3368320610687023
0.38645038167938933
22.744126066744492
17.99865325688539
0.3409090909090909
0.3522727272727273
0.7894736842105263
0.7948717948717948
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.7021306753158569
threshold is:  2.8292484283447266
correct cnt  ref is:  391 all is:  1048 ratio is:  0.37309160305343514
correct cnt is:  427 all is:  1048 ratio is:  0.4074427480916031
epoch 6: perplexity: 22.554876597579444 perplexity_train: 17.438164646337192
____
0.37309160305343514
0.4074427480916031
22.554876597579444
17.438164646337192
0.3181818181818182
0.3522727272727273
0.7777777777777778
0.7948717948717948
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7024118304252625
threshold is:  2.8342201709747314
correct cnt  ref is:  440 all is:  1048 ratio is:  0.4198473282442748
correct cnt is:  477 all is:  1048 ratio is:  0.4551526717557252
epoch 7: perplexity: 22.596245967912086 perplexity_train: 17.099644673148887
____
0.4198473282442748
0.4551526717557252
22.596245967912086
17.099644673148887
0.4090909090909091
0.5
0.8181818181818182
0.8461538461538461
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.6950475573539734
threshold is:  2.811586618423462
correct cnt  ref is:  436 all is:  1048 ratio is:  0.41603053435114506
correct cnt is:  477 all is:  1048 ratio is:  0.4551526717557252
epoch 8: perplexity: 22.150020052476926 perplexity_train: 16.580361552172267
____
0.41603053435114506
0.4551526717557252
22.150020052476926
16.580361552172267
0.3977272727272727
0.4090909090909091
0.813953488372093
0.8181818181818182
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.6942446231842041
threshold is:  2.8154611587524414
correct cnt  ref is:  468 all is:  1048 ratio is:  0.44656488549618323
correct cnt is:  535 all is:  1048 ratio is:  0.5104961832061069
epoch 9: perplexity: 22.27115240259287 perplexity_train: 16.230790023263705
____
0.44656488549618323
0.5104961832061069
22.27115240259287
16.230790023263705
0.29545454545454547
0.4318181818181818
0.7647058823529411
0.8260869565217391
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.6963064670562744
threshold is:  2.798794746398926
correct cnt  ref is:  510 all is:  1048 ratio is:  0.4866412213740458
correct cnt is:  522 all is:  1048 ratio is:  0.49809160305343514
epoch 10: perplexity: 22.068700073483615 perplexity_train: 15.99076359212293
____
0.4866412213740458
0.49809160305343514
22.068700073483615
15.99076359212293
0.3977272727272727
0.5340909090909091
0.813953488372093
0.8545454545454545
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.6961540579795837
threshold is:  2.809542655944824
correct cnt  ref is:  545 all is:  1048 ratio is:  0.5200381679389313
correct cnt is:  592 all is:  1048 ratio is:  0.5648854961832062
epoch 11: perplexity: 22.143694346294332 perplexity_train: 15.686432599260963
____
0.5200381679389313
0.5648854961832062
22.143694346294332
15.686432599260963
0.6136363636363636
0.6363636363636364
0.8709677419354839
0.875
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.6917887330055237
threshold is:  2.7997934818267822
correct cnt  ref is:  535 all is:  1048 ratio is:  0.5104961832061069
correct cnt is:  598 all is:  1048 ratio is:  0.5706106870229007
epoch 12: perplexity: 22.055713035250385 perplexity_train: 15.481071172740483
____
0.5104961832061069
0.5706106870229007
22.055713035250385
15.481071172740483
0.48863636363636365
0.6022727272727273
0.8431372549019608
0.8688524590163934
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.6944301128387451
threshold is:  2.8024744987487793
correct cnt  ref is:  569 all is:  1048 ratio is:  0.5429389312977099
correct cnt is:  624 all is:  1048 ratio is:  0.5954198473282443
epoch 13: perplexity: 22.06460167694813 perplexity_train: 15.302447764601219
____
0.5429389312977099
0.5954198473282443
22.06460167694813
15.302447764601219
0.6477272727272727
0.6590909090909091
0.8769230769230769
0.8787878787878788
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.6928538680076599
threshold is:  2.7830936908721924
correct cnt  ref is:  572 all is:  1048 ratio is:  0.5458015267175572
correct cnt is:  606 all is:  1048 ratio is:  0.5782442748091603
epoch 14: perplexity: 22.064480683227323 perplexity_train: 15.150254639568251
____
0.5458015267175572
0.5782442748091603
22.064480683227323
15.150254639568251
0.5454545454545454
0.5681818181818182
0.8571428571428571
0.8620689655172413
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.6903504133224487
threshold is:  2.7864301204681396
correct cnt  ref is:  568 all is:  1048 ratio is:  0.5419847328244275
correct cnt is:  617 all is:  1048 ratio is:  0.5887404580152672
epoch 15: perplexity: 21.986666911725194 perplexity_train: 15.064131384362256
____
0.5419847328244275
0.5887404580152672
21.986666911725194
15.064131384362256
0.48863636363636365
0.5568181818181818
0.8431372549019608
0.8596491228070176
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.688769519329071
threshold is:  2.780925750732422
correct cnt  ref is:  573 all is:  1048 ratio is:  0.5467557251908397
correct cnt is:  626 all is:  1048 ratio is:  0.5973282442748091
epoch 16: perplexity: 21.99240244038483 perplexity_train: 14.91035845164132
____
0.5467557251908397
0.5973282442748091
21.99240244038483
14.91035845164132
0.5568181818181818
0.6590909090909091
0.8596491228070176
0.8787878787878788
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.6900840997695923
threshold is:  2.7877793312072754
correct cnt  ref is:  590 all is:  1048 ratio is:  0.5629770992366412
correct cnt is:  652 all is:  1048 ratio is:  0.6221374045801527
epoch 17: perplexity: 22.003573713043277 perplexity_train: 14.800869602566554
____
0.5629770992366412
0.6221374045801527
22.003573713043277
14.800869602566554
0.6136363636363636
0.6590909090909091
0.8709677419354839
0.8787878787878788
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.6897804141044617
threshold is:  2.7798774242401123
correct cnt  ref is:  592 all is:  1048 ratio is:  0.5648854961832062
correct cnt is:  648 all is:  1048 ratio is:  0.6183206106870229
epoch 18: perplexity: 21.96566165414186 perplexity_train: 14.73167325109083
____
0.5648854961832062
0.6183206106870229
21.96566165414186
14.73167325109083
0.5568181818181818
0.6590909090909091
0.8596491228070176
0.8787878787878788
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.6900331974029541
threshold is:  2.7830088138580322
correct cnt  ref is:  593 all is:  1048 ratio is:  0.5658396946564885
correct cnt is:  653 all is:  1048 ratio is:  0.6230916030534351
epoch 19: perplexity: 22.003080588855784 perplexity_train: 14.724151815362632
____
0.5658396946564885
0.6230916030534351
22.003080588855784
14.724151815362632
0.5340909090909091
0.6022727272727273
0.8545454545454545
0.8688524590163934
_____
*************end of training 
threshold_ref is:  0.6900331974029541
threshold is:  2.7830088138580322
correct cnt  ref is:  593 all is:  1048 ratio is:  0.5658396946564885
correct cnt is:  653 all is:  1048 ratio is:  0.6230916030534351
end of training perplexity: 22.003080588855784 perplexity_train: 14.724151815362632
____
0.5658396946564885
0.6230916030534351
22.003080588855784
14.724151815362632
0.5454545454545454
0.7159090909090909
0.8571428571428571
0.8873239436619719
_____
