Namespace(adapter_reduction=16, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=1e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 0.894528
model_params (million) 0.894528
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.9779564142227173
threshold is:  3.7583508491516113
correct cnt  ref is:  152 all is:  1048 ratio is:  0.1450381679389313
correct cnt is:  198 all is:  1048 ratio is:  0.18893129770992367
epoch 0: perplexity: 57.866346825173714 perplexity_train: 51.769426608109924
____
0.1450381679389313
0.18893129770992367
57.866346825173714
51.769426608109924
0.11363636363636363
0.13636363636363635
0.5555555555555556
0.6
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.9520676136016846
threshold is:  3.666285276412964
correct cnt  ref is:  150 all is:  1048 ratio is:  0.1431297709923664
correct cnt is:  199 all is:  1048 ratio is:  0.1898854961832061
epoch 1: perplexity: 52.34125586241566 perplexity_train: 46.960623112037204
____
0.1431297709923664
0.1898854961832061
52.34125586241566
46.960623112037204
0.09090909090909091
0.2159090909090909
0.5
0.7037037037037037
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.9337514638900757
threshold is:  3.6037590503692627
correct cnt  ref is:  143 all is:  1048 ratio is:  0.1364503816793893
correct cnt is:  199 all is:  1048 ratio is:  0.1898854961832061
epoch 2: perplexity: 48.94192045845375 perplexity_train: 43.9726524485985
____
0.1364503816793893
0.1898854961832061
48.94192045845375
43.9726524485985
0.125
0.14772727272727273
0.5789473684210527
0.6190476190476191
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.9184531569480896
threshold is:  3.5489158630371094
correct cnt  ref is:  116 all is:  1048 ratio is:  0.11068702290076336
correct cnt is:  196 all is:  1048 ratio is:  0.18702290076335878
epoch 3: perplexity: 46.42572251239441 perplexity_train: 41.7334604127357
____
0.11068702290076336
0.18702290076335878
46.42572251239441
41.7334604127357
0.09090909090909091
0.14772727272727273
0.5
0.6190476190476191
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.9088847041130066
threshold is:  3.5088231563568115
correct cnt  ref is:  154 all is:  1048 ratio is:  0.14694656488549618
correct cnt is:  192 all is:  1048 ratio is:  0.183206106870229
epoch 4: perplexity: 44.592351833336295 perplexity_train: 40.091888429785655
____
0.14694656488549618
0.183206106870229
44.592351833336295
40.091888429785655
0.11363636363636363
0.11363636363636363
0.5555555555555556
0.5555555555555556
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.900818943977356
threshold is:  3.4731264114379883
correct cnt  ref is:  194 all is:  1048 ratio is:  0.1851145038167939
correct cnt is:  189 all is:  1048 ratio is:  0.1803435114503817
epoch 5: perplexity: 43.058243184730266 perplexity_train: 38.69801944641249
____
0.1851145038167939
0.1803435114503817
43.058243184730266
38.69801944641249
0.13636363636363635
0.18181818181818182
0.6
0.6666666666666666
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.8930228352546692
threshold is:  3.4441847801208496
correct cnt  ref is:  189 all is:  1048 ratio is:  0.1803435114503817
correct cnt is:  188 all is:  1048 ratio is:  0.17938931297709923
epoch 6: perplexity: 41.90222492339485 perplexity_train: 37.65185437281894
____
0.1803435114503817
0.17938931297709923
41.90222492339485
37.65185437281894
0.1590909090909091
0.20454545454545456
0.6363636363636364
0.6923076923076923
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.8859155178070068
threshold is:  3.4216525554656982
correct cnt  ref is:  170 all is:  1048 ratio is:  0.16221374045801526
correct cnt is:  190 all is:  1048 ratio is:  0.18129770992366412
epoch 7: perplexity: 40.937367852915386 perplexity_train: 36.77595856220219
____
0.16221374045801526
0.18129770992366412
40.937367852915386
36.77595856220219
0.26136363636363635
0.2727272727272727
0.7419354838709677
0.75
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.8806794285774231
threshold is:  3.4031288623809814
correct cnt  ref is:  158 all is:  1048 ratio is:  0.15076335877862596
correct cnt is:  188 all is:  1048 ratio is:  0.17938931297709923
epoch 8: perplexity: 40.223420470290684 perplexity_train: 36.12366375822627
____
0.15076335877862596
0.17938931297709923
40.223420470290684
36.12366375822627
0.125
0.18181818181818182
0.5789473684210527
0.6666666666666666
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.8760100603103638
threshold is:  3.3864030838012695
correct cnt  ref is:  152 all is:  1048 ratio is:  0.1450381679389313
correct cnt is:  190 all is:  1048 ratio is:  0.18129770992366412
epoch 9: perplexity: 39.60419515727351 perplexity_train: 35.56390654965297
____
0.1450381679389313
0.18129770992366412
39.60419515727351
35.56390654965297
0.125
0.125
0.5789473684210527
0.5789473684210527
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.8719839453697205
threshold is:  3.373077392578125
correct cnt  ref is:  145 all is:  1048 ratio is:  0.1383587786259542
correct cnt is:  191 all is:  1048 ratio is:  0.18225190839694658
epoch 10: perplexity: 39.104827988973824 perplexity_train: 35.10687761315821
____
0.1383587786259542
0.18225190839694658
39.104827988973824
35.10687761315821
0.13636363636363635
0.23863636363636365
0.6
0.7241379310344828
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.8688828349113464
threshold is:  3.362766742706299
correct cnt  ref is:  146 all is:  1048 ratio is:  0.13931297709923665
correct cnt is:  190 all is:  1048 ratio is:  0.18129770992366412
epoch 11: perplexity: 38.68998415010465 perplexity_train: 34.72149646158984
____
0.13931297709923665
0.18129770992366412
38.68998415010465
34.72149646158984
0.19318181818181818
0.20454545454545456
0.68
0.6923076923076923
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.8665834069252014
threshold is:  3.3543903827667236
correct cnt  ref is:  149 all is:  1048 ratio is:  0.14217557251908397
correct cnt is:  192 all is:  1048 ratio is:  0.183206106870229
epoch 12: perplexity: 38.343946636440286 perplexity_train: 34.40566941078313
____
0.14217557251908397
0.183206106870229
38.343946636440286
34.40566941078313
0.14772727272727273
0.19318181818181818
0.6190476190476191
0.68
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.8641830086708069
threshold is:  3.3466551303863525
correct cnt  ref is:  145 all is:  1048 ratio is:  0.1383587786259542
correct cnt is:  190 all is:  1048 ratio is:  0.18129770992366412
epoch 13: perplexity: 38.04930715898747 perplexity_train: 34.13937929989428
____
0.1383587786259542
0.18129770992366412
38.04930715898747
34.13937929989428
0.19318181818181818
0.2727272727272727
0.68
0.75
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.8625115752220154
threshold is:  3.3413732051849365
correct cnt  ref is:  143 all is:  1048 ratio is:  0.1364503816793893
correct cnt is:  190 all is:  1048 ratio is:  0.18129770992366412
epoch 14: perplexity: 37.83099132509815 perplexity_train: 33.93862600021712
____
0.1364503816793893
0.18129770992366412
37.83099132509815
33.93862600021712
0.125
0.18181818181818182
0.5789473684210527
0.6666666666666666
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.8613272309303284
threshold is:  3.33778715133667
correct cnt  ref is:  145 all is:  1048 ratio is:  0.1383587786259542
correct cnt is:  189 all is:  1048 ratio is:  0.1803435114503817
epoch 15: perplexity: 37.68120231908303 perplexity_train: 33.804167930680165
____
0.1383587786259542
0.1803435114503817
37.68120231908303
33.804167930680165
0.14772727272727273
0.18181818181818182
0.6190476190476191
0.6666666666666666
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.860138475894928
threshold is:  3.334496259689331
correct cnt  ref is:  142 all is:  1048 ratio is:  0.13549618320610687
correct cnt is:  190 all is:  1048 ratio is:  0.18129770992366412
epoch 16: perplexity: 37.539845945177674 perplexity_train: 33.674513517320925
____
0.13549618320610687
0.18129770992366412
37.539845945177674
33.674513517320925
0.14772727272727273
0.2727272727272727
0.6190476190476191
0.75
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.8594571352005005
threshold is:  3.3320252895355225
correct cnt  ref is:  142 all is:  1048 ratio is:  0.13549618320610687
correct cnt is:  189 all is:  1048 ratio is:  0.1803435114503817
epoch 17: perplexity: 37.452379276231234 perplexity_train: 33.59354593982408
____
0.13549618320610687
0.1803435114503817
37.452379276231234
33.59354593982408
0.13636363636363635
0.23863636363636365
0.6
0.7241379310344828
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.8590912222862244
threshold is:  3.3307509422302246
correct cnt  ref is:  143 all is:  1048 ratio is:  0.1364503816793893
correct cnt is:  189 all is:  1048 ratio is:  0.1803435114503817
epoch 18: perplexity: 37.40151658950548 perplexity_train: 33.54704397370261
____
0.1364503816793893
0.1803435114503817
37.40151658950548
33.54704397370261
0.2159090909090909
0.17045454545454544
0.7037037037037037
0.6521739130434783
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.8589423298835754
threshold is:  3.3304073810577393
correct cnt  ref is:  142 all is:  1048 ratio is:  0.13549618320610687
correct cnt is:  189 all is:  1048 ratio is:  0.1803435114503817
epoch 19: perplexity: 37.38466684705675 perplexity_train: 33.53173084290161
____
0.13549618320610687
0.1803435114503817
37.38466684705675
33.53173084290161
0.14772727272727273
0.3068181818181818
0.6190476190476191
0.7714285714285715
_____
*************end of training 
threshold_ref is:  0.8589423298835754
threshold is:  3.3304073810577393
correct cnt  ref is:  142 all is:  1048 ratio is:  0.13549618320610687
correct cnt is:  189 all is:  1048 ratio is:  0.1803435114503817
end of training perplexity: 37.38466684705675 perplexity_train: 33.53173084290161
____
0.13549618320610687
0.1803435114503817
37.38466684705675
33.53173084290161
0.10227272727272728
0.1590909090909091
0.5294117647058824
0.6363636363636364
_____
