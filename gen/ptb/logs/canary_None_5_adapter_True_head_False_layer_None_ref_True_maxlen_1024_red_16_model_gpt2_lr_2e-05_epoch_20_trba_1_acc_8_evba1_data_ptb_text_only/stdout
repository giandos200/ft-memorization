Namespace(adapter_reduction=16, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=2e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 0.894528
model_params (million) 0.894528
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.9512704610824585
threshold is:  3.665480136871338
correct cnt  ref is:  142 all is:  1048 ratio is:  0.13549618320610687
correct cnt is:  199 all is:  1048 ratio is:  0.1898854961832061
epoch 0: perplexity: 52.24103223096099 perplexity_train: 46.889737004518544
____
0.13549618320610687
0.1898854961832061
52.24103223096099
46.889737004518544
0.13636363636363635
0.13636363636363635
0.6
0.6
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.9169695973396301
threshold is:  3.5430636405944824
correct cnt  ref is:  126 all is:  1048 ratio is:  0.12022900763358779
correct cnt is:  196 all is:  1048 ratio is:  0.18702290076335878
epoch 1: perplexity: 46.09420718291512 perplexity_train: 41.43236931232217
____
0.12022900763358779
0.18702290076335878
46.09420718291512
41.43236931232217
0.09090909090909091
0.20454545454545456
0.5
0.6923076923076923
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.8966591358184814
threshold is:  3.4588217735290527
correct cnt  ref is:  189 all is:  1048 ratio is:  0.1803435114503817
correct cnt is:  190 all is:  1048 ratio is:  0.18129770992366412
epoch 2: perplexity: 42.42652037752053 perplexity_train: 38.12548548588842
____
0.1803435114503817
0.18129770992366412
42.42652037752053
38.12548548588842
0.17045454545454544
0.13636363636363635
0.6521739130434783
0.6
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.8789498805999756
threshold is:  3.3972854614257812
correct cnt  ref is:  154 all is:  1048 ratio is:  0.14694656488549618
correct cnt is:  188 all is:  1048 ratio is:  0.17938931297709923
epoch 3: perplexity: 39.99767453365782 perplexity_train: 35.92823290908354
____
0.14694656488549618
0.17938931297709923
39.99767453365782
35.92823290908354
0.1590909090909091
0.14772727272727273
0.6363636363636364
0.6190476190476191
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.8674235343933105
threshold is:  3.3582892417907715
correct cnt  ref is:  155 all is:  1048 ratio is:  0.14790076335877864
correct cnt is:  192 all is:  1048 ratio is:  0.183206106870229
epoch 4: perplexity: 38.43530068539442 perplexity_train: 34.48818324462292
____
0.14790076335877864
0.183206106870229
38.43530068539442
34.48818324462292
0.10227272727272728
0.09090909090909091
0.5294117647058824
0.5
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.857621431350708
threshold is:  3.327110528945923
correct cnt  ref is:  143 all is:  1048 ratio is:  0.1364503816793893
correct cnt is:  193 all is:  1048 ratio is:  0.18416030534351144
epoch 5: perplexity: 37.19112920228693 perplexity_train: 33.355515108944246
____
0.1364503816793893
0.18416030534351144
37.19112920228693
33.355515108944246
0.125
0.17045454545454544
0.5789473684210527
0.6521739130434783
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.8506336808204651
threshold is:  3.30432391166687
correct cnt  ref is:  141 all is:  1048 ratio is:  0.13454198473282442
correct cnt is:  198 all is:  1048 ratio is:  0.18893129770992367
epoch 6: perplexity: 36.296300180828375 perplexity_train: 32.542038299423304
____
0.13454198473282442
0.18893129770992367
36.296300180828375
32.542038299423304
0.125
0.18181818181818182
0.5789473684210527
0.6666666666666666
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.8447209596633911
threshold is:  3.288815975189209
correct cnt  ref is:  141 all is:  1048 ratio is:  0.13454198473282442
correct cnt is:  206 all is:  1048 ratio is:  0.1965648854961832
epoch 7: perplexity: 35.539757807458244 perplexity_train: 31.862995843980904
____
0.13454198473282442
0.1965648854961832
35.539757807458244
31.862995843980904
0.20454545454545456
0.2840909090909091
0.6923076923076923
0.7575757575757576
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.8409364223480225
threshold is:  3.2709741592407227
correct cnt  ref is:  151 all is:  1048 ratio is:  0.14408396946564886
correct cnt is:  209 all is:  1048 ratio is:  0.19942748091603055
epoch 8: perplexity: 34.98963250928222 perplexity_train: 31.361931588225175
____
0.14408396946564886
0.19942748091603055
34.98963250928222
31.361931588225175
0.11363636363636363
0.19318181818181818
0.5555555555555556
0.68
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.8369857668876648
threshold is:  3.258115530014038
correct cnt  ref is:  159 all is:  1048 ratio is:  0.15171755725190839
correct cnt is:  208 all is:  1048 ratio is:  0.1984732824427481
epoch 9: perplexity: 34.4754323130606 perplexity_train: 30.906495657305253
____
0.15171755725190839
0.1984732824427481
34.4754323130606
30.906495657305253
0.13636363636363635
0.14772727272727273
0.6
0.6190476190476191
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.8340169191360474
threshold is:  3.250349521636963
correct cnt  ref is:  161 all is:  1048 ratio is:  0.15362595419847327
correct cnt is:  213 all is:  1048 ratio is:  0.2032442748091603
epoch 10: perplexity: 34.09391001216552 perplexity_train: 30.55808612090524
____
0.15362595419847327
0.2032442748091603
34.09391001216552
30.55808612090524
0.18181818181818182
0.25
0.6666666666666666
0.7333333333333333
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.8316680788993835
threshold is:  3.24045991897583
correct cnt  ref is:  163 all is:  1048 ratio is:  0.15553435114503816
correct cnt is:  213 all is:  1048 ratio is:  0.2032442748091603
epoch 11: perplexity: 33.7788462797312 perplexity_train: 30.270579800977586
____
0.15553435114503816
0.2032442748091603
33.7788462797312
30.270579800977586
0.19318181818181818
0.22727272727272727
0.68
0.7142857142857143
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.8294170498847961
threshold is:  3.231016159057617
correct cnt  ref is:  163 all is:  1048 ratio is:  0.15553435114503816
correct cnt is:  212 all is:  1048 ratio is:  0.20229007633587787
epoch 12: perplexity: 33.50084599393246 perplexity_train: 30.023048791164793
____
0.15553435114503816
0.20229007633587787
33.50084599393246
30.023048791164793
0.20454545454545456
0.20454545454545456
0.6923076923076923
0.6923076923076923
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.8277226686477661
threshold is:  3.2212252616882324
correct cnt  ref is:  167 all is:  1048 ratio is:  0.15935114503816794
correct cnt is:  203 all is:  1048 ratio is:  0.19370229007633588
epoch 13: perplexity: 33.2624172418669 perplexity_train: 29.811276623040754
____
0.15935114503816794
0.19370229007633588
33.2624172418669
29.811276623040754
0.20454545454545456
0.2840909090909091
0.6923076923076923
0.7575757575757576
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.8265934586524963
threshold is:  3.2158641815185547
correct cnt  ref is:  170 all is:  1048 ratio is:  0.16221374045801526
correct cnt is:  203 all is:  1048 ratio is:  0.19370229007633588
epoch 14: perplexity: 33.100438428276085 perplexity_train: 29.66047437977061
____
0.16221374045801526
0.19370229007633588
33.100438428276085
29.66047437977061
0.18181818181818182
0.19318181818181818
0.6666666666666666
0.68
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.8254536390304565
threshold is:  3.211557626724243
correct cnt  ref is:  169 all is:  1048 ratio is:  0.16125954198473283
correct cnt is:  202 all is:  1048 ratio is:  0.19274809160305342
epoch 15: perplexity: 32.98337437770787 perplexity_train: 29.556781207045113
____
0.16125954198473283
0.19274809160305342
32.98337437770787
29.556781207045113
0.17045454545454544
0.18181818181818182
0.6521739130434783
0.6666666666666666
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.824574887752533
threshold is:  3.2073452472686768
correct cnt  ref is:  169 all is:  1048 ratio is:  0.16125954198473283
correct cnt is:  201 all is:  1048 ratio is:  0.191793893129771
epoch 16: perplexity: 32.88128692285776 perplexity_train: 29.462763521502524
____
0.16125954198473283
0.191793893129771
32.88128692285776
29.462763521502524
0.1590909090909091
0.26136363636363635
0.6363636363636364
0.7419354838709677
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.823940098285675
threshold is:  3.205400228500366
correct cnt  ref is:  169 all is:  1048 ratio is:  0.16125954198473283
correct cnt is:  202 all is:  1048 ratio is:  0.19274809160305342
epoch 17: perplexity: 32.804455556881166 perplexity_train: 29.392343205721712
____
0.16125954198473283
0.19274809160305342
32.804455556881166
29.392343205721712
0.13636363636363635
0.23863636363636365
0.6
0.7241379310344828
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.8236184120178223
threshold is:  3.204007148742676
correct cnt  ref is:  168 all is:  1048 ratio is:  0.16030534351145037
correct cnt is:  202 all is:  1048 ratio is:  0.19274809160305342
epoch 18: perplexity: 32.768568110287056 perplexity_train: 29.3583825965616
____
0.16030534351145037
0.19274809160305342
32.768568110287056
29.3583825965616
0.20454545454545456
0.19318181818181818
0.6923076923076923
0.68
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.823466420173645
threshold is:  3.2036921977996826
correct cnt  ref is:  167 all is:  1048 ratio is:  0.15935114503816794
correct cnt is:  202 all is:  1048 ratio is:  0.19274809160305342
epoch 19: perplexity: 32.75458647651298 perplexity_train: 29.34617086318347
____
0.15935114503816794
0.19274809160305342
32.75458647651298
29.34617086318347
0.17045454545454544
0.3181818181818182
0.6521739130434783
0.7777777777777778
_____
*************end of training 
threshold_ref is:  0.823466420173645
threshold is:  3.2036921977996826
correct cnt  ref is:  167 all is:  1048 ratio is:  0.15935114503816794
correct cnt is:  202 all is:  1048 ratio is:  0.19274809160305342
end of training perplexity: 32.75458647651298 perplexity_train: 29.34617086318347
____
0.15935114503816794
0.19274809160305342
32.75458647651298
29.34617086318347
0.125
0.1590909090909091
0.5789473684210527
0.6363636363636364
_____
