Namespace(adapter_reduction=16, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=5e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 0.894528
model_params (million) 0.894528
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.906578779220581
threshold is:  3.5002570152282715
correct cnt  ref is:  163 all is:  1048 ratio is:  0.15553435114503816
correct cnt is:  192 all is:  1048 ratio is:  0.183206106870229
epoch 0: perplexity: 44.163642307498336 perplexity_train: 39.72183267983969
____
0.15553435114503816
0.183206106870229
44.163642307498336
39.72183267983969
0.1590909090909091
0.125
0.6363636363636364
0.5789473684210527
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.8649863004684448
threshold is:  3.355095386505127
correct cnt  ref is:  150 all is:  1048 ratio is:  0.1431297709923664
correct cnt is:  199 all is:  1048 ratio is:  0.1898854961832061
epoch 1: perplexity: 38.162289756925404 perplexity_train: 34.21319437436252
____
0.1431297709923664
0.1898854961832061
38.162289756925404
34.21319437436252
0.09090909090909091
0.20454545454545456
0.5
0.6923076923076923
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.8425555229187012
threshold is:  3.277087926864624
correct cnt  ref is:  141 all is:  1048 ratio is:  0.13454198473282442
correct cnt is:  204 all is:  1048 ratio is:  0.1946564885496183
epoch 2: perplexity: 35.238887803558306 perplexity_train: 31.576037898451485
____
0.13454198473282442
0.1946564885496183
35.238887803558306
31.576037898451485
0.14772727272727273
0.13636363636363635
0.6190476190476191
0.6
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.8297633528709412
threshold is:  3.229950428009033
correct cnt  ref is:  174 all is:  1048 ratio is:  0.16603053435114504
correct cnt is:  210 all is:  1048 ratio is:  0.20038167938931298
epoch 3: perplexity: 33.48171407007227 perplexity_train: 30.00485853412212
____
0.16603053435114504
0.20038167938931298
33.48171407007227
30.00485853412212
0.17045454545454544
0.1590909090909091
0.6521739130434783
0.6363636363636364
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.8198626041412354
threshold is:  3.193142890930176
correct cnt  ref is:  173 all is:  1048 ratio is:  0.1650763358778626
correct cnt is:  208 all is:  1048 ratio is:  0.1984732824427481
epoch 4: perplexity: 32.31802222176479 perplexity_train: 28.9407761793088
____
0.1650763358778626
0.1984732824427481
32.31802222176479
28.9407761793088
0.10227272727272728
0.13636363636363635
0.5294117647058824
0.6
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.8103192448616028
threshold is:  3.1595849990844727
correct cnt  ref is:  141 all is:  1048 ratio is:  0.13454198473282442
correct cnt is:  200 all is:  1048 ratio is:  0.19083969465648856
epoch 5: perplexity: 31.46185962625412 perplexity_train: 28.163001670838067
____
0.13454198473282442
0.19083969465648856
31.46185962625412
28.163001670838067
0.11363636363636363
0.1590909090909091
0.5555555555555556
0.6363636363636364
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.803066074848175
threshold is:  3.140397548675537
correct cnt  ref is:  138 all is:  1048 ratio is:  0.1316793893129771
correct cnt is:  201 all is:  1048 ratio is:  0.191793893129771
epoch 6: perplexity: 30.818895868071486 perplexity_train: 27.56476519822769
____
0.1316793893129771
0.191793893129771
30.818895868071486
27.56476519822769
0.10227272727272728
0.18181818181818182
0.5294117647058824
0.6666666666666666
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.799446165561676
threshold is:  3.1244051456451416
correct cnt  ref is:  152 all is:  1048 ratio is:  0.1450381679389313
correct cnt is:  202 all is:  1048 ratio is:  0.19274809160305342
epoch 7: perplexity: 30.295163897166866 perplexity_train: 27.08388738539231
____
0.1450381679389313
0.19274809160305342
30.295163897166866
27.08388738539231
0.19318181818181818
0.2727272727272727
0.68
0.75
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.7965378165245056
threshold is:  3.109938621520996
correct cnt  ref is:  164 all is:  1048 ratio is:  0.15648854961832062
correct cnt is:  199 all is:  1048 ratio is:  0.1898854961832061
epoch 8: perplexity: 29.923966248905938 perplexity_train: 26.728377587279322
____
0.15648854961832062
0.1898854961832061
29.923966248905938
26.728377587279322
0.13636363636363635
0.19318181818181818
0.6
0.68
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.7921013236045837
threshold is:  3.103604793548584
correct cnt  ref is:  152 all is:  1048 ratio is:  0.1450381679389313
correct cnt is:  209 all is:  1048 ratio is:  0.19942748091603055
epoch 9: perplexity: 29.565823744443605 perplexity_train: 26.402557092359334
____
0.1450381679389313
0.19942748091603055
29.565823744443605
26.402557092359334
0.125
0.13636363636363635
0.5789473684210527
0.6
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.7899199724197388
threshold is:  3.100611925125122
correct cnt  ref is:  167 all is:  1048 ratio is:  0.15935114503816794
correct cnt is:  223 all is:  1048 ratio is:  0.21278625954198474
epoch 10: perplexity: 29.27860493550272 perplexity_train: 26.12705588142499
____
0.15935114503816794
0.21278625954198474
29.27860493550272
26.12705588142499
0.1590909090909091
0.23863636363636365
0.6363636363636364
0.7241379310344828
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.7875022888183594
threshold is:  3.0859615802764893
correct cnt  ref is:  163 all is:  1048 ratio is:  0.15553435114503816
correct cnt is:  206 all is:  1048 ratio is:  0.1965648854961832
epoch 11: perplexity: 29.077892846579594 perplexity_train: 25.922806431098795
____
0.15553435114503816
0.1965648854961832
29.077892846579594
25.922806431098795
0.19318181818181818
0.23863636363636365
0.68
0.7241379310344828
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.785673201084137
threshold is:  3.0711605548858643
correct cnt  ref is:  170 all is:  1048 ratio is:  0.16221374045801526
correct cnt is:  193 all is:  1048 ratio is:  0.18416030534351144
epoch 12: perplexity: 28.867287841001783 perplexity_train: 25.72579591843544
____
0.16221374045801526
0.18416030534351144
28.867287841001783
25.72579591843544
0.20454545454545456
0.2159090909090909
0.6923076923076923
0.7037037037037037
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.7841816544532776
threshold is:  3.067394733428955
correct cnt  ref is:  168 all is:  1048 ratio is:  0.16030534351145037
correct cnt is:  194 all is:  1048 ratio is:  0.1851145038167939
epoch 13: perplexity: 28.728301105193417 perplexity_train: 25.58720369845358
____
0.16030534351145037
0.1851145038167939
28.728301105193417
25.58720369845358
0.19318181818181818
0.2727272727272727
0.68
0.75
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.7825942039489746
threshold is:  3.0628693103790283
correct cnt  ref is:  167 all is:  1048 ratio is:  0.15935114503816794
correct cnt is:  194 all is:  1048 ratio is:  0.1851145038167939
epoch 14: perplexity: 28.608420988797175 perplexity_train: 25.46784066400125
____
0.15935114503816794
0.1851145038167939
28.608420988797175
25.46784066400125
0.1590909090909091
0.19318181818181818
0.6363636363636364
0.68
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.7817568182945251
threshold is:  3.058397054672241
correct cnt  ref is:  167 all is:  1048 ratio is:  0.15935114503816794
correct cnt is:  193 all is:  1048 ratio is:  0.18416030534351144
epoch 15: perplexity: 28.52921200579919 perplexity_train: 25.388669646397716
____
0.15935114503816794
0.18416030534351144
28.52921200579919
25.388669646397716
0.19318181818181818
0.18181818181818182
0.68
0.6666666666666666
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.7809538841247559
threshold is:  3.0571553707122803
correct cnt  ref is:  167 all is:  1048 ratio is:  0.15935114503816794
correct cnt is:  194 all is:  1048 ratio is:  0.1851145038167939
epoch 16: perplexity: 28.470904616762226 perplexity_train: 25.33153799364931
____
0.15935114503816794
0.1851145038167939
28.470904616762226
25.33153799364931
0.13636363636363635
0.20454545454545456
0.6
0.6923076923076923
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.7802888751029968
threshold is:  3.056051731109619
correct cnt  ref is:  166 all is:  1048 ratio is:  0.15839694656488548
correct cnt is:  195 all is:  1048 ratio is:  0.18606870229007633
epoch 17: perplexity: 28.411259996752623 perplexity_train: 25.276764591463248
____
0.15839694656488548
0.18606870229007633
28.411259996752623
25.276764591463248
0.17045454545454544
0.22727272727272727
0.6521739130434783
0.7142857142857143
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.7799050807952881
threshold is:  3.0545899868011475
correct cnt  ref is:  168 all is:  1048 ratio is:  0.16030534351145037
correct cnt is:  194 all is:  1048 ratio is:  0.1851145038167939
epoch 18: perplexity: 28.38300710222543 perplexity_train: 25.244453354923568
____
0.16030534351145037
0.1851145038167939
28.38300710222543
25.244453354923568
0.19318181818181818
0.2159090909090909
0.68
0.7037037037037037
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.7798187732696533
threshold is:  3.0542869567871094
correct cnt  ref is:  168 all is:  1048 ratio is:  0.16030534351145037
correct cnt is:  194 all is:  1048 ratio is:  0.1851145038167939
epoch 19: perplexity: 28.37231719856861 perplexity_train: 25.2350478064223
____
0.16030534351145037
0.1851145038167939
28.37231719856861
25.2350478064223
0.20454545454545456
0.3181818181818182
0.6923076923076923
0.7777777777777778
_____
*************end of training 
threshold_ref is:  0.7798187732696533
threshold is:  3.0542869567871094
correct cnt  ref is:  168 all is:  1048 ratio is:  0.16030534351145037
correct cnt is:  194 all is:  1048 ratio is:  0.1851145038167939
end of training perplexity: 28.37231719856861 perplexity_train: 25.2350478064223
____
0.16030534351145037
0.1851145038167939
28.37231719856861
25.2350478064223
0.11363636363636363
0.1590909090909091
0.5555555555555556
0.6363636363636364
_____
