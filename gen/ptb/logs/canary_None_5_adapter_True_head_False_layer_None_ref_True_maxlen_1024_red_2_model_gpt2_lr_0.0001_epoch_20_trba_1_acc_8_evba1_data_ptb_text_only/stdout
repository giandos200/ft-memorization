Namespace(adapter_reduction=2, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0001, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 7.091712
model_params (million) 7.091712
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.8366547226905823
threshold is:  3.2366549968719482
correct cnt  ref is:  222 all is:  1048 ratio is:  0.21183206106870228
correct cnt is:  182 all is:  1048 ratio is:  0.1736641221374046
epoch 0: perplexity: 34.589032880798726 perplexity_train: 30.76603710907955
____
0.21183206106870228
0.1736641221374046
34.589032880798726
30.76603710907955
0.17045454545454544
0.125
0.6521739130434783
0.5789473684210527
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.7947436571121216
threshold is:  3.0855965614318848
correct cnt  ref is:  242 all is:  1048 ratio is:  0.23091603053435114
correct cnt is:  188 all is:  1048 ratio is:  0.17938931297709923
epoch 1: perplexity: 29.96090256443636 perplexity_train: 26.301767813676683
____
0.23091603053435114
0.17938931297709923
29.96090256443636
26.301767813676683
0.23863636363636365
0.14772727272727273
0.7241379310344828
0.6190476190476191
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.772557258605957
threshold is:  3.025846004486084
correct cnt  ref is:  271 all is:  1048 ratio is:  0.258587786259542
correct cnt is:  228 all is:  1048 ratio is:  0.21755725190839695
epoch 2: perplexity: 27.79524888762032 perplexity_train: 24.05894127962602
____
0.258587786259542
0.21755725190839695
27.79524888762032
24.05894127962602
0.26136363636363635
0.25
0.7419354838709677
0.7333333333333333
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7597156763076782
threshold is:  2.9828286170959473
correct cnt  ref is:  328 all is:  1048 ratio is:  0.31297709923664124
correct cnt is:  262 all is:  1048 ratio is:  0.25
epoch 3: perplexity: 26.53599798939663 perplexity_train: 22.526630150914777
____
0.31297709923664124
0.25
26.53599798939663
22.526630150914777
0.375
0.2840909090909091
0.8048780487804879
0.7575757575757576
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7505443096160889
threshold is:  2.9620416164398193
correct cnt  ref is:  365 all is:  1048 ratio is:  0.3482824427480916
correct cnt is:  312 all is:  1048 ratio is:  0.29770992366412213
epoch 4: perplexity: 25.760246343593867 perplexity_train: 21.492590629636375
____
0.3482824427480916
0.29770992366412213
25.760246343593867
21.492590629636375
0.2840909090909091
0.23863636363636365
0.7575757575757576
0.7241379310344828
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.7421864867210388
threshold is:  2.937628746032715
correct cnt  ref is:  388 all is:  1048 ratio is:  0.3702290076335878
correct cnt is:  341 all is:  1048 ratio is:  0.32538167938931295
epoch 5: perplexity: 25.08251098501668 perplexity_train: 20.579546912157493
____
0.3702290076335878
0.32538167938931295
25.08251098501668
20.579546912157493
0.4318181818181818
0.3522727272727273
0.8260869565217391
0.7948717948717948
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.7382593154907227
threshold is:  2.912104606628418
correct cnt  ref is:  432 all is:  1048 ratio is:  0.4122137404580153
correct cnt is:  358 all is:  1048 ratio is:  0.3416030534351145
epoch 6: perplexity: 24.57364338271815 perplexity_train: 19.87563405458559
____
0.4122137404580153
0.3416030534351145
24.57364338271815
19.87563405458559
0.4090909090909091
0.23863636363636365
0.8181818181818182
0.7241379310344828
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7315948605537415
threshold is:  2.8979241847991943
correct cnt  ref is:  441 all is:  1048 ratio is:  0.4208015267175573
correct cnt is:  379 all is:  1048 ratio is:  0.3616412213740458
epoch 7: perplexity: 24.229515180608978 perplexity_train: 19.321276789124784
____
0.4208015267175573
0.3616412213740458
24.229515180608978
19.321276789124784
0.4090909090909091
0.4318181818181818
0.8181818181818182
0.8260869565217391
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.7274712324142456
threshold is:  2.8861963748931885
correct cnt  ref is:  464 all is:  1048 ratio is:  0.44274809160305345
correct cnt is:  407 all is:  1048 ratio is:  0.3883587786259542
epoch 8: perplexity: 23.907812854410437 perplexity_train: 18.81392437256946
____
0.44274809160305345
0.3883587786259542
23.907812854410437
18.81392437256946
0.375
0.3181818181818182
0.8048780487804879
0.7777777777777778
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.7239868640899658
threshold is:  2.8750193119049072
correct cnt  ref is:  494 all is:  1048 ratio is:  0.4713740458015267
correct cnt is:  432 all is:  1048 ratio is:  0.4122137404580153
epoch 9: perplexity: 23.706467019399 perplexity_train: 18.33425261704968
____
0.4713740458015267
0.4122137404580153
23.706467019399
18.33425261704968
0.5681818181818182
0.5
0.8620689655172413
0.8461538461538461
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.7189816832542419
threshold is:  2.8645670413970947
correct cnt  ref is:  487 all is:  1048 ratio is:  0.46469465648854963
correct cnt is:  443 all is:  1048 ratio is:  0.42270992366412213
epoch 10: perplexity: 23.467730258796582 perplexity_train: 18.01192658039918
____
0.46469465648854963
0.42270992366412213
23.467730258796582
18.01192658039918
0.48863636363636365
0.4318181818181818
0.8431372549019608
0.8260869565217391
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.7133777141571045
threshold is:  2.8628432750701904
correct cnt  ref is:  474 all is:  1048 ratio is:  0.45229007633587787
correct cnt is:  478 all is:  1048 ratio is:  0.45610687022900764
epoch 11: perplexity: 23.326009710792118 perplexity_train: 17.67562235769992
____
0.45229007633587787
0.45610687022900764
23.326009710792118
17.67562235769992
0.42045454545454547
0.4090909090909091
0.8222222222222222
0.8181818181818182
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.709125816822052
threshold is:  2.8718695640563965
correct cnt  ref is:  469 all is:  1048 ratio is:  0.44751908396946566
correct cnt is:  524 all is:  1048 ratio is:  0.5
epoch 12: perplexity: 23.2312813901997 perplexity_train: 17.41349023745173
____
0.44751908396946566
0.5
23.2312813901997
17.41349023745173
0.42045454545454547
0.5113636363636364
0.8222222222222222
0.8490566037735849
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.7079533934593201
threshold is:  2.8604137897491455
correct cnt  ref is:  493 all is:  1048 ratio is:  0.47041984732824427
correct cnt is:  534 all is:  1048 ratio is:  0.5095419847328244
epoch 13: perplexity: 23.04808714807393 perplexity_train: 17.143768423754015
____
0.47041984732824427
0.5095419847328244
23.04808714807393
17.143768423754015
0.48863636363636365
0.4772727272727273
0.8431372549019608
0.84
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.7057067155838013
threshold is:  2.8533568382263184
correct cnt  ref is:  497 all is:  1048 ratio is:  0.47423664122137404
correct cnt is:  537 all is:  1048 ratio is:  0.5124045801526718
epoch 14: perplexity: 22.959172662210243 perplexity_train: 16.957454828853628
____
0.47423664122137404
0.5124045801526718
22.959172662210243
16.957454828853628
0.5227272727272727
0.5568181818181818
0.8518518518518519
0.8596491228070176
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.7032520174980164
threshold is:  2.853060722351074
correct cnt  ref is:  492 all is:  1048 ratio is:  0.46946564885496184
correct cnt is:  551 all is:  1048 ratio is:  0.5257633587786259
epoch 15: perplexity: 22.892684682104477 perplexity_train: 16.81386552006249
____
0.46946564885496184
0.5257633587786259
22.892684682104477
16.81386552006249
0.36363636363636365
0.5
0.8
0.8461538461538461
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.7012650966644287
threshold is:  2.8550446033477783
correct cnt  ref is:  494 all is:  1048 ratio is:  0.4713740458015267
correct cnt is:  574 all is:  1048 ratio is:  0.5477099236641222
epoch 16: perplexity: 22.859627384019085 perplexity_train: 16.691537071101767
____
0.4713740458015267
0.5477099236641222
22.859627384019085
16.691537071101767
0.5
0.5340909090909091
0.8461538461538461
0.8545454545454545
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.7007718682289124
threshold is:  2.8571784496307373
correct cnt  ref is:  501 all is:  1048 ratio is:  0.4780534351145038
correct cnt is:  585 all is:  1048 ratio is:  0.558206106870229
epoch 17: perplexity: 22.826122578051457 perplexity_train: 16.588447543704753
____
0.4780534351145038
0.558206106870229
22.826122578051457
16.588447543704753
0.48863636363636365
0.5795454545454546
0.8431372549019608
0.864406779661017
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.6994442343711853
threshold is:  2.8510870933532715
correct cnt  ref is:  497 all is:  1048 ratio is:  0.47423664122137404
correct cnt is:  585 all is:  1048 ratio is:  0.558206106870229
epoch 18: perplexity: 22.76607658173305 perplexity_train: 16.533300012596655
____
0.47423664122137404
0.558206106870229
22.76607658173305
16.533300012596655
0.4659090909090909
0.5795454545454546
0.8367346938775511
0.864406779661017
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.6993585824966431
threshold is:  2.853395938873291
correct cnt  ref is:  497 all is:  1048 ratio is:  0.47423664122137404
correct cnt is:  588 all is:  1048 ratio is:  0.5610687022900763
epoch 19: perplexity: 22.779047422461854 perplexity_train: 16.51409467710172
____
0.47423664122137404
0.5610687022900763
22.779047422461854
16.51409467710172
0.5
0.6363636363636364
0.8461538461538461
0.875
_____
*************end of training 
threshold_ref is:  0.6993585824966431
threshold is:  2.853395938873291
correct cnt  ref is:  497 all is:  1048 ratio is:  0.47423664122137404
correct cnt is:  588 all is:  1048 ratio is:  0.5610687022900763
end of training perplexity: 22.779047422461854 perplexity_train: 16.5140907398352
____
0.47423664122137404
0.5610687022900763
22.779047422461854
16.5140907398352
0.5454545454545454
0.6022727272727273
0.8571428571428571
0.8688524590163934
_____
