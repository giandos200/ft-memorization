Namespace(adapter_reduction=2, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0002, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 7.091712
model_params (million) 7.091712
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.8144546747207642
threshold is:  3.182990074157715
correct cnt  ref is:  215 all is:  1048 ratio is:  0.20515267175572519
correct cnt is:  225 all is:  1048 ratio is:  0.21469465648854963
epoch 0: perplexity: 31.976777228993146 perplexity_train: 28.387128526487615
____
0.20515267175572519
0.21469465648854963
31.976777228993146
28.387128526487615
0.1590909090909091
0.14772727272727273
0.6363636363636364
0.6190476190476191
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.7729683518409729
threshold is:  3.027456045150757
correct cnt  ref is:  267 all is:  1048 ratio is:  0.2547709923664122
correct cnt is:  235 all is:  1048 ratio is:  0.22423664122137404
epoch 1: perplexity: 27.883553188137604 perplexity_train: 24.09035543839311
____
0.2547709923664122
0.22423664122137404
27.883553188137604
24.09035543839311
0.2727272727272727
0.18181818181818182
0.75
0.6666666666666666
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.7520956993103027
threshold is:  2.977992057800293
correct cnt  ref is:  329 all is:  1048 ratio is:  0.3139312977099237
correct cnt is:  305 all is:  1048 ratio is:  0.29103053435114506
epoch 2: perplexity: 26.003742275822074 perplexity_train: 21.919488297305243
____
0.3139312977099237
0.29103053435114506
26.003742275822074
21.919488297305243
0.3068181818181818
0.3409090909090909
0.7714285714285715
0.7894736842105263
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7387499809265137
threshold is:  2.9360263347625732
correct cnt  ref is:  401 all is:  1048 ratio is:  0.38263358778625955
correct cnt is:  373 all is:  1048 ratio is:  0.35591603053435117
epoch 3: perplexity: 24.752539955537536 perplexity_train: 20.25413469913225
____
0.38263358778625955
0.35591603053435117
24.752539955537536
20.25413469913225
0.4431818181818182
0.3181818181818182
0.8297872340425532
0.7777777777777778
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.72948157787323
threshold is:  2.883620262145996
correct cnt  ref is:  434 all is:  1048 ratio is:  0.41412213740458015
correct cnt is:  368 all is:  1048 ratio is:  0.3511450381679389
epoch 4: perplexity: 24.136503366329634 perplexity_train: 19.193894389918924
____
0.41412213740458015
0.3511450381679389
24.136503366329634
19.193894389918924
0.36363636363636365
0.29545454545454547
0.8
0.7647058823529411
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.7209218740463257
threshold is:  2.8699440956115723
correct cnt  ref is:  485 all is:  1048 ratio is:  0.4627862595419847
correct cnt is:  437 all is:  1048 ratio is:  0.4169847328244275
epoch 5: perplexity: 23.59143364714549 perplexity_train: 18.16939869554303
____
0.4627862595419847
0.4169847328244275
23.59143364714549
18.16939869554303
0.4659090909090909
0.42045454545454547
0.8367346938775511
0.8222222222222222
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.7079820036888123
threshold is:  2.8519866466522217
correct cnt  ref is:  453 all is:  1048 ratio is:  0.43225190839694655
correct cnt is:  477 all is:  1048 ratio is:  0.4551526717557252
epoch 6: perplexity: 23.156429458975282 perplexity_train: 17.43223694150401
____
0.43225190839694655
0.4551526717557252
23.156429458975282
17.43223694150401
0.4431818181818182
0.4090909090909091
0.8297872340425532
0.8181818181818182
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.7027308344841003
threshold is:  2.845066785812378
correct cnt  ref is:  493 all is:  1048 ratio is:  0.47041984732824427
correct cnt is:  543 all is:  1048 ratio is:  0.5181297709923665
epoch 7: perplexity: 22.820604882932077 perplexity_train: 16.75078638770076
____
0.47041984732824427
0.5181297709923665
22.820604882932077
16.75078638770076
0.48863636363636365
0.5113636363636364
0.8431372549019608
0.8490566037735849
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.6937982439994812
threshold is:  2.846372365951538
correct cnt  ref is:  491 all is:  1048 ratio is:  0.4685114503816794
correct cnt is:  611 all is:  1048 ratio is:  0.5830152671755725
epoch 8: perplexity: 22.593444711836778 perplexity_train: 16.146595042901705
____
0.4685114503816794
0.5830152671755725
22.593444711836778
16.146595042901705
0.42045454545454547
0.5
0.8222222222222222
0.8461538461538461
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.6939963102340698
threshold is:  2.838357448577881
correct cnt  ref is:  553 all is:  1048 ratio is:  0.5276717557251909
correct cnt is:  654 all is:  1048 ratio is:  0.6240458015267175
epoch 9: perplexity: 22.45168252281379 perplexity_train: 15.613915064954524
____
0.5276717557251909
0.6240458015267175
22.45168252281379
15.613915064954524
0.6818181818181818
0.625
0.8823529411764706
0.873015873015873
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.6918924450874329
threshold is:  2.826930522918701
correct cnt  ref is:  581 all is:  1048 ratio is:  0.5543893129770993
correct cnt is:  689 all is:  1048 ratio is:  0.6574427480916031
epoch 10: perplexity: 22.18781123510654 perplexity_train: 15.179826847242218
____
0.5543893129770993
0.6574427480916031
22.18781123510654
15.179826847242218
0.5795454545454546
0.6818181818181818
0.864406779661017
0.8823529411764706
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.6887252926826477
threshold is:  2.8267953395843506
correct cnt  ref is:  592 all is:  1048 ratio is:  0.5648854961832062
correct cnt is:  718 all is:  1048 ratio is:  0.6851145038167938
epoch 11: perplexity: 22.145415519796426 perplexity_train: 14.830937267369823
____
0.5648854961832062
0.6851145038167938
22.145415519796426
14.830937267369823
0.5454545454545454
0.625
0.8571428571428571
0.873015873015873
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.6882123351097107
threshold is:  2.8062150478363037
correct cnt  ref is:  635 all is:  1048 ratio is:  0.6059160305343512
correct cnt is:  723 all is:  1048 ratio is:  0.6898854961832062
epoch 12: perplexity: 22.037463106439553 perplexity_train: 14.484868091370894
____
0.6059160305343512
0.6898854961832062
22.037463106439553
14.484868091370894
0.6363636363636364
0.6931818181818182
0.875
0.8840579710144928
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.6875708103179932
threshold is:  2.7979278564453125
correct cnt  ref is:  660 all is:  1048 ratio is:  0.6297709923664122
correct cnt is:  737 all is:  1048 ratio is:  0.7032442748091603
epoch 13: perplexity: 22.003426823831738 perplexity_train: 14.23203154405367
____
0.6297709923664122
0.7032442748091603
22.003426823831738
14.23203154405367
0.625
0.6931818181818182
0.873015873015873
0.8840579710144928
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.686539888381958
threshold is:  2.780594825744629
correct cnt  ref is:  688 all is:  1048 ratio is:  0.6564885496183206
correct cnt is:  736 all is:  1048 ratio is:  0.7022900763358778
epoch 14: perplexity: 21.970993589406728 perplexity_train: 13.973186931339308
____
0.6564885496183206
0.7022900763358778
21.970993589406728
13.973186931339308
0.6704545454545454
0.7272727272727273
0.8805970149253731
0.8888888888888888
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.68571537733078
threshold is:  2.767746686935425
correct cnt  ref is:  711 all is:  1048 ratio is:  0.6784351145038168
correct cnt is:  733 all is:  1048 ratio is:  0.6994274809160306
epoch 15: perplexity: 21.90832837489755 perplexity_train: 13.800167882981228
____
0.6784351145038168
0.6994274809160306
21.90832837489755
13.800167882981228
0.6363636363636364
0.6704545454545454
0.875
0.8805970149253731
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.684303879737854
threshold is:  2.7664122581481934
correct cnt  ref is:  720 all is:  1048 ratio is:  0.6870229007633588
correct cnt is:  747 all is:  1048 ratio is:  0.7127862595419847
epoch 16: perplexity: 21.8811837718839 perplexity_train: 13.641069132741578
____
0.6870229007633588
0.7127862595419847
21.8811837718839
13.641069132741578
0.6818181818181818
0.7272727272727273
0.8823529411764706
0.8888888888888888
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.6853716969490051
threshold is:  2.7602758407592773
correct cnt  ref is:  740 all is:  1048 ratio is:  0.7061068702290076
correct cnt is:  749 all is:  1048 ratio is:  0.7146946564885496
epoch 17: perplexity: 21.943065061656164 perplexity_train: 13.511254650946995
____
0.7061068702290076
0.7146946564885496
21.943065061656164
13.511254650946995
0.6590909090909091
0.7272727272727273
0.8787878787878788
0.8888888888888888
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.6834432482719421
threshold is:  2.763486385345459
correct cnt  ref is:  732 all is:  1048 ratio is:  0.6984732824427481
correct cnt is:  756 all is:  1048 ratio is:  0.7213740458015268
epoch 18: perplexity: 21.869240375695977 perplexity_train: 13.442102667279668
____
0.6984732824427481
0.7213740458015268
21.869240375695977
13.442102667279668
0.7272727272727273
0.7840909090909091
0.8888888888888888
0.8961038961038961
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.6847538948059082
threshold is:  2.7672195434570312
correct cnt  ref is:  746 all is:  1048 ratio is:  0.7118320610687023
correct cnt is:  766 all is:  1048 ratio is:  0.7309160305343512
epoch 19: perplexity: 21.936531723111894 perplexity_train: 13.409926117350071
____
0.7118320610687023
0.7309160305343512
21.936531723111894
13.409926117350071
0.7159090909090909
0.75
0.8873239436619719
0.8918918918918919
_____
*************end of training 
threshold_ref is:  0.6847538948059082
threshold is:  2.7672195434570312
correct cnt  ref is:  746 all is:  1048 ratio is:  0.7118320610687023
correct cnt is:  766 all is:  1048 ratio is:  0.7309160305343512
end of training perplexity: 21.936531723111894 perplexity_train: 13.409922920174923
____
0.7118320610687023
0.7309160305343512
21.936531723111894
13.409922920174923
0.6931818181818182
0.7386363636363636
0.8840579710144928
0.8904109589041096
_____
