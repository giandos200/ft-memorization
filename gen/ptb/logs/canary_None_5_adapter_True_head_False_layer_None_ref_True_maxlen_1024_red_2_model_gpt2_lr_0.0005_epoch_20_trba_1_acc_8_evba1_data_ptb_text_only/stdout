Namespace(adapter_reduction=2, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.0005, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 7.091712
model_params (million) 7.091712
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.7928717732429504
threshold is:  3.103959798812866
correct cnt  ref is:  200 all is:  1048 ratio is:  0.19083969465648856
correct cnt is:  208 all is:  1048 ratio is:  0.1984732824427481
epoch 0: perplexity: 29.704719041166992 perplexity_train: 26.396892326012615
____
0.19083969465648856
0.1984732824427481
29.704719041166992
26.396892326012615
0.11363636363636363
0.13636363636363635
0.5555555555555556
0.6
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.753211259841919
threshold is:  2.9748291969299316
correct cnt  ref is:  302 all is:  1048 ratio is:  0.2881679389312977
correct cnt is:  275 all is:  1048 ratio is:  0.26240458015267176
epoch 1: perplexity: 25.99591313846198 perplexity_train: 22.221735375956907
____
0.2881679389312977
0.26240458015267176
25.99591313846198
22.221735375956907
0.2840909090909091
0.20454545454545456
0.7575757575757576
0.6923076923076923
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.7318103909492493
threshold is:  2.9073808193206787
correct cnt  ref is:  377 all is:  1048 ratio is:  0.3597328244274809
correct cnt is:  345 all is:  1048 ratio is:  0.3291984732824427
epoch 2: perplexity: 24.26080500446665 perplexity_train: 19.92204231371243
____
0.3597328244274809
0.3291984732824427
24.26080500446665
19.92204231371243
0.36363636363636365
0.38636363636363635
0.8
0.8095238095238095
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.7172331809997559
threshold is:  2.869560956954956
correct cnt  ref is:  439 all is:  1048 ratio is:  0.41889312977099236
correct cnt is:  436 all is:  1048 ratio is:  0.41603053435114506
epoch 3: perplexity: 23.2413752197137 perplexity_train: 18.193209532626952
____
0.41889312977099236
0.41603053435114506
23.2413752197137
18.193209532626952
0.4659090909090909
0.3977272727272727
0.8367346938775511
0.813953488372093
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.7038023471832275
threshold is:  2.838116407394409
correct cnt  ref is:  483 all is:  1048 ratio is:  0.46087786259541985
correct cnt is:  513 all is:  1048 ratio is:  0.48950381679389315
epoch 4: perplexity: 22.645815529492722 perplexity_train: 16.95276967132265
____
0.46087786259541985
0.48950381679389315
22.645815529492722
16.95276967132265
0.4090909090909091
0.42045454545454547
0.8181818181818182
0.8222222222222222
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.691951334476471
threshold is:  2.8295092582702637
correct cnt  ref is:  527 all is:  1048 ratio is:  0.5028625954198473
correct cnt is:  622 all is:  1048 ratio is:  0.5935114503816794
epoch 5: perplexity: 22.24494245606764 perplexity_train: 15.723734131753094
____
0.5028625954198473
0.5935114503816794
22.24494245606764
15.723734131753094
0.4659090909090909
0.5568181818181818
0.8367346938775511
0.8596491228070176
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.683780312538147
threshold is:  2.8046343326568604
correct cnt  ref is:  554 all is:  1048 ratio is:  0.5286259541984732
correct cnt is:  672 all is:  1048 ratio is:  0.6412213740458015
epoch 6: perplexity: 21.8971114861402 perplexity_train: 14.881846957004345
____
0.5286259541984732
0.6412213740458015
21.8971114861402
14.881846957004345
0.5340909090909091
0.5795454545454546
0.8545454545454545
0.864406779661017
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.6818095445632935
threshold is:  2.7903950214385986
correct cnt  ref is:  635 all is:  1048 ratio is:  0.6059160305343512
correct cnt is:  745 all is:  1048 ratio is:  0.7108778625954199
epoch 7: perplexity: 21.731410807699028 perplexity_train: 14.041126938074063
____
0.6059160305343512
0.7108778625954199
21.731410807699028
14.041126938074063
0.6590909090909091
0.7272727272727273
0.8787878787878788
0.8888888888888888
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.6759615540504456
threshold is:  2.7936646938323975
correct cnt  ref is:  680 all is:  1048 ratio is:  0.648854961832061
correct cnt is:  808 all is:  1048 ratio is:  0.7709923664122137
epoch 8: perplexity: 21.726753433137848 perplexity_train: 13.299777894597712
____
0.648854961832061
0.7709923664122137
21.726753433137848
13.299777894597712
0.5568181818181818
0.7727272727272727
0.8596491228070176
0.8947368421052632
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.6800066232681274
threshold is:  2.7851057052612305
correct cnt  ref is:  810 all is:  1048 ratio is:  0.7729007633587787
correct cnt is:  864 all is:  1048 ratio is:  0.8244274809160306
epoch 9: perplexity: 21.76122816566218 perplexity_train: 12.624435726742595
____
0.7729007633587787
0.8244274809160306
21.76122816566218
12.624435726742595
0.8181818181818182
0.8409090909090909
0.9
0.9024390243902439
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.6799508333206177
threshold is:  2.75777530670166
correct cnt  ref is:  878 all is:  1048 ratio is:  0.8377862595419847
correct cnt is:  885 all is:  1048 ratio is:  0.8444656488549618
epoch 10: perplexity: 21.657575294257935 perplexity_train: 12.071702030523852
____
0.8377862595419847
0.8444656488549618
21.657575294257935
12.071702030523852
0.8181818181818182
0.8295454545454546
0.9
0.9012345679012346
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.6787717342376709
threshold is:  2.7834982872009277
correct cnt  ref is:  925 all is:  1048 ratio is:  0.8826335877862596
correct cnt is:  935 all is:  1048 ratio is:  0.892175572519084
epoch 11: perplexity: 21.77686088071719 perplexity_train: 11.605063673172246
____
0.8826335877862596
0.892175572519084
21.77686088071719
11.605063673172246
0.7613636363636364
0.8522727272727273
0.8933333333333333
0.9036144578313253
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.6803628206253052
threshold is:  2.786823272705078
correct cnt  ref is:  977 all is:  1048 ratio is:  0.9322519083969466
correct cnt is:  971 all is:  1048 ratio is:  0.9265267175572519
epoch 12: perplexity: 22.044368128794794 perplexity_train: 11.099916648901576
____
0.9322519083969466
0.9265267175572519
22.044368128794794
11.099916648901576
0.9204545454545454
0.8977272727272727
0.9101123595505618
0.9080459770114943
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.6835859417915344
threshold is:  2.8016161918640137
correct cnt  ref is:  1013 all is:  1048 ratio is:  0.9666030534351145
correct cnt is:  998 all is:  1048 ratio is:  0.9522900763358778
epoch 13: perplexity: 22.244778044840473 perplexity_train: 10.721921380613853
____
0.9666030534351145
0.9522900763358778
22.244778044840473
10.721921380613853
0.9772727272727273
0.9886363636363636
0.9148936170212766
0.9157894736842105
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.6812386512756348
threshold is:  2.7915732860565186
correct cnt  ref is:  1025 all is:  1048 ratio is:  0.9780534351145038
correct cnt is:  1007 all is:  1048 ratio is:  0.9608778625954199
epoch 14: perplexity: 22.36133657362229 perplexity_train: 10.350903420925194
____
0.9780534351145038
0.9608778625954199
22.36133657362229
10.350903420925194
0.9886363636363636
0.9431818181818182
0.9157894736842105
0.9120879120879121
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.6798367500305176
threshold is:  2.7904820442199707
correct cnt  ref is:  1026 all is:  1048 ratio is:  0.9790076335877863
correct cnt is:  1021 all is:  1048 ratio is:  0.9742366412213741
epoch 15: perplexity: 22.527854719108667 perplexity_train: 10.065718444404666
____
0.9790076335877863
0.9742366412213741
22.527854719108667
10.065718444404666
0.9659090909090909
0.9545454545454546
0.9139784946236559
0.9130434782608695
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.6794177293777466
threshold is:  2.803243637084961
correct cnt  ref is:  1030 all is:  1048 ratio is:  0.982824427480916
correct cnt is:  1029 all is:  1048 ratio is:  0.9818702290076335
epoch 16: perplexity: 22.60886669963738 perplexity_train: 9.836232197888984
____
0.982824427480916
0.9818702290076335
22.60886669963738
9.836232197888984
1.0
0.9886363636363636
0.9166666666666666
0.9157894736842105
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.6840806603431702
threshold is:  2.79978084564209
correct cnt  ref is:  1038 all is:  1048 ratio is:  0.9904580152671756
correct cnt is:  1032 all is:  1048 ratio is:  0.9847328244274809
epoch 17: perplexity: 22.855038809990344 perplexity_train: 9.631715763031522
____
0.9904580152671756
0.9847328244274809
22.855038809990344
9.631715763031522
0.9886363636363636
0.9659090909090909
0.9157894736842105
0.9139784946236559
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.6827700734138489
threshold is:  2.807250499725342
correct cnt  ref is:  1039 all is:  1048 ratio is:  0.9914122137404581
correct cnt is:  1033 all is:  1048 ratio is:  0.9856870229007634
epoch 18: perplexity: 22.90175774432372 perplexity_train: 9.50179132120054
____
0.9914122137404581
0.9856870229007634
22.90175774432372
9.50179132120054
1.0
0.9886363636363636
0.9166666666666666
0.9157894736842105
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.6849951148033142
threshold is:  2.8160107135772705
correct cnt  ref is:  1042 all is:  1048 ratio is:  0.9942748091603053
correct cnt is:  1035 all is:  1048 ratio is:  0.9875954198473282
epoch 19: perplexity: 23.07922136976682 perplexity_train: 9.44701829379869
____
0.9942748091603053
0.9875954198473282
23.07922136976682
9.44701829379869
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
*************end of training 
threshold_ref is:  0.6849951148033142
threshold is:  2.8160107135772705
correct cnt  ref is:  1042 all is:  1048 ratio is:  0.9942748091603053
correct cnt is:  1035 all is:  1048 ratio is:  0.9875954198473282
end of training perplexity: 23.07922136976682 perplexity_train: 9.44701829379869
____
0.9942748091603053
0.9875954198473282
23.07922136976682
9.44701829379869
0.9886363636363636
0.9886363636363636
0.9157894736842105
0.9157894736842105
_____
