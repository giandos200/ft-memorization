Namespace(adapter_reduction=2, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=0.001, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 7.091712
model_params (million) 7.091712
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.783125638961792
threshold is:  3.0696966648101807
correct cnt  ref is:  230 all is:  1048 ratio is:  0.21946564885496184
correct cnt is:  224 all is:  1048 ratio is:  0.21374045801526717
epoch 0: perplexity: 28.32830778781176 perplexity_train: 25.21124571495006
____
0.21946564885496184
0.21374045801526717
28.32830778781176
25.21124571495006
0.1590909090909091
0.13636363636363635
0.6363636363636364
0.6
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.7432259321212769
threshold is:  2.9419336318969727
correct cnt  ref is:  323 all is:  1048 ratio is:  0.30820610687022904
correct cnt is:  301 all is:  1048 ratio is:  0.2872137404580153
epoch 1: perplexity: 25.00004918730333 perplexity_train: 21.266583956487406
____
0.30820610687022904
0.2872137404580153
25.00004918730333
21.266583956487406
0.36363636363636365
0.25
0.8
0.7333333333333333
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.7226018905639648
threshold is:  2.8677175045013428
correct cnt  ref is:  404 all is:  1048 ratio is:  0.38549618320610685
correct cnt is:  357 all is:  1048 ratio is:  0.34064885496183206
epoch 2: perplexity: 23.492423416322772 perplexity_train: 18.989451816579777
____
0.38549618320610685
0.34064885496183206
23.492423416322772
18.989451816579777
0.375
0.38636363636363635
0.8048780487804879
0.8095238095238095
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.6998831033706665
threshold is:  2.8161797523498535
correct cnt  ref is:  414 all is:  1048 ratio is:  0.3950381679389313
correct cnt is:  429 all is:  1048 ratio is:  0.40935114503816794
epoch 3: perplexity: 22.53799756136198 perplexity_train: 17.216506218348282
____
0.3950381679389313
0.40935114503816794
22.53799756136198
17.216506218348282
0.45454545454545453
0.4090909090909091
0.8333333333333334
0.8181818181818182
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.694949209690094
threshold is:  2.794886827468872
correct cnt  ref is:  524 all is:  1048 ratio is:  0.5
correct cnt is:  530 all is:  1048 ratio is:  0.5057251908396947
epoch 4: perplexity: 22.12044522307766 perplexity_train: 15.926670901015159
____
0.5
0.5057251908396947
22.12044522307766
15.926670901015159
0.45454545454545453
0.4431818181818182
0.8333333333333334
0.8297872340425532
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.6789575219154358
threshold is:  2.8063087463378906
correct cnt  ref is:  552 all is:  1048 ratio is:  0.5267175572519084
correct cnt is:  711 all is:  1048 ratio is:  0.6784351145038168
epoch 5: perplexity: 21.902103023340388 perplexity_train: 14.55116696347386
____
0.5267175572519084
0.6784351145038168
21.902103023340388
14.55116696347386
0.4772727272727273
0.625
0.84
0.873015873015873
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.681468665599823
threshold is:  2.750025987625122
correct cnt  ref is:  689 all is:  1048 ratio is:  0.6574427480916031
correct cnt is:  722 all is:  1048 ratio is:  0.6889312977099237
epoch 6: perplexity: 21.767771571702298 perplexity_train: 13.60817622316055
____
0.6574427480916031
0.6889312977099237
21.767771571702298
13.60817622316055
0.625
0.6477272727272727
0.873015873015873
0.8769230769230769
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.6802853941917419
threshold is:  2.776698589324951
correct cnt  ref is:  800 all is:  1048 ratio is:  0.7633587786259542
correct cnt is:  841 all is:  1048 ratio is:  0.8024809160305344
epoch 7: perplexity: 21.807546480442863 perplexity_train: 12.64850774885934
____
0.7633587786259542
0.8024809160305344
21.807546480442863
12.64850774885934
0.8409090909090909
0.7954545454545454
0.9024390243902439
0.8974358974358975
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.6786487102508545
threshold is:  2.7862415313720703
correct cnt  ref is:  903 all is:  1048 ratio is:  0.8616412213740458
correct cnt is:  929 all is:  1048 ratio is:  0.8864503816793893
epoch 8: perplexity: 21.98530402619756 perplexity_train: 11.778183792210752
____
0.8616412213740458
0.8864503816793893
21.98530402619756
11.778183792210752
0.8636363636363636
0.8295454545454546
0.9047619047619048
0.9012345679012346
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.6828781366348267
threshold is:  2.8103888034820557
correct cnt  ref is:  996 all is:  1048 ratio is:  0.950381679389313
correct cnt is:  989 all is:  1048 ratio is:  0.9437022900763359
epoch 9: perplexity: 22.204173903600854 perplexity_train: 10.925726038521969
____
0.950381679389313
0.9437022900763359
22.204173903600854
10.925726038521969
0.9659090909090909
0.9545454545454546
0.9139784946236559
0.9130434782608695
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.6872522830963135
threshold is:  2.806694507598877
correct cnt  ref is:  1028 all is:  1048 ratio is:  0.9809160305343512
correct cnt is:  1017 all is:  1048 ratio is:  0.9704198473282443
epoch 10: perplexity: 22.459574081407695 perplexity_train: 10.25655343281584
____
0.9809160305343512
0.9704198473282443
22.459574081407695
10.25655343281584
0.9772727272727273
0.9545454545454546
0.9148936170212766
0.9130434782608695
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.6869794130325317
threshold is:  2.833554983139038
correct cnt  ref is:  1040 all is:  1048 ratio is:  0.9923664122137404
correct cnt is:  1038 all is:  1048 ratio is:  0.9904580152671756
epoch 11: perplexity: 22.797194013451907 perplexity_train: 9.651314611894698
____
0.9923664122137404
0.9904580152671756
22.797194013451907
9.651314611894698
0.9886363636363636
0.9772727272727273
0.9157894736842105
0.9148936170212766
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.6961787939071655
threshold is:  2.853315830230713
correct cnt  ref is:  1047 all is:  1048 ratio is:  0.9990458015267175
correct cnt is:  1044 all is:  1048 ratio is:  0.9961832061068703
epoch 12: perplexity: 23.468955627082554 perplexity_train: 9.047072416743779
____
0.9990458015267175
0.9961832061068703
23.468955627082554
9.047072416743779
0.9886363636363636
0.9886363636363636
0.9157894736842105
0.9157894736842105
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.7005167603492737
threshold is:  2.887383222579956
correct cnt  ref is:  1048 all is:  1048 ratio is:  1.0
correct cnt is:  1047 all is:  1048 ratio is:  0.9990458015267175
epoch 13: perplexity: 24.01169360075494 perplexity_train: 8.518928688881644
____
1.0
0.9990458015267175
24.01169360075494
8.518928688881644
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.7063523530960083
threshold is:  2.8899872303009033
correct cnt  ref is:  1048 all is:  1048 ratio is:  1.0
correct cnt is:  1048 all is:  1048 ratio is:  1.0
epoch 14: perplexity: 24.564745456884502 perplexity_train: 8.042766078680343
____
1.0
1.0
24.564745456884502
8.042766078680343
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.7085294127464294
threshold is:  2.9282634258270264
correct cnt  ref is:  1048 all is:  1048 ratio is:  1.0
correct cnt is:  1048 all is:  1048 ratio is:  1.0
epoch 15: perplexity: 25.242948713091067 perplexity_train: 7.642412615974403
____
1.0
1.0
25.242948713091067
7.642412615974403
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.7167643308639526
threshold is:  2.947075366973877
correct cnt  ref is:  1048 all is:  1048 ratio is:  1.0
correct cnt is:  1048 all is:  1048 ratio is:  1.0
epoch 16: perplexity: 25.73499782533024 perplexity_train: 7.323094305848029
____
1.0
1.0
25.73499782533024
7.323094305848029
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.7206845879554749
threshold is:  2.958562135696411
correct cnt  ref is:  1048 all is:  1048 ratio is:  1.0
correct cnt is:  1048 all is:  1048 ratio is:  1.0
epoch 17: perplexity: 26.342691701328487 perplexity_train: 7.057731872906667
____
1.0
1.0
26.342691701328487
7.057731872906667
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.7237231731414795
threshold is:  2.9869704246520996
correct cnt  ref is:  1048 all is:  1048 ratio is:  1.0
correct cnt is:  1048 all is:  1048 ratio is:  1.0
epoch 18: perplexity: 26.85475616349627 perplexity_train: 6.869953942330042
____
1.0
1.0
26.85475616349627
6.869953942330042
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.7268238663673401
threshold is:  2.9959282875061035
correct cnt  ref is:  1048 all is:  1048 ratio is:  1.0
correct cnt is:  1048 all is:  1048 ratio is:  1.0
epoch 19: perplexity: 27.289495976549176 perplexity_train: 6.795400167595321
____
1.0
1.0
27.289495976549176
6.795400167595321
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
*************end of training 
threshold_ref is:  0.7268238663673401
threshold is:  2.9959282875061035
correct cnt  ref is:  1048 all is:  1048 ratio is:  1.0
correct cnt is:  1048 all is:  1048 ratio is:  1.0
end of training perplexity: 27.289495976549176 perplexity_train: 6.795400167595321
____
1.0
1.0
27.289495976549176
6.795400167595321
1.0
1.0
0.9166666666666666
0.9166666666666666
_____
