Namespace(adapter_reduction=2, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=1e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 7.091712
model_params (million) 7.091712
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.9624233245849609
threshold is:  3.7013325691223145
correct cnt  ref is:  87 all is:  1048 ratio is:  0.08301526717557252
correct cnt is:  151 all is:  1048 ratio is:  0.14408396946564886
epoch 0: perplexity: 55.71640563088607 perplexity_train: 50.275872569620454
____
0.08301526717557252
0.14408396946564886
55.71640563088607
50.275872569620454
0.11363636363636363
0.045454545454545456
0.5555555555555556
0.3333333333333333
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.9210268259048462
threshold is:  3.5482137203216553
correct cnt  ref is:  163 all is:  1048 ratio is:  0.15553435114503816
correct cnt is:  177 all is:  1048 ratio is:  0.16889312977099236
epoch 1: perplexity: 47.05346479101649 perplexity_train: 42.316225466054014
____
0.15553435114503816
0.16889312977099236
47.05346479101649
42.316225466054014
0.13636363636363635
0.17045454545454544
0.6
0.6521739130434783
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.8978046178817749
threshold is:  3.467550754547119
correct cnt  ref is:  186 all is:  1048 ratio is:  0.17748091603053434
correct cnt is:  192 all is:  1048 ratio is:  0.183206106870229
epoch 2: perplexity: 43.12850884341026 perplexity_train: 38.66616483151155
____
0.17748091603053434
0.183206106870229
43.12850884341026
38.66616483151155
0.13636363636363635
0.2159090909090909
0.6
0.7037037037037037
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.8809942603111267
threshold is:  3.400768995285034
correct cnt  ref is:  193 all is:  1048 ratio is:  0.18416030534351144
correct cnt is:  187 all is:  1048 ratio is:  0.1784351145038168
epoch 3: perplexity: 40.580652603496176 perplexity_train: 36.279524510589596
____
0.18416030534351144
0.1784351145038168
40.580652603496176
36.279524510589596
0.23863636363636365
0.1590909090909091
0.7241379310344828
0.6363636363636364
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.869279682636261
threshold is:  3.35243821144104
correct cnt  ref is:  205 all is:  1048 ratio is:  0.19561068702290077
correct cnt is:  177 all is:  1048 ratio is:  0.16889312977099236
epoch 4: perplexity: 38.888651271405784 perplexity_train: 34.694197252739265
____
0.19561068702290077
0.16889312977099236
38.888651271405784
34.694197252739265
0.19318181818181818
0.07954545454545454
0.68
0.4666666666666667
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.8587831258773804
threshold is:  3.309847831726074
correct cnt  ref is:  200 all is:  1048 ratio is:  0.19083969465648856
correct cnt is:  173 all is:  1048 ratio is:  0.1650763358778626
epoch 5: perplexity: 37.45908581325524 perplexity_train: 33.38474566810452
____
0.19083969465648856
0.1650763358778626
37.45908581325524
33.38474566810452
0.20454545454545456
0.18181818181818182
0.6923076923076923
0.6666666666666666
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.851763129234314
threshold is:  3.285003423690796
correct cnt  ref is:  218 all is:  1048 ratio is:  0.20801526717557253
correct cnt is:  175 all is:  1048 ratio is:  0.16698473282442747
epoch 6: perplexity: 36.46730971278467 perplexity_train: 32.472308750001254
____
0.20801526717557253
0.16698473282442747
36.46730971278467
32.472308750001254
0.18181818181818182
0.125
0.6666666666666666
0.5789473684210527
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.8441047668457031
threshold is:  3.268406391143799
correct cnt  ref is:  204 all is:  1048 ratio is:  0.1946564885496183
correct cnt is:  189 all is:  1048 ratio is:  0.1803435114503817
epoch 7: perplexity: 35.572403618827 perplexity_train: 31.64812084621045
____
0.1946564885496183
0.1803435114503817
35.572403618827
31.64812084621045
0.18181818181818182
0.17045454545454544
0.6666666666666666
0.6521739130434783
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.8387352228164673
threshold is:  3.254819631576538
correct cnt  ref is:  200 all is:  1048 ratio is:  0.19083969465648856
correct cnt is:  195 all is:  1048 ratio is:  0.18606870229007633
epoch 8: perplexity: 34.90855718894761 perplexity_train: 31.049831033918455
____
0.19083969465648856
0.18606870229007633
34.90855718894761
31.049831033918455
0.125
0.11363636363636363
0.5789473684210527
0.5555555555555556
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.8341856002807617
threshold is:  3.244502067565918
correct cnt  ref is:  203 all is:  1048 ratio is:  0.19370229007633588
correct cnt is:  205 all is:  1048 ratio is:  0.19561068702290077
epoch 9: perplexity: 34.36347471764556 perplexity_train: 30.548193856600538
____
0.19370229007633588
0.19561068702290077
34.36347471764556
30.548193856600538
0.25
0.26136363636363635
0.7333333333333333
0.7419354838709677
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.8303213119506836
threshold is:  3.2302064895629883
correct cnt  ref is:  202 all is:  1048 ratio is:  0.19274809160305342
correct cnt is:  206 all is:  1048 ratio is:  0.1965648854961832
epoch 10: perplexity: 33.9007865185943 perplexity_train: 30.114661034744053
____
0.19274809160305342
0.1965648854961832
33.9007865185943
30.114661034744053
0.22727272727272727
0.20454545454545456
0.7142857142857143
0.6923076923076923
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.8273047804832458
threshold is:  3.216430902481079
correct cnt  ref is:  205 all is:  1048 ratio is:  0.19561068702290077
correct cnt is:  203 all is:  1048 ratio is:  0.19370229007633588
epoch 11: perplexity: 33.53231445287676 perplexity_train: 29.76803007548796
____
0.19561068702290077
0.19370229007633588
33.53231445287676
29.76803007548796
0.19318181818181818
0.125
0.68
0.5789473684210527
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.8243445158004761
threshold is:  3.2065060138702393
correct cnt  ref is:  206 all is:  1048 ratio is:  0.1965648854961832
correct cnt is:  204 all is:  1048 ratio is:  0.1946564885496183
epoch 12: perplexity: 33.18693444426036 perplexity_train: 29.45327499046835
____
0.1965648854961832
0.1946564885496183
33.18693444426036
29.45327499046835
0.1590909090909091
0.125
0.6363636363636364
0.5789473684210527
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.8221122026443481
threshold is:  3.197054624557495
correct cnt  ref is:  202 all is:  1048 ratio is:  0.19274809160305342
correct cnt is:  202 all is:  1048 ratio is:  0.19274809160305342
epoch 13: perplexity: 32.9433873712052 perplexity_train: 29.23307126113067
____
0.19274809160305342
0.19274809160305342
32.9433873712052
29.23307126113067
0.18181818181818182
0.17045454545454544
0.6666666666666666
0.6521739130434783
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.8200840353965759
threshold is:  3.188821792602539
correct cnt  ref is:  206 all is:  1048 ratio is:  0.1965648854961832
correct cnt is:  203 all is:  1048 ratio is:  0.19370229007633588
epoch 14: perplexity: 32.738393987995735 perplexity_train: 29.020657335826833
____
0.1965648854961832
0.19370229007633588
32.738393987995735
29.020657335826833
0.2159090909090909
0.19318181818181818
0.7037037037037037
0.68
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.8178308606147766
threshold is:  3.1837053298950195
correct cnt  ref is:  198 all is:  1048 ratio is:  0.18893129770992367
correct cnt is:  203 all is:  1048 ratio is:  0.19370229007633588
epoch 15: perplexity: 32.53212428518641 perplexity_train: 28.834050760751147
____
0.18893129770992367
0.19370229007633588
32.53212428518641
28.834050760751147
0.125
0.18181818181818182
0.5789473684210527
0.6666666666666666
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.8172574043273926
threshold is:  3.1810801029205322
correct cnt  ref is:  202 all is:  1048 ratio is:  0.19274809160305342
correct cnt is:  204 all is:  1048 ratio is:  0.1946564885496183
epoch 16: perplexity: 32.42321515590976 perplexity_train: 28.731260181413674
____
0.19274809160305342
0.1946564885496183
32.42321515590976
28.731260181413674
0.20454545454545456
0.20454545454545456
0.6923076923076923
0.6923076923076923
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.816445529460907
threshold is:  3.1814465522766113
correct cnt  ref is:  202 all is:  1048 ratio is:  0.19274809160305342
correct cnt is:  209 all is:  1048 ratio is:  0.19942748091603055
epoch 17: perplexity: 32.33217209679454 perplexity_train: 28.647175598355005
____
0.19274809160305342
0.19942748091603055
32.33217209679454
28.647175598355005
0.13636363636363635
0.1590909090909091
0.6
0.6363636363636364
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.8159056305885315
threshold is:  3.17993426322937
correct cnt  ref is:  202 all is:  1048 ratio is:  0.19274809160305342
correct cnt is:  209 all is:  1048 ratio is:  0.19942748091603055
epoch 18: perplexity: 32.2767486368406 perplexity_train: 28.5933510375903
____
0.19274809160305342
0.19942748091603055
32.2767486368406
28.5933510375903
0.20454545454545456
0.23863636363636365
0.6923076923076923
0.7241379310344828
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.8158583045005798
threshold is:  3.1801493167877197
correct cnt  ref is:  203 all is:  1048 ratio is:  0.19370229007633588
correct cnt is:  210 all is:  1048 ratio is:  0.20038167938931298
epoch 19: perplexity: 32.26906956466782 perplexity_train: 28.586112102414134
____
0.19370229007633588
0.20038167938931298
32.26906956466782
28.586112102414134
0.20454545454545456
0.19318181818181818
0.6923076923076923
0.68
_____
*************end of training 
threshold_ref is:  0.8158583045005798
threshold is:  3.1801493167877197
correct cnt  ref is:  203 all is:  1048 ratio is:  0.19370229007633588
correct cnt is:  210 all is:  1048 ratio is:  0.20038167938931298
end of training perplexity: 32.26906956466782 perplexity_train: 28.58610528695472
____
0.19370229007633588
0.20038167938931298
32.26906956466782
28.58610528695472
0.22727272727272727
0.23863636363636365
0.7142857142857143
0.7241379310344828
_____
