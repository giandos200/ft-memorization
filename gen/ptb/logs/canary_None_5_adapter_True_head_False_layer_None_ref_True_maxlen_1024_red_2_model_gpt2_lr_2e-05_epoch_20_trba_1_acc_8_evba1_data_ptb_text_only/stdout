Namespace(adapter_reduction=2, add_adapter=True, add_canary=False, block_size=1024, canary_len=5, canary_rep=None, config_name=None, dataset_config_name=None, dataset_name='ptb_text_only', do_ref_model=True, eval_steps=100, gradient_accumulation_steps=8, hub_model_id=None, hub_token=None, learning_rate=2e-05, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, max_train_steps=None, model_name_or_path='gpt2', model_type=None, no_keep_linebreaks=False, num_train_epochs=20, num_warmup_steps=0, output_dir='./logs/', overwrite_cache=False, per_device_eval_batch_size=1, per_device_train_batch_size=1, preprocessing_num_workers=None, push_to_hub=False, seed=1234, tokenizer_name=None, train_file=None, train_head_only=False, train_layer_n_only=None, use_slow_tokenizer=False, validation_file=None, validation_split_percentage=5, weight_decay=0.0)
model_params (million) 7.091712
model_params (million) 7.091712
training epoch 0
*************end of epoch 0 eval 
threshold_ref is:  0.9210735559463501
threshold is:  3.5499956607818604
correct cnt  ref is:  154 all is:  1048 ratio is:  0.14694656488549618
correct cnt is:  174 all is:  1048 ratio is:  0.16603053435114504
epoch 0: perplexity: 47.129957996845896 perplexity_train: 42.39791392510975
____
0.14694656488549618
0.16603053435114504
47.129957996845896
42.39791392510975
0.1590909090909091
0.10227272727272728
0.6363636363636364
0.5294117647058824
_____
training epoch 1
*************end of epoch 1 eval 
threshold_ref is:  0.8794684410095215
threshold is:  3.3911116123199463
correct cnt  ref is:  188 all is:  1048 ratio is:  0.17938931297709923
correct cnt is:  179 all is:  1048 ratio is:  0.17080152671755724
epoch 1: perplexity: 40.37118558844566 perplexity_train: 36.104746934998296
____
0.17938931297709923
0.17080152671755724
40.37118558844566
36.104746934998296
0.18181818181818182
0.1590909090909091
0.6666666666666666
0.6363636363636364
_____
training epoch 2
*************end of epoch 2 eval 
threshold_ref is:  0.8573483228683472
threshold is:  3.3017690181732178
correct cnt  ref is:  214 all is:  1048 ratio is:  0.20419847328244276
correct cnt is:  171 all is:  1048 ratio is:  0.16316793893129772
epoch 2: perplexity: 37.199367609810075 perplexity_train: 33.15361631604958
____
0.20419847328244276
0.16316793893129772
37.199367609810075
33.15361631604958
0.19318181818181818
0.1590909090909091
0.68
0.6363636363636364
_____
training epoch 3
*************end of epoch 3 eval 
threshold_ref is:  0.8399047255516052
threshold is:  3.2591068744659424
correct cnt  ref is:  210 all is:  1048 ratio is:  0.20038167938931298
correct cnt is:  202 all is:  1048 ratio is:  0.19274809160305342
epoch 3: perplexity: 34.98398531022834 perplexity_train: 31.116609882522962
____
0.20038167938931298
0.19274809160305342
34.98398531022834
31.116609882522962
0.25
0.17045454545454544
0.7333333333333333
0.6521739130434783
_____
training epoch 4
*************end of epoch 4 eval 
threshold_ref is:  0.8282176852226257
threshold is:  3.218606472015381
correct cnt  ref is:  215 all is:  1048 ratio is:  0.20515267175572519
correct cnt is:  204 all is:  1048 ratio is:  0.1946564885496183
epoch 4: perplexity: 33.57914825878814 perplexity_train: 29.811525388756163
____
0.20515267175572519
0.1946564885496183
33.57914825878814
29.811525388756163
0.1590909090909091
0.09090909090909091
0.6363636363636364
0.5
_____
training epoch 5
*************end of epoch 5 eval 
threshold_ref is:  0.8174307942390442
threshold is:  3.183596611022949
correct cnt  ref is:  208 all is:  1048 ratio is:  0.1984732824427481
correct cnt is:  208 all is:  1048 ratio is:  0.1984732824427481
epoch 5: perplexity: 32.42377947249336 perplexity_train: 28.72258930623401
____
0.1984732824427481
0.1984732824427481
32.42377947249336
28.72258930623401
0.20454545454545456
0.2159090909090909
0.6923076923076923
0.7037037037037037
_____
training epoch 6
*************end of epoch 6 eval 
threshold_ref is:  0.8098023533821106
threshold is:  3.168283700942993
correct cnt  ref is:  212 all is:  1048 ratio is:  0.20229007633587787
correct cnt is:  229 all is:  1048 ratio is:  0.21851145038167938
epoch 6: perplexity: 31.56958679235954 perplexity_train: 27.91195441953473
____
0.20229007633587787
0.21851145038167938
31.56958679235954
27.91195441953473
0.1590909090909091
0.17045454545454544
0.6363636363636364
0.6521739130434783
_____
training epoch 7
*************end of epoch 7 eval 
threshold_ref is:  0.8044147491455078
threshold is:  3.161759614944458
correct cnt  ref is:  237 all is:  1048 ratio is:  0.22614503816793893
correct cnt is:  255 all is:  1048 ratio is:  0.2433206106870229
epoch 7: perplexity: 30.90621564862806 perplexity_train: 27.24999867591348
____
0.22614503816793893
0.2433206106870229
30.90621564862806
27.24999867591348
0.2159090909090909
0.23863636363636365
0.7037037037037037
0.7241379310344828
_____
training epoch 8
*************end of epoch 8 eval 
threshold_ref is:  0.8002811074256897
threshold is:  3.129956007003784
correct cnt  ref is:  253 all is:  1048 ratio is:  0.24141221374045801
correct cnt is:  237 all is:  1048 ratio is:  0.22614503816793893
epoch 8: perplexity: 30.371954124477117 perplexity_train: 26.739544612646608
____
0.24141221374045801
0.22614503816793893
30.371954124477117
26.739544612646608
0.22727272727272727
0.14772727272727273
0.7142857142857143
0.6190476190476191
_____
training epoch 9
*************end of epoch 9 eval 
threshold_ref is:  0.7956191301345825
threshold is:  3.105379819869995
correct cnt  ref is:  251 all is:  1048 ratio is:  0.23950381679389313
correct cnt is:  223 all is:  1048 ratio is:  0.21278625954198474
epoch 9: perplexity: 29.934591300315503 perplexity_train: 26.298620045337323
____
0.23950381679389313
0.21278625954198474
29.934591300315503
26.298620045337323
0.3522727272727273
0.2840909090909091
0.7948717948717948
0.7575757575757576
_____
training epoch 10
*************end of epoch 10 eval 
threshold_ref is:  0.7922569513320923
threshold is:  3.0755584239959717
correct cnt  ref is:  261 all is:  1048 ratio is:  0.24904580152671757
correct cnt is:  198 all is:  1048 ratio is:  0.18893129770992367
epoch 10: perplexity: 29.582351315970755 perplexity_train: 25.93555989479307
____
0.24904580152671757
0.18893129770992367
29.582351315970755
25.93555989479307
0.23863636363636365
0.17045454545454544
0.7241379310344828
0.6521739130434783
_____
training epoch 11
*************end of epoch 11 eval 
threshold_ref is:  0.789718747138977
threshold is:  3.0631768703460693
correct cnt  ref is:  276 all is:  1048 ratio is:  0.2633587786259542
correct cnt is:  197 all is:  1048 ratio is:  0.18797709923664122
epoch 11: perplexity: 29.29409890384502 perplexity_train: 25.62781618634963
____
0.2633587786259542
0.18797709923664122
29.29409890384502
25.62781618634963
0.2727272727272727
0.14772727272727273
0.75
0.6190476190476191
_____
training epoch 12
*************end of epoch 12 eval 
threshold_ref is:  0.7861278653144836
threshold is:  3.05531644821167
correct cnt  ref is:  263 all is:  1048 ratio is:  0.25095419847328243
correct cnt is:  199 all is:  1048 ratio is:  0.1898854961832061
epoch 12: perplexity: 29.016457767935893 perplexity_train: 25.35170589983673
____
0.25095419847328243
0.1898854961832061
29.016457767935893
25.35170589983673
0.18181818181818182
0.13636363636363635
0.6666666666666666
0.6
_____
training epoch 13
*************end of epoch 13 eval 
threshold_ref is:  0.7840917706489563
threshold is:  3.0540075302124023
correct cnt  ref is:  266 all is:  1048 ratio is:  0.2538167938931298
correct cnt is:  209 all is:  1048 ratio is:  0.19942748091603055
epoch 13: perplexity: 28.84405500019595 perplexity_train: 25.162832951214902
____
0.2538167938931298
0.19942748091603055
28.84405500019595
25.162832951214902
0.2727272727272727
0.1590909090909091
0.75
0.6363636363636364
_____
training epoch 14
*************end of epoch 14 eval 
threshold_ref is:  0.7830514907836914
threshold is:  3.0459811687469482
correct cnt  ref is:  278 all is:  1048 ratio is:  0.2652671755725191
correct cnt is:  209 all is:  1048 ratio is:  0.19942748091603055
epoch 14: perplexity: 28.675124000137533 perplexity_train: 24.96685351195712
____
0.2652671755725191
0.19942748091603055
28.675124000137533
24.96685351195712
0.3068181818181818
0.19318181818181818
0.7714285714285715
0.68
_____
training epoch 15
*************end of epoch 15 eval 
threshold_ref is:  0.7808765769004822
threshold is:  3.042147397994995
correct cnt  ref is:  276 all is:  1048 ratio is:  0.2633587786259542
correct cnt is:  210 all is:  1048 ratio is:  0.20038167938931298
epoch 15: perplexity: 28.514068208156957 perplexity_train: 24.805822538191062
____
0.2633587786259542
0.20038167938931298
28.514068208156957
24.805822538191062
0.19318181818181818
0.14772727272727273
0.68
0.6190476190476191
_____
training epoch 16
*************end of epoch 16 eval 
threshold_ref is:  0.7799031138420105
threshold is:  3.038254737854004
correct cnt  ref is:  272 all is:  1048 ratio is:  0.2595419847328244
correct cnt is:  210 all is:  1048 ratio is:  0.20038167938931298
epoch 16: perplexity: 28.43885619089277 perplexity_train: 24.722861588077038
____
0.2595419847328244
0.20038167938931298
28.43885619089277
24.722861588077038
0.29545454545454547
0.22727272727272727
0.7647058823529411
0.7142857142857143
_____
training epoch 17
*************end of epoch 17 eval 
threshold_ref is:  0.7792885899543762
threshold is:  3.037691593170166
correct cnt  ref is:  279 all is:  1048 ratio is:  0.26622137404580154
correct cnt is:  215 all is:  1048 ratio is:  0.20515267175572519
epoch 17: perplexity: 28.36713607422877 perplexity_train: 24.64082431662064
____
0.26622137404580154
0.20515267175572519
28.36713607422877
24.64082431662064
0.22727272727272727
0.13636363636363635
0.7142857142857143
0.6
_____
training epoch 18
*************end of epoch 18 eval 
threshold_ref is:  0.7788691520690918
threshold is:  3.035248279571533
correct cnt  ref is:  281 all is:  1048 ratio is:  0.2681297709923664
correct cnt is:  211 all is:  1048 ratio is:  0.2013358778625954
epoch 18: perplexity: 28.325592811975042 perplexity_train: 24.597951896002964
____
0.2681297709923664
0.2013358778625954
28.325592811975042
24.597951896002964
0.26136363636363635
0.2159090909090909
0.7419354838709677
0.7037037037037037
_____
training epoch 19
*************end of epoch 19 eval 
threshold_ref is:  0.7788372039794922
threshold is:  3.0354084968566895
correct cnt  ref is:  281 all is:  1048 ratio is:  0.2681297709923664
correct cnt is:  214 all is:  1048 ratio is:  0.20419847328244276
epoch 19: perplexity: 28.322115051479734 perplexity_train: 24.593354472439895
____
0.2681297709923664
0.20419847328244276
28.322115051479734
24.593354472439895
0.29545454545454547
0.19318181818181818
0.7647058823529411
0.68
_____
*************end of training 
threshold_ref is:  0.7788372039794922
threshold is:  3.0354084968566895
correct cnt  ref is:  281 all is:  1048 ratio is:  0.2681297709923664
correct cnt is:  214 all is:  1048 ratio is:  0.20419847328244276
end of training perplexity: 28.322115051479734 perplexity_train: 24.59336033595322
____
0.2681297709923664
0.20419847328244276
28.322115051479734
24.59336033595322
0.29545454545454547
0.25
0.7647058823529411
0.7333333333333333
_____
